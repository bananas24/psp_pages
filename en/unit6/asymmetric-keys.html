<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.51">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <meta name="theme-color" content="#3eaf7c"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="icon" href="/psp_pages/psp_favicon.png"><title>6.4 Encriptación asimétrica | Process and Service Programming</title><meta name="description" content="2nd DAM PSP Module">
    <link rel="modulepreload" href="/psp_pages/assets/app.33df6748.js"><link rel="modulepreload" href="/psp_pages/assets/asymmetric-keys.html.490b011a.js"><link rel="modulepreload" href="/psp_pages/assets/digital-signature-sign-verify.3b3014a7.js"><link rel="modulepreload" href="/psp_pages/assets/asymmetric-keys.html.f481fb53.js"><link rel="prefetch" href="/psp_pages/assets/index.html.126d04d1.js"><link rel="prefetch" href="/psp_pages/assets/test_page.html.4a568a14.js"><link rel="prefetch" href="/psp_pages/assets/index.html.5c0ff9f9.js"><link rel="prefetch" href="/psp_pages/assets/index.html.b111e567.js"><link rel="prefetch" href="/psp_pages/assets/concurrency.html.a9773ff7.js"><link rel="prefetch" href="/psp_pages/assets/index.html.76cb1e03.js"><link rel="prefetch" href="/psp_pages/assets/operatingsystem.html.3b383b5c.js"><link rel="prefetch" href="/psp_pages/assets/process.html.ccddbda9.js"><link rel="prefetch" href="/psp_pages/assets/curl_annex.html.5b95d392.js"><link rel="prefetch" href="/psp_pages/assets/index.html.713d9d95.js"><link rel="prefetch" href="/psp_pages/assets/iostreams.html.0499ab29.js"><link rel="prefetch" href="/psp_pages/assets/processbuilder.html.2ac46f2f.js"><link rel="prefetch" href="/psp_pages/assets/runtime.html.1518979e.js"><link rel="prefetch" href="/psp_pages/assets/alternatives.html.1b039ff6.js"><link rel="prefetch" href="/psp_pages/assets/arraylist_annex.html.6b773982.js"><link rel="prefetch" href="/psp_pages/assets/debugger_annex.html.d8031590.js"><link rel="prefetch" href="/psp_pages/assets/hashmap_annex.html.1ca45b19.js"><link rel="prefetch" href="/psp_pages/assets/index.html.90dd1516.js"><link rel="prefetch" href="/psp_pages/assets/producer-consumer.html.f0b74cf3.js"><link rel="prefetch" href="/psp_pages/assets/runnable.html.940abf8d.js"><link rel="prefetch" href="/psp_pages/assets/synchronization.html.7a373daf.js"><link rel="prefetch" href="/psp_pages/assets/index.html.5a1c957c.js"><link rel="prefetch" href="/psp_pages/assets/sockets-tcp.html.7bcdd997.js"><link rel="prefetch" href="/psp_pages/assets/sockets-udp.html.d7b19f4f.js"><link rel="prefetch" href="/psp_pages/assets/stateful-protocols.html.60941d4c.js"><link rel="prefetch" href="/psp_pages/assets/tcp-ip.html.8815e59f.js"><link rel="prefetch" href="/psp_pages/assets/urls.html.ff638854.js"><link rel="prefetch" href="/psp_pages/assets/ftp.html.93a7d989.js"><link rel="prefetch" href="/psp_pages/assets/index.html.510957d3.js"><link rel="prefetch" href="/psp_pages/assets/mail.html.20af16a7.js"><link rel="prefetch" href="/psp_pages/assets/hash-functions.html.f2e488c5.js"><link rel="prefetch" href="/psp_pages/assets/index.html.3125dbf0.js"><link rel="prefetch" href="/psp_pages/assets/jsse.html.ea4313fc.js"><link rel="prefetch" href="/psp_pages/assets/security.html.2cfb65ed.js"><link rel="prefetch" href="/psp_pages/assets/symmetric-key.html.2bea1717.js"><link rel="prefetch" href="/psp_pages/assets/concurrency.html.2bd7bd3f.js"><link rel="prefetch" href="/psp_pages/assets/index.html.57b7491c.js"><link rel="prefetch" href="/psp_pages/assets/operatingsystem.html.c87c3d7d.js"><link rel="prefetch" href="/psp_pages/assets/process.html.d2672a8d.js"><link rel="prefetch" href="/psp_pages/assets/curl_annex.html.ff7b94d1.js"><link rel="prefetch" href="/psp_pages/assets/index.html.5c876409.js"><link rel="prefetch" href="/psp_pages/assets/iostreams.html.ec26c929.js"><link rel="prefetch" href="/psp_pages/assets/processbuilder.html.a8bda9fe.js"><link rel="prefetch" href="/psp_pages/assets/runtime.html.a3b94484.js"><link rel="prefetch" href="/psp_pages/assets/alternatives.html.c19a759a.js"><link rel="prefetch" href="/psp_pages/assets/arraylist_annex.html.b86b5d95.js"><link rel="prefetch" href="/psp_pages/assets/debugger_annex.html.9b023420.js"><link rel="prefetch" href="/psp_pages/assets/hashmap_annex.html.7b13dc11.js"><link rel="prefetch" href="/psp_pages/assets/index.html.f0f464ca.js"><link rel="prefetch" href="/psp_pages/assets/producer-consumer.html.cad4b523.js"><link rel="prefetch" href="/psp_pages/assets/runnable.html.bdf3f987.js"><link rel="prefetch" href="/psp_pages/assets/synchronization.html.61a213aa.js"><link rel="prefetch" href="/psp_pages/assets/index.html.057b8751.js"><link rel="prefetch" href="/psp_pages/assets/sockets-tcp.html.74f1d9df.js"><link rel="prefetch" href="/psp_pages/assets/sockets-udp.html.60d9fa63.js"><link rel="prefetch" href="/psp_pages/assets/stateful-protocols.html.d3951d43.js"><link rel="prefetch" href="/psp_pages/assets/tcp-ip.html.6f4fc277.js"><link rel="prefetch" href="/psp_pages/assets/urls.html.17536de4.js"><link rel="prefetch" href="/psp_pages/assets/ftp.html.f98a4f65.js"><link rel="prefetch" href="/psp_pages/assets/index.html.29b33747.js"><link rel="prefetch" href="/psp_pages/assets/mail.html.308edd37.js"><link rel="prefetch" href="/psp_pages/assets/asymmetric-keys.html.36b9f5c2.js"><link rel="prefetch" href="/psp_pages/assets/hash-functions.html.ccb792f4.js"><link rel="prefetch" href="/psp_pages/assets/index.html.d1b218e6.js"><link rel="prefetch" href="/psp_pages/assets/jsse.html.b9e92c60.js"><link rel="prefetch" href="/psp_pages/assets/security.html.d9380a55.js"><link rel="prefetch" href="/psp_pages/assets/symmetric-key.html.d447e967.js"><link rel="prefetch" href="/psp_pages/assets/404.html.d2dc3323.js"><link rel="prefetch" href="/psp_pages/assets/index.html.94c1f64b.js"><link rel="prefetch" href="/psp_pages/assets/test_page.html.543e7c43.js"><link rel="prefetch" href="/psp_pages/assets/index.html.85930006.js"><link rel="prefetch" href="/psp_pages/assets/index.html.9cbab0b6.js"><link rel="prefetch" href="/psp_pages/assets/concurrency.html.8a5cb191.js"><link rel="prefetch" href="/psp_pages/assets/index.html.20ddbef5.js"><link rel="prefetch" href="/psp_pages/assets/operatingsystem.html.a8669af2.js"><link rel="prefetch" href="/psp_pages/assets/process.html.20f5eeab.js"><link rel="prefetch" href="/psp_pages/assets/curl_annex.html.f177270c.js"><link rel="prefetch" href="/psp_pages/assets/index.html.2735197f.js"><link rel="prefetch" href="/psp_pages/assets/iostreams.html.f91bd43c.js"><link rel="prefetch" href="/psp_pages/assets/processbuilder.html.87c76a7d.js"><link rel="prefetch" href="/psp_pages/assets/runtime.html.1568df96.js"><link rel="prefetch" href="/psp_pages/assets/alternatives.html.4177d8ed.js"><link rel="prefetch" href="/psp_pages/assets/arraylist_annex.html.20909c43.js"><link rel="prefetch" href="/psp_pages/assets/debugger_annex.html.e8c6185d.js"><link rel="prefetch" href="/psp_pages/assets/hashmap_annex.html.91d0a530.js"><link rel="prefetch" href="/psp_pages/assets/index.html.5219b222.js"><link rel="prefetch" href="/psp_pages/assets/producer-consumer.html.e2ef9c30.js"><link rel="prefetch" href="/psp_pages/assets/runnable.html.d67a00e2.js"><link rel="prefetch" href="/psp_pages/assets/synchronization.html.370470e6.js"><link rel="prefetch" href="/psp_pages/assets/index.html.8e20f249.js"><link rel="prefetch" href="/psp_pages/assets/sockets-tcp.html.ffe8458a.js"><link rel="prefetch" href="/psp_pages/assets/sockets-udp.html.1dbde118.js"><link rel="prefetch" href="/psp_pages/assets/stateful-protocols.html.87baf48e.js"><link rel="prefetch" href="/psp_pages/assets/tcp-ip.html.3c7f4ca3.js"><link rel="prefetch" href="/psp_pages/assets/urls.html.2c3d79d0.js"><link rel="prefetch" href="/psp_pages/assets/ftp.html.43b1f273.js"><link rel="prefetch" href="/psp_pages/assets/index.html.e080d21d.js"><link rel="prefetch" href="/psp_pages/assets/mail.html.57a2fd3b.js"><link rel="prefetch" href="/psp_pages/assets/hash-functions.html.78635462.js"><link rel="prefetch" href="/psp_pages/assets/index.html.0dcdff21.js"><link rel="prefetch" href="/psp_pages/assets/jsse.html.c09af2ab.js"><link rel="prefetch" href="/psp_pages/assets/security.html.c36487dc.js"><link rel="prefetch" href="/psp_pages/assets/symmetric-key.html.f9fca893.js"><link rel="prefetch" href="/psp_pages/assets/concurrency.html.c11c2f90.js"><link rel="prefetch" href="/psp_pages/assets/index.html.9522d18c.js"><link rel="prefetch" href="/psp_pages/assets/operatingsystem.html.dfaef997.js"><link rel="prefetch" href="/psp_pages/assets/process.html.10f1eaf5.js"><link rel="prefetch" href="/psp_pages/assets/curl_annex.html.5e0d444d.js"><link rel="prefetch" href="/psp_pages/assets/index.html.5a581040.js"><link rel="prefetch" href="/psp_pages/assets/iostreams.html.ef869cb1.js"><link rel="prefetch" href="/psp_pages/assets/processbuilder.html.e1a99cd9.js"><link rel="prefetch" href="/psp_pages/assets/runtime.html.2503189e.js"><link rel="prefetch" href="/psp_pages/assets/alternatives.html.440b605b.js"><link rel="prefetch" href="/psp_pages/assets/arraylist_annex.html.affeea66.js"><link rel="prefetch" href="/psp_pages/assets/debugger_annex.html.aa67e7d0.js"><link rel="prefetch" href="/psp_pages/assets/hashmap_annex.html.17b1b390.js"><link rel="prefetch" href="/psp_pages/assets/index.html.1cee216e.js"><link rel="prefetch" href="/psp_pages/assets/producer-consumer.html.0c8c3618.js"><link rel="prefetch" href="/psp_pages/assets/runnable.html.6ab22db3.js"><link rel="prefetch" href="/psp_pages/assets/synchronization.html.1e990f3b.js"><link rel="prefetch" href="/psp_pages/assets/index.html.54bee063.js"><link rel="prefetch" href="/psp_pages/assets/sockets-tcp.html.4c9f2a12.js"><link rel="prefetch" href="/psp_pages/assets/sockets-udp.html.3d9c52cd.js"><link rel="prefetch" href="/psp_pages/assets/stateful-protocols.html.3f01529f.js"><link rel="prefetch" href="/psp_pages/assets/tcp-ip.html.02f45341.js"><link rel="prefetch" href="/psp_pages/assets/urls.html.b383bc67.js"><link rel="prefetch" href="/psp_pages/assets/ftp.html.2dab39f4.js"><link rel="prefetch" href="/psp_pages/assets/index.html.170c40dc.js"><link rel="prefetch" href="/psp_pages/assets/mail.html.dc319e20.js"><link rel="prefetch" href="/psp_pages/assets/asymmetric-keys.html.5fe7e7f5.js"><link rel="prefetch" href="/psp_pages/assets/hash-functions.html.ab6af627.js"><link rel="prefetch" href="/psp_pages/assets/index.html.d2337e42.js"><link rel="prefetch" href="/psp_pages/assets/jsse.html.a1eb6ec5.js"><link rel="prefetch" href="/psp_pages/assets/security.html.05cc89c4.js"><link rel="prefetch" href="/psp_pages/assets/symmetric-key.html.b0a2a017.js"><link rel="prefetch" href="/psp_pages/assets/404.html.64ca8ffc.js"><link rel="prefetch" href="/psp_pages/assets/CCLicense-component.e656d2ae.js"><link rel="prefetch" href="/psp_pages/assets/DocumentCover-component.501c5787.js"><link rel="prefetch" href="/psp_pages/assets/DownloadPDF-component.daa1b290.js">
    <link rel="stylesheet" href="/psp_pages/assets/style.d83daf06.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="Show/Hide" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/psp_pages/en/" class=""><img class="logo" src="/psp_pages/LogoIES.png" alt="Process and Service Programming"><span class="site-name can-hide">Process and Service Programming</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a class="external-link" href="https://aules.edu.gva.es/fp/" rel="noopener noreferrer" target="_blank" aria-label="Aules FP"><!--[--><!--]--> Aules FP <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">Open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Course Index"><span class="title">Course Index</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Course Index"><span class="title">Course Index</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/psp_pages/en/unit1/" class="" aria-label="Unit 1 - Introduction to concurrent programming"><!--[--><!--]--> Unit 1 - Introduction to concurrent programming <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/psp_pages/en/unit2/" class="" aria-label="Unit 2 - Process programming in Java"><!--[--><!--]--> Unit 2 - Process programming in Java <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/psp_pages/en/unit3/" class="" aria-label="Unit 3 - Multithread programming in Java"><!--[--><!--]--> Unit 3 - Multithread programming in Java <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/psp_pages/en/unit4/" class="" aria-label="Unit 4 - Network programming in Java"><!--[--><!--]--> Unit 4 - Network programming in Java <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/psp_pages/en/unit5/" class="" aria-label="Unit 5 - Network services"><!--[--><!--]--> Unit 5 - Network services <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/psp_pages/en/unit6/" class="router-link-active" aria-label="Unit 6 - Secure programming techniques"><!--[--><!--]--> Unit 6 - Secure programming techniques <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Languages"><span class="title">Languages</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Languages"><span class="title">Languages</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a aria-current="page" href="/psp_pages/en/unit6/asymmetric-keys.html" class="router-link-active router-link-exact-active router-link-active" aria-label="English"><!--[--><!--]--> English <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/psp_pages/es/unit6/asymmetric-keys.html" class="" aria-label="Castellano"><!--[--><!--]--> Castellano <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/psp2dam/psp_sources2022" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">Open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" placeholder="Search" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a class="external-link" href="https://aules.edu.gva.es/fp/" rel="noopener noreferrer" target="_blank" aria-label="Aules FP"><!--[--><!--]--> Aules FP <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">Open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Course Index"><span class="title">Course Index</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Course Index"><span class="title">Course Index</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/psp_pages/en/unit1/" class="" aria-label="Unit 1 - Introduction to concurrent programming"><!--[--><!--]--> Unit 1 - Introduction to concurrent programming <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/psp_pages/en/unit2/" class="" aria-label="Unit 2 - Process programming in Java"><!--[--><!--]--> Unit 2 - Process programming in Java <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/psp_pages/en/unit3/" class="" aria-label="Unit 3 - Multithread programming in Java"><!--[--><!--]--> Unit 3 - Multithread programming in Java <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/psp_pages/en/unit4/" class="" aria-label="Unit 4 - Network programming in Java"><!--[--><!--]--> Unit 4 - Network programming in Java <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/psp_pages/en/unit5/" class="" aria-label="Unit 5 - Network services"><!--[--><!--]--> Unit 5 - Network services <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/psp_pages/en/unit6/" class="router-link-active" aria-label="Unit 6 - Secure programming techniques"><!--[--><!--]--> Unit 6 - Secure programming techniques <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Languages"><span class="title">Languages</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Languages"><span class="title">Languages</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a aria-current="page" href="/psp_pages/en/unit6/asymmetric-keys.html" class="router-link-active router-link-exact-active router-link-active" aria-label="English"><!--[--><!--]--> English <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/psp_pages/es/unit6/asymmetric-keys.html" class="" aria-label="Castellano"><!--[--><!--]--> Castellano <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/psp2dam/psp_sources2022" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">Open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading active">Unit 6 - Secure programming techniques <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/psp_pages/en/unit6/" class="router-link-active sidebar-item" aria-label="6 Introducción"><!--[--><!--]--> 6 Introducción <!--[--><!--]--></a><!----></li><li><a href="/psp_pages/en/unit6/security.html" class="sidebar-item" aria-label="6.1 Seguridad"><!--[--><!--]--> 6.1 Seguridad <!--[--><!--]--></a><!----></li><li><a href="/psp_pages/en/unit6/hash-functions.html" class="sidebar-item" aria-label="6.2 Funciones resumen"><!--[--><!--]--> 6.2 Funciones resumen <!--[--><!--]--></a><!----></li><li><a href="/psp_pages/en/unit6/symmetric-key.html" class="sidebar-item" aria-label="6.3 Encriptación simétrica"><!--[--><!--]--> 6.3 Encriptación simétrica <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/psp_pages/en/unit6/asymmetric-keys.html" class="router-link-active router-link-exact-active router-link-active sidebar-item active" aria-label="6.4 Encriptación asimétrica"><!--[--><!--]--> 6.4 Encriptación asimétrica <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/psp_pages/en/unit6/asymmetric-keys.html#_6-4-1-clave-publica-y-clave-privada" class="router-link-active router-link-exact-active sidebar-item" aria-label="6.4.1. Clave pública y clave privada"><!--[--><!--]--> 6.4.1. Clave pública y clave privada <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/psp_pages/en/unit6/asymmetric-keys.html#_6-4-2-firma-digital" class="router-link-active router-link-exact-active sidebar-item" aria-label="6.4.2. Firma digital"><!--[--><!--]--> 6.4.2. Firma digital <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/psp_pages/en/unit6/asymmetric-keys.html#integridad" class="router-link-active router-link-exact-active sidebar-item" aria-label="Integridad"><!--[--><!--]--> Integridad <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/psp_pages/en/unit6/asymmetric-keys.html#autenticacion-y-no-repudio" class="router-link-active router-link-exact-active sidebar-item" aria-label="Autenticación y no repudio"><!--[--><!--]--> Autenticación y no repudio <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/psp_pages/en/unit6/asymmetric-keys.html#_6-4-3-certificados-digitales" class="router-link-active router-link-exact-active sidebar-item" aria-label="6.4.3 Certificados digitales"><!--[--><!--]--> 6.4.3 Certificados digitales <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/psp_pages/en/unit6/asymmetric-keys.html#claves-digitales" class="router-link-active router-link-exact-active sidebar-item" aria-label="Claves digitales"><!--[--><!--]--> Claves digitales <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/psp_pages/en/unit6/asymmetric-keys.html#infraestructura-de-clave-publica-pki" class="router-link-active router-link-exact-active sidebar-item" aria-label="Infraestructura de clave pública (PKI)"><!--[--><!--]--> Infraestructura de clave pública (PKI) <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/psp_pages/en/unit6/asymmetric-keys.html#_6-4-4-generacion-de-pares-de-claves" class="router-link-active router-link-exact-active sidebar-item" aria-label="6.4.4. Generación de pares de claves"><!--[--><!--]--> 6.4.4. Generación de pares de claves <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/psp_pages/en/unit6/asymmetric-keys.html#tipos-de-ficheros-para-certificados-digitales" class="router-link-active router-link-exact-active sidebar-item" aria-label="Tipos de ficheros para certificados digitales"><!--[--><!--]--> Tipos de ficheros para certificados digitales <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/psp_pages/en/unit6/asymmetric-keys.html#generacion-de-claves-desde-java" class="router-link-active router-link-exact-active sidebar-item" aria-label="Generación de claves desde Java"><!--[--><!--]--> Generación de claves desde Java <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/psp_pages/en/unit6/asymmetric-keys.html#_6-4-5-cifrado-y-descifrado-usando-un-par-de-claves" class="router-link-active router-link-exact-active sidebar-item" aria-label="6.4.5. Cifrado y descifrado usando un par de claves"><!--[--><!--]--> 6.4.5. Cifrado y descifrado usando un par de claves <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/psp_pages/en/unit6/asymmetric-keys.html#_6-2-3-cifrado-asimetrico-con-gnupg" class="router-link-active router-link-exact-active sidebar-item" aria-label="6.2.3. Cifrado asimétrico con GnuPG"><!--[--><!--]--> 6.2.3. Cifrado asimétrico con GnuPG <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a href="/psp_pages/en/unit6/jsse.html" class="sidebar-item" aria-label="6.5 Comunicaciones seguras en Java"><!--[--><!--]--> 6.5 Comunicaciones seguras en Java <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><div true class="downloadLink" align="right"><a href="/psp_pages/pdf/6.4 Encriptación asimétrica.pdf" download><img src="/psp_pages/images/download-pdf.png" title="download as PDF" alt="download PDF" height="50"></a><a href="/psp_pages/pdf/6.4 Encriptación asimétrica.pdf" target="_blank"><img src="/psp_pages/images/open-pdf.png" title="open as PDF" alt="open PDF" height="50"></a></div><div class="documentcover" align="center"><img src="/psp_pages/images/LogoPSP_mini_en.png" alt="PSP Logo"><h1>6.4 Encriptación asimétrica</h1><h2></h2><img src="/psp_pages/LogoIES.png" alt="IES Doctor Balmis Logo" style="padding:2cm;"><div class="cclicense" align="center"><p xmlns:cc="http://creativecommons.org/ns#" xmlns:dct="http://purl.org/dc/terms/"><a property="dct:title" rel="cc:attributionURL" href="https://psp2dam.github.io/psp_sources">PSP class notes</a> by <span property="cc:attributionName">Vicente Martínez</span> is licensed under <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/?ref=chooser-v1" target="_blank" rel="license noopener noreferrer" style="display:inline-block;"> CC BY-NC-SA 4.0<img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1"><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1"><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/nc.svg?ref=chooser-v1"><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/sa.svg?ref=chooser-v1"></a></p></div><div class="pagebreak"></div></div><h1 id="_6-4-encriptacion-asimetrica" tabindex="-1">6.4 Encriptación asimétrica</h1><nav class="table-of-contents"><ul><li><a aria-current="page" href="/psp_pages/en/unit6/asymmetric-keys.html#_6-4-1-clave-publica-y-clave-privada" class="router-link-active router-link-exact-active">6.4.1. Clave pública y clave privada</a></li><li><a aria-current="page" href="/psp_pages/en/unit6/asymmetric-keys.html#_6-4-2-firma-digital" class="router-link-active router-link-exact-active">6.4.2. Firma digital</a><ul><li><a aria-current="page" href="/psp_pages/en/unit6/asymmetric-keys.html#integridad" class="router-link-active router-link-exact-active">Integridad</a></li><li><a aria-current="page" href="/psp_pages/en/unit6/asymmetric-keys.html#autenticacion-y-no-repudio" class="router-link-active router-link-exact-active">Autenticación y no repudio</a></li></ul></li><li><a aria-current="page" href="/psp_pages/en/unit6/asymmetric-keys.html#_6-4-3-certificados-digitales" class="router-link-active router-link-exact-active">6.4.3 Certificados digitales</a><ul><li><a aria-current="page" href="/psp_pages/en/unit6/asymmetric-keys.html#claves-digitales" class="router-link-active router-link-exact-active">Claves digitales</a></li><li><a aria-current="page" href="/psp_pages/en/unit6/asymmetric-keys.html#infraestructura-de-clave-publica-pki" class="router-link-active router-link-exact-active">Infraestructura de clave pública (PKI)</a></li></ul></li><li><a aria-current="page" href="/psp_pages/en/unit6/asymmetric-keys.html#_6-4-4-generacion-de-pares-de-claves" class="router-link-active router-link-exact-active">6.4.4. Generación de pares de claves</a><ul><li><a aria-current="page" href="/psp_pages/en/unit6/asymmetric-keys.html#tipos-de-ficheros-para-certificados-digitales" class="router-link-active router-link-exact-active">Tipos de ficheros para certificados digitales</a></li><li><a aria-current="page" href="/psp_pages/en/unit6/asymmetric-keys.html#generacion-de-claves-desde-java" class="router-link-active router-link-exact-active">Generación de claves desde Java</a></li></ul></li><li><a aria-current="page" href="/psp_pages/en/unit6/asymmetric-keys.html#_6-4-5-cifrado-y-descifrado-usando-un-par-de-claves" class="router-link-active router-link-exact-active">6.4.5. Cifrado y descifrado usando un par de claves</a></li><li><a aria-current="page" href="/psp_pages/en/unit6/asymmetric-keys.html#_6-2-3-cifrado-asimetrico-con-gnupg" class="router-link-active router-link-exact-active">6.2.3. Cifrado asimétrico con GnuPG</a></li></ul></nav><h2 id="_6-4-1-clave-publica-y-clave-privada" tabindex="-1">6.4.1. Clave pública y clave privada</h2><p>La criptografía asimétrica o <strong>criptografía de clave pública</strong> supuso una auténtica revolución en su momento. Permitía el intercambio seguro de información (confidencialidad, autenticación y no repudio) entre interlocutores que no compartían ningún secreto.</p><p>Se creó en los años 70 a partir del trabajo de <em>Diffie y Hellman</em> por una parte y de <em>Rivest, Shamir y Adleman</em> por otra.</p><p>Se basa en la existencia de un par de claves, una pública y otra privada, entre las cuales existe una relación matemática, de manera que es muy difícil obtener la clave privada a partir de la pública. Sin embargo, es muy sencillo obtener la clave pública a partir de la privada.</p><div class="custom-container info"><p class="custom-container-title">Algoritmo RSA</p><p>En la familia de algoritmos RSA (Rivest, Shamir y Adleman) la clave pública consiste en un número que es el producto de dos factores primos muy grandes (mayores que 10^100) y la clave privada se deriva de la factorización de dicho número, es decir, los dos factores primos.</p><p>Requiere poco procesamiento multiplicar dos números primos tan grandes, pero requiere una cantidad enorme de cálculos encontrar la factorización del número.</p></div><p>A diferencia del cifrado simétrico, el el cifrado asimétrico se usan funciones diferentes para cifrar y descifrar los mensajes.</p><ul><li>Para <strong>encriptación</strong> se usa la <strong>clave pública</strong>. Cualquiera puede tener acceso a la clave pública, mediante la cual, usando la función de cifrado, se encripta la información dirigida a un destinatario concreto (el propietario de la clave privada asociada).</li><li>Para <strong>desencriptación</strong> se usa la <strong>clave privada</strong>, que debe mantenerse a buen recaudo ya que sólo con esa clave y la función de descifrado se puede desencriptar un mensaje cifrado con la clave pública correspondiente.</li></ul><p>Entre los algoritmos de cifrado asimétrico más utilizados se encuentran</p><ul><li>Rivest Shamir Adleman (RSA). Basado en la factorización de números primos grandes.</li><li>Digital Signature Standard (DSS), que incorpora Digital Signature Algorithm (DSA).</li><li>Elliptical Curve Cryptography (ECC). Está basado en las matemáticas de las curvas elípticas</li><li>the Diffie-Hellman exchange method.</li><li>TLS/SSL protocol.</li></ul><p><img src="/psp_pages/assets/asymmetric-encryption-primitive.d6bf9e12.png" alt="cifrado asimétrico"></p><h2 id="_6-4-2-firma-digital" tabindex="-1">6.4.2. Firma digital</h2><p>Con la firma digital Para cifrar y descifrar un mensaje necesitamos una clave y escoger el tipo de cifrado que queremos. En JCA se procede de la siguiente forma:</p><p><img src="/psp_pages/assets/proceso-firma-digital.eb98cbe9.png" alt="cifrado asimétrico"></p><p>El proceso básico que se sigue para la firma electrónica es el siguiente:</p><ol><li>El usuario dispone de un documento electrónico (una hoja de cálculo, un pdf, una imagen, incluso un formulario en una página web) y de un <strong>certificado</strong> (clave pública y clave privada) que le pertenece y le identifica.</li><li>La aplicación o dispositivo digital utilizados para la firma realiza un <strong>resumen del documento</strong>. El resumen de un documento de gran tamaño puede llegar a ser tan solo de unas líneas. Este resumen es único y cualquier modificación del documento implica también una modificación del resumen.</li><li>La aplicación utiliza la clave privada para codificar el resumen.</li><li>La aplicación crea otro documento electrónico que contiene ese resumen codificado. Este nuevo documento es la firma electrónica.</li></ol><p>El resultado de todo este proceso es un documento electrónico obtenido a partir del documento original y de las claves del firmante. La firma electrónica, por tanto, es el mismo documento electrónico resultante.</p><p><img src="/psp_pages/assets/digital-signature-sign-verify.ba53d8da.png" alt="verificación de firma digital"></p><h3 id="integridad" tabindex="-1">Integridad</h3><p>Como estamos comparando funciones de resumen de un documento, se puede detectar de forma muy sencilla si el documento ha sufrido alguna modificación respecto al momento en el que se firmó, garantizando de esta forma la integridad de la información firmada.</p><h3 id="autenticacion-y-no-repudio" tabindex="-1">Autenticación y no repudio</h3><p>Por las características de los algoritmos de cifrado se puede determinar, a partir del resumen cifrado con la clave privada, mediante el uso de la clave pública, que el mensaje recibido lo generó el propietario de la clave privada.</p><p>Con esta característica se puede probar y demostrar que el mensaje lo firmó el emisor y no cualquier otra persona, garantizando por un lado la autoría y por otro evitando que el emisor niegue haber generado esa información.</p><h2 id="_6-4-3-certificados-digitales" tabindex="-1">6.4.3 Certificados digitales</h2><p>Un certificado digital es un documento electrónico expedido por una <strong>Autoridad de Certificación</strong> e identifica a una persona (física o jurídica) con un par de claves.Tiene como misión validar y certificar que una firma electrónica se corresponde con una persona o entidad concreta.</p><p>Contiene la información necesaria para firmar electrónicamente e identificar a su propietario con sus datos: nombre, NIF, algoritmo y claves de firma, fecha de expiración y organismo que lo expide.</p><p>La Autoridad de Certificación da fe de que la firma electrónica se corresponde con un usuario concreto. Esa es la razón por la que los certificados están firmados, a su vez, por la Autoridad de Certificación.</p><h3 id="claves-digitales" tabindex="-1">Claves digitales</h3><p>En un certificado, las claves digitales son los elementos esenciales para la firma e identificación del firmante. Existen dos claves, la <strong>clave privada</strong> y <strong>clave pública</strong>, y trabajan de forma complementaria. <em>Lo que cifra o codifica una clave sólo lo puede descifrar o decodificar la otra</em>.</p><p>La diferencia entre ellas es que la clave privada está pensada para que nunca salga del certificado y esté siempre bajo el control del firmante. En cambio, la clave pública se puede repartir o enviar a otros usuarios.</p><p>En ocasiones, se habla de Certificado Privado para referirse al certificado que contiene la clave privada y la pública y del Certificado Público para referirse al certificado que sólo contiene la clave pública.</p><div class="custom-container info"><p class="custom-container-title">Creación de Certificados digitales</p><p>Obtener el Certificado Digital depende de si el certificado está contenido en una tarjeta, como el DNIe, o de si el certificado se guarda en un fichero software.</p><p>En ambos procesos hay un paso que es la identificación del responsable o usuario del certificado, lo cual requiere que éste <strong>se persone en las oficinas de una Autoridad de Registro</strong>. Estas oficinas corroboran la identidad.</p></div><h3 id="infraestructura-de-clave-publica-pki" tabindex="-1">Infraestructura de clave pública (PKI)</h3><p>Una infraestructura de clave pública (PKI) es una combinación de hardware, software, procedimientos de seguridad y marco legal que, en su conjunto, permite la ejecución con garantías de operaciones criptográficas, cumpliendo los requisitos de integridad, confidencialidad, autenticación y no repudio.</p><p>Una PKI permite establecer y gestionar asociaciones entre claves públicas e identidades de personas y organizaciones.</p><p>La cuestión entonces es determinar si un certificado es válido o de confianza, ol o que es lo mismo, si representa a la persona u organización que aparece como titular y propietario del certificado.</p><p>Para dar por válido un certificado digital su firma digital debe ser válida y su emisor debe ser un emisor de confianza. Por lo tanto, ahora queda determinar qué emisores son de confianza.</p><div class="custom-container warning"><p class="custom-container-title">Autenticidad de los certificados</p><p>Los certificados deben estar firmados por una AC por dos motivos</p><ol><li>Garantizar su integridad, de forma que cualquier intento de modificación del certificado lo invalide.</li><li>Identificar al creador del certificado digital. Todo el sistema está basado en una relación de confianza, en la que la AC que ha firmado el certificado es un emisor de confianza, normalmente instituciones públicas o privadas de reconocido prestigio</li></ol></div><p>En nuestro sistema podemos ver y modificar qué entidades de certificación consideramos como seguras, es decir, que los certificados que éstas hayan firmado los tomaremos como válidos.</p><p><a href="https://docs.microsoft.com/es-es/exchange/trusted-root-certification-authorities-for-federation-trusts-exchange-2013-help" target="_blank" rel="noopener noreferrer">Autoridades de confianza para apps de Azure<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">Open in new window</span></span></a></p><p>En Windows, si ejecutamos <code>certmgr.msc</code> podemos acceder a la configuración de certificados del sistema. En OSX lo podemos hacer con la aplicación <code>Llavero</code>.</p><p>Para nuestra navegación, la información de qué certificados considera el navegador como seguros, depende de en qué AC confiemos (por defecto en la instalación vienen configurados los más comunes)</p><p><a href="https://www.adminfacil.es/como-ver-los-certificados-instalados-en-google-chrome/" target="_blank" rel="noopener noreferrer">Ver certificados y AC en Chrome<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">Open in new window</span></span></a></p><div class="custom-container danger"><p class="custom-container-title">Certificados autofirmados</p><p><strong>Hemos de tener en cuenta que, con herramientas como las que proporciona Java, SSH o GnuPG cualquiera puede generar un certificado digital con la información que quiera</strong></p><p>Para las pruebas vamos a firmar nuestros propios certificados. Incluso dentro de una compañía podemos ejercer nosotros mismos como Autoridad de Certificación de Confianza, firmando nuestros certificados.</p><p>Debemos preparar la configuración de nuestros sistemas para que <strong>confíen</strong> en esos certificados autofirmados, asumiendo el riesgo que esto conlleva.</p></div><h2 id="_6-4-4-generacion-de-pares-de-claves" tabindex="-1">6.4.4. Generación de pares de claves</h2><p>La generación y gestión de pares de claves implica dos aspectos fundamentales.</p><p>Por un lado, tenemos la creación de las claves. Las claves las podemos haber descargado, generado con alguna de las utilidades disponibles para ellos o bien, como veremos a continuación, se pueden generar desde una aplicación, igual que hacemos con las claves simétricas.</p><p>Por otro lado, tenemos la gestión del almacenamiento de las claves. Las claves no dejan de ser archivos, que podemos tratar como archivos especiales, pero que usualmente se almacenan en repositorios especiales, denominados <code>keyrings</code> a los que puede acceder una aplicación y desde los que gestionamos las relaciones de confianza.</p><p>El JCA nos proporciona clases generadoras de claves. Estas clases se apoyan en buenos algoritmos de generación de números aleatorios para satisfacer unos requisitos mínimos de seguridad.</p><div class="custom-container info"><p class="custom-container-title">SecureRandom</p><p>La generación de números aleatorios juega un papel fundamental en la criptografía, siendo uno de los <strong>Engine</strong> que proporciona el JCA junto con un amplio grupo de algoritmos.</p><p>La clase <strong>SecureRandom</strong> genera número aleatorios empleando alguno de los algoritmos disponibles y se puede utilizar un objeto de tipo SecureRandom para que los utilicen las clases generadoras de claves, tanto simétricas como asimétricas</p></div><h3 id="tipos-de-ficheros-para-certificados-digitales" tabindex="-1">Tipos de ficheros para certificados digitales</h3><p>Hay varios tipos de ficheros que se utilizan para guardar certificados digitales siguiendo el estándar X.509. Generalmente uncertificado no contiene sólo la clave, sino que tiene información adicional.</p><p>Esxiten dos posibles codificaciones para almacenar certificados X.509</p><ul><li>der: Es una codificación binaria</li><li>dem: Es una codificación en formato texto guardado en Base64 y tienen un encabezado y pie que delimita el contenido del certificado</li></ul><p>Veamos un ejemplo de certificado con codificación dem</p><div class="language-bash ext-sh line-numbers-mode"><pre class="shiki" style="background-color:#FAFAFA;"><code><span class="line"><span style="color:#90A4AE;">-----BEGIN CERTIFICATE----- </span></span>
<span class="line"><span style="color:#90A4AE;">MIIDijCCAvOgAwIBAgIJAKRvtQxONVZoMA0GCSqGSIb3DQEBBAUAMIGLMQswCQYD </span></span>
<span class="line"><span style="color:#90A4AE;">VQQGEwJVUzETMBEGA1UECBMKQ2FsaWZvcm5pYTESMBAGA1UEBxMJU3Vubnl2YWxl </span></span>
<span class="line"><span style="color:#90A4AE;">MSAwHgYDVQQKExdBcnViYSBXaXJlbGVzcyBOZXR3b3JrczEMMAoGA1UECxMDVEFD </span></span>
<span class="line"><span style="color:#90A4AE;">MSMwIQYDVQQDExpteXNlcnZlci5hcnViYW5ldHdvcmtzLmNvbTAeFw0wODA0MzAy </span></span>
<span class="line"><span style="color:#90A4AE;">MzM3MDJaFw0xMDA0MzAyMzM3MDJaMIGLMQswCQYDVQQGEwJVUzETMBEGA1UECBMK </span></span>
<span class="line"><span style="color:#90A4AE;">Q2FsaWZvcm5pYTESMBAGA1UEBxMJU3Vubnl2YWxlMSAwHgYDVQQKExdBcnViYSBX </span></span>
<span class="line"><span style="color:#90A4AE;">aXJlbGVzcyBOZXR3b3JrczEMMAoGA1UECxMDVEFDMSMwIQYDVQQDExpteXNlcnZl </span></span>
<span class="line"><span style="color:#90A4AE;">ci5hcnViYW5ldHdvcmtzLmNvbTCBnzANBgkqhkiG9w0BAQEFAAOBjQAwgYkCgYEA </span></span>
<span class="line"><span style="color:#90A4AE;">zRwqc9prVXycGhHcsAjGPzC2MKU4DhXSr86Z89Jk8/cXEJBJ0C/NgdAqqDgxneUh </span></span>
<span class="line"><span style="color:#90A4AE;">nVyxGxODa7BNGAWSagdCsKLrbkchr479E3xLfgdc3UzAJITLGCXGiQ66NwQDyM5I </span></span>
<span class="line"><span style="color:#90A4AE;">G/xKYm4oqgyOE/lFTTkK0M8V0NmmJynyOCYC/AwQKjMCAwEAAaOB8zCB8DAdBgNV </span></span>
<span class="line"><span style="color:#90A4AE;">HQ4EFgQUM5btT6IlPGkLTTPvFccTVURO1p0wgcAGA1UdIwSBuDCBtYAUM5btT6Il </span></span>
<span class="line"><span style="color:#90A4AE;">PGkLTTPvFccTVURO1p2hgZGkgY4wgYsxCzAJBgNVBAYTAlVTMRMwEQYDVQQIEwpD </span></span>
<span class="line"><span style="color:#90A4AE;">YWxpZm9ybmlhMRIwEAYDVQQHEwlTdW5ueXZhbGUxIDAeBgNVBAoTF0FydWJhIFdp </span></span>
<span class="line"><span style="color:#90A4AE;">cmVsZXNzIE5ldHdvcmtzMQwwCgYDVQQLEwNUQUMxIzAhBgNVBAMTGm15c2VydmVy </span></span>
<span class="line"><span style="color:#90A4AE;">LmFydWJhbmV0d29ya3MuY29tggkApG+1DE41VmgwDAYDVR0TBAUwAwEB/zANBgkq </span></span>
<span class="line"><span style="color:#90A4AE;">hkiG9w0BAQQFAAOBgQBp71WeF6dKvqUSO1JFsVhBeUesbEgx9+tx6eP328uL0oSC </span></span>
<span class="line"><span style="color:#90A4AE;">fQ6EaiXZVbrQt+PMqG0F80+4wxVXug9EW5Ob9M/opaCGI+cgtpLCwSf6CjsmAcUc </span></span>
<span class="line"><span style="color:#90A4AE;">b6EjG/l4HW2BztYJfx15pk51M49TYS7okDKWYRT10y65xcyQdfUKvfDC1k5P9Q== </span></span>
<span class="line"><span style="color:#90A4AE;">-----END CERTIFICATE-----</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Además de la codificación, tenemos formatos de fichero estándar para guardar los certificados usando una de las codificaciones anteriores</p><ul><li>cer, crt, der: Contienen certificados X.509 estándares codificados como <code>der</code></li><li>p12: Realmente hace referencia a toda una familia de estándares asociados al algoritmo RSA y definen el formato de almacenamiento de distintos tipos de claves, los PKCS#n (PKCS#8, PKCS#12, etc). Pueden contener, además de los datos del certificado, una clave privada. Si contiene la clave privada, ésta estará protegida por una contraseña que será necesaria para acceder a la clave privada. <a href="https://es.wikipedia.org/wiki/PKCS" target="_blank" rel="noopener noreferrer">PKCS en Wikipedia<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">Open in new window</span></span></a></li></ul><h3 id="generacion-de-claves-desde-java" tabindex="-1">Generación de claves desde Java</h3><p>Usando las clases del JCA, estos son los pasos que debemos seguir para generar un par de claves desde código</p><ol><li>El primer paso para obtener un par de claves es obtener un objeto <em>keyPairGenerator</em> para el algoritmo que queramos utilizar.</li><li>A continuación se inicializa el generador del par de claves llamando a alguna de las versiones del método <em>initialize</em>. En nuestro caso indicaremos el tamaño de clave para el algoritmo seleccionado y un generador de números aleatorios.</li><li>El último paso es generar el par de claves y guardarlas en los objetos PrivateKey y PublicKey respectivamente.</li><li>A partir de ese momento ya se pueden usar las claves para cifrar, descifrar e incluso para firmar. Sin embargo, si queremos reutilizar estas claves, lo que tendremos que hacer será guardarlas en sendos archivos.</li></ol><p>A continuación podemos ver un ejemplo de generación de claves, almacenamiento de las claves en un fichero y visualización de la clave obtenida.</p><div class="language-java ext-java line-numbers-mode"><pre class="shiki" style="background-color:#FAFAFA;"><code><span class="line"><span style="color:#9C3EDA;">public</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">class</span><span style="color:#90A4AE;"> </span><span style="color:#E2931D;">U6S5_GenerateRsaKeyPair</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">private</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">static</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">final</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">int</span><span style="color:#90A4AE;"> tamanoClaveAsimetrica </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#F76D47;">1024</span><span style="color:#39ADB5;">;</span></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">private</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">static</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">final</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">String</span><span style="color:#90A4AE;"> algoritmoClaveAsimetrica </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">RSA</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">;</span></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">private</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">static</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">final</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">String</span><span style="color:#90A4AE;"> ficheroClavePublica </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">claves/clavepublica.der</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">;</span></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">private</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">static</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">final</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">String</span><span style="color:#90A4AE;"> ficheroClavePrivada </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">claves/claveprivada.pkcs8</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">public</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">static</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">void</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">main</span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">String</span><span style="color:#39ADB5;">[]</span><span style="color:#90A4AE;"> args</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;font-style:italic;">try</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Elijo un algoritmo de generación de números aleatorios de los denominados</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// altamente seguros para generar el par de claves</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#9C3EDA;">SecureRandom</span><span style="color:#90A4AE;"> algoritmoSeguro </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> SecureRandom</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getInstanceStrong</span><span style="color:#39ADB5;">();</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Preparo el generados de claves para usar el algortimo RSA</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#9C3EDA;">KeyPairGenerator</span><span style="color:#90A4AE;"> genParClaves </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> KeyPairGenerator</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getInstance</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">algoritmoClaveAsimetrica</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">            genParClaves</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">initialize</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">tamanoClaveAsimetrica</span><span style="color:#39ADB5;">,</span><span style="color:#90A4AE;"> algoritmoSeguro</span><span style="color:#39ADB5;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Creo el par de claves y lo guardo en objetos</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#9C3EDA;">KeyPair</span><span style="color:#90A4AE;"> parClaves </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> genParClaves</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">generateKeyPair</span><span style="color:#39ADB5;">();</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#9C3EDA;">PublicKey</span><span style="color:#90A4AE;"> clavePublica </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> parClaves</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getPublic</span><span style="color:#39ADB5;">();</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#9C3EDA;">PrivateKey</span><span style="color:#90A4AE;"> clavePrivada </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> parClaves</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getPrivate</span><span style="color:#39ADB5;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Guardamos la clave pública en un archivo y la visualizamos</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// La clave se guarda con codificación DER y en formato X.509</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#6182B8;">guardaClavePublicaX509</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">clavePublica</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">            </span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Guardamos la clave privada en un archivo y la visualizamos</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// La clave se guarda con codificación DER y en formato PKCS#8</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#6182B8;">guardaClavePrivadaPKCS8</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">clavePrivada</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">            </span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">catch</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">NoSuchAlgorithmException</span><span style="color:#90A4AE;"> ex</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">            System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">err</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">No se ha encontrado la implementación del algortimo en ningún Provider</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#39ADB5;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">private</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">static</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">void</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">guardaClavePublicaX509</span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">PublicKey</span><span style="color:#90A4AE;"> clavePublica</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;font-style:italic;">try</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">FileOutputStream</span><span style="color:#90A4AE;"> publicKeyFile </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">FileOutputStream</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">ficheroClavePublica</span><span style="color:#39ADB5;">))</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#9C3EDA;">X509EncodedKeySpec</span><span style="color:#90A4AE;"> codificacionClavePublica </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">X509EncodedKeySpec</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">clavePublica</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getEncoded</span><span style="color:#39ADB5;">(),</span><span style="color:#90A4AE;"> algoritmoClaveAsimetrica</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">            publicKeyFile</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">write</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">clavePublica</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getEncoded</span><span style="color:#39ADB5;">());</span></span>
<span class="line"><span style="color:#90A4AE;">            </span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Visualizamos la clave por consola</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#6182B8;">MostrarClaveBase64</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">codificacionClavePublica</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getEncoded</span><span style="color:#39ADB5;">(),</span></span>
<span class="line"><span style="color:#90A4AE;">                    codificacionClavePublica</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getFormat</span><span style="color:#39ADB5;">(),</span><span style="color:#90A4AE;"> ficheroClavePublica</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">catch</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">IOException</span><span style="color:#90A4AE;"> ex</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">            System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">out</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">Error almacenando la clave pública en </span><span style="color:#39ADB5;">&quot;</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> ficheroClavePublica</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span><span style="color:#90A4AE;">                </span></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#39ADB5;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">private</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">static</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">void</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">guardaClavePrivadaPKCS8</span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">PrivateKey</span><span style="color:#90A4AE;"> clavePrivada</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;font-style:italic;">try</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">FileOutputStream</span><span style="color:#90A4AE;"> privateKeyFile </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">FileOutputStream</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">ficheroClavePrivada</span><span style="color:#39ADB5;">))</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#9C3EDA;">PKCS8EncodedKeySpec</span><span style="color:#90A4AE;"> codificacionClavePrivada </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">PKCS8EncodedKeySpec</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">clavePrivada</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getEncoded</span><span style="color:#39ADB5;">(),</span><span style="color:#90A4AE;"> algoritmoClaveAsimetrica</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">            privateKeyFile</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">write</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">clavePrivada</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getEncoded</span><span style="color:#39ADB5;">());</span></span>
<span class="line"><span style="color:#90A4AE;">            </span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Visualizamos la clave por consola</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#6182B8;">MostrarClaveBase64</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">codificacionClavePrivada</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getEncoded</span><span style="color:#39ADB5;">(),</span></span>
<span class="line"><span style="color:#90A4AE;">                    codificacionClavePrivada</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getFormat</span><span style="color:#39ADB5;">(),</span><span style="color:#90A4AE;"> ficheroClavePrivada</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">catch</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">IOException</span><span style="color:#90A4AE;"> ex</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">            System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">out</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">Error almacenando la clave privada en </span><span style="color:#39ADB5;">&quot;</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> ficheroClavePrivada</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span><span style="color:#90A4AE;">        </span></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#39ADB5;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">private</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">static</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">void</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">MostrarClaveBase64</span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">byte</span><span style="color:#39ADB5;">[]</span><span style="color:#90A4AE;"> clave</span><span style="color:#39ADB5;">,</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">String</span><span style="color:#90A4AE;"> formatoClave</span><span style="color:#39ADB5;">,</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">String</span><span style="color:#90A4AE;"> ficheroClave</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">        System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">out</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">Clave guardada en formato </span><span style="color:#39ADB5;">&quot;</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> formatoClave </span></span>
<span class="line"><span style="color:#90A4AE;">                </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;"> en fichero </span><span style="color:#39ADB5;">&quot;</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> ficheroClave</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">        System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">out</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">Base64</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getEncoder</span><span style="color:#39ADB5;">().</span><span style="color:#6182B8;">encodeToString</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">clave</span><span style="color:#39ADB5;">).</span><span style="color:#6182B8;">replaceAll</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">(.{76})</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">,</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">$1</span><span style="color:#90A4AE;">\n</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">));</span></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#39ADB5;">}</span></span>
<span class="line"><span style="color:#39ADB5;">}</span></span>
<span class="line"></span></code></pre><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlight-line"> </div><div class="highlight-line"> </div><br><br><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlight-line"> </div><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlight-line"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Esta sería la salida proporcionada</p><div class="language-bash ext-sh line-numbers-mode"><pre class="shiki" style="background-color:#FAFAFA;"><code><span class="line"><span style="color:#90A4AE;">Clave guardada en formato X.509 en fichero claves/clavepublica.der</span></span>
<span class="line"><span style="color:#90A4AE;">MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC4UFRgEIm3lFKO75QmqTPvkDs0fM6NUm2FHQcA</span></span>
<span class="line"><span style="color:#90A4AE;">cQHawLx9/WKXh9xkx/xYZZcc4L2YQYcwTu4jfk889iGKGLn2Kh4ywBY+g8uZ6ljM5PT6f95dU6Zd</span></span>
<span class="line"><span style="color:#90A4AE;">xATWOn1qsizBubf7kKhBL7xDnKU5do3XYzrSjme+9uIsgS7HQ7K0MbKrpQIDAQAB</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">Clave guardada en formato PKCS#8 en fichero claves/claveprivada.pkcs8</span></span>
<span class="line"><span style="color:#90A4AE;">MIICdgIBADANBgkqhkiG9w0BAQEFAASCAmAwggJcAgEAAoGBALhQVGAQibeUUo7vlCapM++QOzR8</span></span>
<span class="line"><span style="color:#90A4AE;">zo1SbYUdBwBxAdrAvH39YpeH3GTH/FhllxzgvZhBhzBO7iN+Tzz2IYoYufYqHjLAFj6Dy5nqWMzk</span></span>
<span class="line"><span style="color:#90A4AE;">9Pp/3l1Tpl3EBNY6fWqyLMG5t/uQqEEvvEOcpTl2jddjOtKOZ7724iyBLsdDsrQxsqulAgMBAAEC</span></span>
<span class="line"><span style="color:#90A4AE;">gYA97xBLL4N3YqnTSgIYc6b2Cxs56e5mYppWrohZx5996GHuXCSzEn4mh2TuN0Tt+T78WJiazQsM</span></span>
<span class="line"><span style="color:#90A4AE;">djceHv7qLqDd2kWn3IR0gX207KxwjG0I/sAP2z/i9NZ7DPL+FUv8lmeYUfDj8h3wkyhmBqn+tan1</span></span>
<span class="line"><span style="color:#90A4AE;">0xIOcZUrr/yRhrjZLI1SCQJBAPEc4uWSbyBLHVC6SNga7XWNmwi8Mq4PZJdhW9RJWDxg9zOlC/HV</span></span>
<span class="line"><span style="color:#90A4AE;">rV60ddbfW/ldIqCH33DUge5U5YhD6Mla/XMCQQDDsahcwTksp2bJowMTRgFHT094sihtSlQ7sgdI</span></span>
<span class="line"><span style="color:#90A4AE;">uAemuMvBmVTHleFBWMqz1rAN6A/76yef3WK4I+nsmeCGa+yHAkEA7BR1kYT8q+kATi/n7TkIcoZx</span></span>
<span class="line"><span style="color:#90A4AE;">W28yTD2kJ5jbWhNqgswKn5WmCWdH9qfJjddrbdEke3wuaoKYqeyURgUAJE+kQwJADhEsQBanrH0Q</span></span>
<span class="line"><span style="color:#90A4AE;">F3h/VRhYKS8bUFrGKy0Hpw7iFSkda6+m/fCutnYgrhja4ViSaT2AQKSjwYsheIkkXJynFiKV6wJA</span></span>
<span class="line"><span style="color:#90A4AE;">PUHXqlvfgPr4w2U+Ddq7h/gp59kO0uojGrEBO0B2wt3PuuSQlZlMN97Ly9QmB6LYRtw6woCZZZOD</span></span>
<span class="line"><span style="color:#90A4AE;">ePqA7rf8IA==</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>En el ejemplo anterior en lugar de utilizar clases estándar para volcar el contenido binario de las claves a un archivo en formato raw, se utilizan clases codificadoras para generar ficheros binarios en formatos estándares, tanto para la clave pública como para la privada.</p><p>Esto tiene la enorme ventaja de que se pueden utilizar las claves generadas con herramientas estándar como openssl. Además, facilita la tarea ya que las claves pública y privada para criptografía asimétrica son objetos compuestos.</p><div class="custom-container info"><p class="custom-container-title">Codificación Base64</p><p>Base64 es un grupo de esquemas de codificación de binario a texto que representa los datos binarios mediante una cadena.</p><p>Los esquemas de codificación Base64 son comúnmente usados cuando se necesita codificar datos binarios para que sean almacenados y transferidos sobre un medio diseñado para tratar con datos textuales. Esto es para asegurar que los datos se mantienen intactos y sin modificaciones durante la transmisión.</p><p>Los valores codificados en Base64 como texto se muestran en filas de 76 caracteres como máximo, para mejor legibilidad, y siguiendo convenciones habituales.</p><p>Para verlos en pantalla se añade un salto de línea después de cada grupo de 76 caracteres usando <code>replaceAll(&quot;(.{76})&quot;, &quot;$1\n&quot;)</code>.</p></div><p>Las claves que se han guardado con el programa tienen las siguientes características:</p><ul><li>La clave pública se guarda en un fichero <code>clavepublica.der</code>, con el formato de la estructura <em>SubjectPublicKeyInfo</em> en formato <em>ASN.1</em> definido en el estándar <em>X.509</em>, y con codificación <em>DER (binaria)</em>. Para eso se ha utilizado la clase codificadora <strong>X509EncodedKeySpec</strong>.</li><li>La clave privada se guarda en un fichero <code>claveprivada.pkcs8</code>, en formato <em>PKCS#8</em>, y con codificación <em>DER (binaria)</em>. Para eso se ha utilizado la clase codificadora <strong>PKCS8EncodedKeySpec</strong>.</li></ul><div class="custom-container info"><p class="custom-container-title">Codificaciones por defecto</p><p>Las codificaciones usadas en el programa coinciden con las codificacione por defecto que usan las clases PrivateKey y PublicKey, como se puede ver en los valores proporcionados por los métodos getFormat() y getEncoded().</p></div><h2 id="_6-4-5-cifrado-y-descifrado-usando-un-par-de-claves" tabindex="-1">6.4.5. Cifrado y descifrado usando un par de claves</h2><p>Aunque ya hemos visto que las claves se pueden generar desde código, lo normal es que una vez hayamos generado un par de claves, estas se puedan reutilizar desde las aplicaciones para cifrar y descifrar información.</p><p>Si hemos guardado las claves en archivos, el primer paso que tendremos que realizar es recuperar esas claves para poder realizar las operaciones criptográficas con ellas.</p><div class="custom-container question"><p class="custom-container-title">Prueba de claves online</p><p>Podemos probar las claves generadas con una herramienta online.</p><p><a href="https://www.devglan.com/online-tools/rsa-encryption-decryption" target="_blank" rel="noopener noreferrer">Online RSA tool<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">Open in new window</span></span></a></p><p>Prueba a copiar el contenido (en Base64) de las claves pública y privada para hacer un cifrado y un descifrado de la información.</p><p>También puedes probar a simular una firma digital, realizando el cifrado con la clave privada y el descifrado con la clave pública.</p></div><p>Veamos un ejemplo de cómo se hace todo este proceso en Java</p><div class="language-java ext-java line-numbers-mode"><pre class="shiki" style="background-color:#FAFAFA;"><code><span class="line"><span style="color:#9C3EDA;">public</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">class</span><span style="color:#90A4AE;"> </span><span style="color:#E2931D;">U6S6_RsaKeyPairEncrypt</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">private</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">static</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">final</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">int</span><span style="color:#90A4AE;"> tamanoClaveAsimetrica </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#F76D47;">1024</span><span style="color:#39ADB5;">;</span></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">private</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">static</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">final</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">String</span><span style="color:#90A4AE;"> algoritmoClaveAsimetrica </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">RSA</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">;</span></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">private</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">static</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">final</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">String</span><span style="color:#90A4AE;"> ficheroClavePublica </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">claves/clavepublica.der</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">;</span></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">private</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">static</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">final</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">String</span><span style="color:#90A4AE;"> ficheroClavePrivada </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">claves/claveprivada.pkcs8</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">public</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">static</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">void</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">main</span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">String</span><span style="color:#39ADB5;">[]</span><span style="color:#90A4AE;"> args</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;font-style:italic;">try</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">//////////////////////////////////////////////////</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// CIFRADO</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">//////////////////////////////////////////////////</span></span>
<span class="line"><span style="color:#90A4AE;">            </span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Leemos la clave pública de un archivo</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#9C3EDA;">PublicKey</span><span style="color:#90A4AE;"> clavePublica </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">leerClavePublica</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">ficheroClavePublica</span><span style="color:#39ADB5;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Preparamos la información que queremos cifrar</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#9C3EDA;">String</span><span style="color:#90A4AE;"> textoEnClaro </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">Quiero cifrar este mensaje de prueba</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">;</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#9C3EDA;">byte</span><span style="color:#39ADB5;">[]</span><span style="color:#90A4AE;"> mensajeEnClaro </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> textoEnClaro</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getBytes</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">UTF-8</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">            </span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Realizamos el proceso de cifrado con clave pública</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Los pasos son exactamente los mismos que con el cifrado simétrico</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#9C3EDA;">Cipher</span><span style="color:#90A4AE;"> cifrado </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> Cipher</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getInstance</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">algoritmoClaveAsimetrica</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">            cifrado</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">init</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">Cipher</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">ENCRYPT_MODE</span><span style="color:#39ADB5;">,</span><span style="color:#90A4AE;"> clavePublica</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#9C3EDA;">byte</span><span style="color:#39ADB5;">[]</span><span style="color:#90A4AE;"> mensajeCifrado </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> cifrado</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">doFinal</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">mensajeEnClaro</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Visualizamos el mensaje cifrado en modo texto</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#6182B8;">MostrarMensajeBase64</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">mensajeCifrado</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">            </span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">//////////////////////////////////////////////////</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// DESCIFRADO</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">//////////////////////////////////////////////////</span></span>
<span class="line"><span style="color:#90A4AE;">            </span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Leemos la clave privada de un archivo</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#9C3EDA;">PrivateKey</span><span style="color:#90A4AE;"> clavePrivada </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">leerClavePrivada</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">ficheroClavePrivada</span><span style="color:#39ADB5;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Realizamos el proceso de descifrado con clave privada</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Los pasos son exactamente los mismos que con el cifrado simétrico</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Cipher cifrado = Cipher.getInstance(algoritmoClaveAsimetrica);</span></span>
<span class="line"><span style="color:#90A4AE;">            cifrado</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">init</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">Cipher</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">DECRYPT_MODE</span><span style="color:#39ADB5;">,</span><span style="color:#90A4AE;"> clavePrivada</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#9C3EDA;">byte</span><span style="color:#39ADB5;">[]</span><span style="color:#90A4AE;"> mensajeDescifrado </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> cifrado</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">doFinal</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">mensajeCifrado</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Visualizamos el mensaje descifrado</span></span>
<span class="line"><span style="color:#90A4AE;">            System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">out</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">Texto descifrado:</span><span style="color:#90A4AE;">\n</span><span style="color:#39ADB5;">&quot;</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">String</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">mensajeDescifrado</span><span style="color:#39ADB5;">,</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">UTF-8</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">));</span></span>
<span class="line"><span style="color:#90A4AE;">                        </span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">catch</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">UnsupportedEncodingException</span><span style="color:#90A4AE;"> ex</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">            System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">out</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">Codificación de caracteres UTF-8 no soportada</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">catch</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">NoSuchAlgorithmException</span><span style="color:#90A4AE;"> ex</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">            System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">err</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">No se ha encontrado la implementación del algoritmo </span><span style="color:#39ADB5;">&quot;</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> algoritmoClaveAsimetrica </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;"> en ningún Provider</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">catch</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">NoSuchPaddingException</span><span style="color:#90A4AE;"> ex</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">            System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">err</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">El relleno especificado para el algoritmo no está permitido</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">catch</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">InvalidKeyException</span><span style="color:#90A4AE;"> ex</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">            System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">err</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">Especificación de clave no válida</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">catch</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">IllegalBlockSizeException</span><span style="color:#90A4AE;"> ex</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">            System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">err</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">Tamaño de bloque no válido</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">catch</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">BadPaddingException</span><span style="color:#90A4AE;"> ex</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">            System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">err</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">Excepción con el relleno usado por el algoritmo</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#39ADB5;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">private</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">static</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">PublicKey</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">leerClavePublica</span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">String</span><span style="color:#90A4AE;"> ficheroClave</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#9C3EDA;">byte</span><span style="color:#39ADB5;">[]</span><span style="color:#90A4AE;"> clavePublicaEncoded</span><span style="color:#39ADB5;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#39ADB5;">        </span><span style="color:#90A4AE;font-style:italic;">// Leemos la información del archivo</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;font-style:italic;">try</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">FileInputStream</span><span style="color:#90A4AE;"> publicKeyFile </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">FileInputStream</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">ficheroClave</span><span style="color:#39ADB5;">))</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">            clavePublicaEncoded </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> publicKeyFile</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">readAllBytes</span><span style="color:#39ADB5;">();</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">catch</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">FileNotFoundException</span><span style="color:#90A4AE;"> ex</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">            System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">out</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">No se ha encontrado el archivo </span><span style="color:#39ADB5;">&quot;</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> ficheroClave </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;"> con la clave pública.</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#39ADB5;font-style:italic;">return</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">null;</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">catch</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">IOException</span><span style="color:#90A4AE;"> ex</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">            System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">out</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">Se ha producido un error de E/S accediendo al archivo </span><span style="color:#39ADB5;">&quot;</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> ficheroClave </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;"> de la clave pública.</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#39ADB5;font-style:italic;">return</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">null;</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#39ADB5;">        </span><span style="color:#90A4AE;font-style:italic;">// Generamos la clave a partir del array de bytes leídos</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#9C3EDA;">KeyFactory</span><span style="color:#90A4AE;"> keyFactory</span><span style="color:#39ADB5;">;</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;font-style:italic;">try</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">            keyFactory </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> KeyFactory</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getInstance</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">algoritmoClaveAsimetrica</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#9C3EDA;">X509EncodedKeySpec</span><span style="color:#90A4AE;"> codificacionClavePublica </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">X509EncodedKeySpec</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">clavePublicaEncoded</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#9C3EDA;">PublicKey</span><span style="color:#90A4AE;"> clavePublica </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> keyFactory</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">generatePublic</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">codificacionClavePublica</span><span style="color:#39ADB5;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Devolvemos la clave pública generada</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#39ADB5;font-style:italic;">return</span><span style="color:#90A4AE;"> clavePublica</span><span style="color:#39ADB5;">;</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">catch</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">NoSuchAlgorithmException</span><span style="color:#90A4AE;"> ex</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">            System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">err</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">No se ha encontrado la implementación del algoritmo </span><span style="color:#39ADB5;">&quot;</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> algoritmoClaveAsimetrica </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;"> en ningún Provider</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#39ADB5;font-style:italic;">return</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">null;</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">catch</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">InvalidKeySpecException</span><span style="color:#90A4AE;"> ex</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">            Logger</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getLogger</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">U6S6_RsaKeyPairEncrypt</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">class</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getName</span><span style="color:#39ADB5;">()).</span><span style="color:#6182B8;">log</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">Level</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">SEVERE</span><span style="color:#39ADB5;">,</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">null,</span><span style="color:#90A4AE;"> ex</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#39ADB5;font-style:italic;">return</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">null;</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#39ADB5;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">private</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">static</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">PrivateKey</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">leerClavePrivada</span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">String</span><span style="color:#90A4AE;"> ficheroClave</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#9C3EDA;">byte</span><span style="color:#39ADB5;">[]</span><span style="color:#90A4AE;"> clavePrivadaEncoded</span><span style="color:#39ADB5;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#39ADB5;">        </span><span style="color:#90A4AE;font-style:italic;">// Leemos la información del archivo</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;font-style:italic;">try</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">FileInputStream</span><span style="color:#90A4AE;"> privateKeyFile </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">FileInputStream</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">ficheroClave</span><span style="color:#39ADB5;">))</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">            clavePrivadaEncoded </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> privateKeyFile</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">readAllBytes</span><span style="color:#39ADB5;">();</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">catch</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">FileNotFoundException</span><span style="color:#90A4AE;"> ex</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">            System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">out</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">No se ha encontrado el archivo </span><span style="color:#39ADB5;">&quot;</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> ficheroClave </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;"> con la clave privada.</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#39ADB5;font-style:italic;">return</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">null;</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">catch</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">IOException</span><span style="color:#90A4AE;"> ex</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">            System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">out</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">Se ha producido un error de E/S accediendo al archivo </span><span style="color:#39ADB5;">&quot;</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> ficheroClave </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;"> de la clave privada.</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#39ADB5;font-style:italic;">return</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">null;</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#39ADB5;">        </span><span style="color:#90A4AE;font-style:italic;">// Generamos la clave a partir del array de bytes leídos</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#9C3EDA;">KeyFactory</span><span style="color:#90A4AE;"> keyFactory</span><span style="color:#39ADB5;">;</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;font-style:italic;">try</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">            keyFactory </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> KeyFactory</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getInstance</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">algoritmoClaveAsimetrica</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#9C3EDA;">PKCS8EncodedKeySpec</span><span style="color:#90A4AE;"> codificacionClavePrivada </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">PKCS8EncodedKeySpec</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">clavePrivadaEncoded</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#9C3EDA;">PrivateKey</span><span style="color:#90A4AE;"> clavePrivada </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> keyFactory</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">generatePrivate</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">codificacionClavePrivada</span><span style="color:#39ADB5;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Devolvemos la clave pública generada</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#39ADB5;font-style:italic;">return</span><span style="color:#90A4AE;"> clavePrivada</span><span style="color:#39ADB5;">;</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">catch</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">NoSuchAlgorithmException</span><span style="color:#90A4AE;"> ex</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">            System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">err</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">No se ha encontrado la implementación del algoritmo </span><span style="color:#39ADB5;">&quot;</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> algoritmoClaveAsimetrica </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;"> en ningún Provider</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#39ADB5;font-style:italic;">return</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">null;</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">catch</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">InvalidKeySpecException</span><span style="color:#90A4AE;"> ex</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">            Logger</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getLogger</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">U6S6_RsaKeyPairEncrypt</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">class</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getName</span><span style="color:#39ADB5;">()).</span><span style="color:#6182B8;">log</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">Level</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">SEVERE</span><span style="color:#39ADB5;">,</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">null,</span><span style="color:#90A4AE;"> ex</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#39ADB5;font-style:italic;">return</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">null;</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#39ADB5;">}</span></span>
<span class="line"><span style="color:#90A4AE;">    </span></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">private</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">static</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">void</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">MostrarMensajeBase64</span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">byte</span><span style="color:#39ADB5;">[]</span><span style="color:#90A4AE;"> mensajeCifrado</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">        System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">out</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">Mensaje cifrado visualizado como texto en Base64:</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">);</span><span style="color:#90A4AE;">                </span></span>
<span class="line"><span style="color:#90A4AE;">        System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">out</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">Base64</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getEncoder</span><span style="color:#39ADB5;">().</span><span style="color:#6182B8;">encodeToString</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">mensajeCifrado</span><span style="color:#39ADB5;">).</span><span style="color:#6182B8;">replaceAll</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">(.{76})</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">,</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">$1</span><span style="color:#90A4AE;">\n</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">));</span></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#39ADB5;">}</span><span style="color:#90A4AE;">    </span></span>
<span class="line"><span style="color:#39ADB5;">}</span></span>
<span class="line"></span></code></pre><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Y esta es la salida proporcionada</p><div class="language-bash ext-sh line-numbers-mode"><pre class="shiki" style="background-color:#FAFAFA;"><code><span class="line"><span style="color:#90A4AE;">Mensaje cifrado visualizado como texto en Base64:</span></span>
<span class="line"><span style="color:#90A4AE;">EV+7WrEf+4CYwckys9blk6DXnLHUm4i0k+4BIp3oNmPdo2skYY8bQsAhXToBx2gi/rMIK9wiJTH0</span></span>
<span class="line"><span style="color:#90A4AE;">yg99jpyaLeUgtga8PxWx1plgvxohzO/lALkf5AFRUczZh8F5QvOXCi93v2ycZCZXq7QmZTopkEQh</span></span>
<span class="line"><span style="color:#90A4AE;">ARSezD/1Al2UYPc2X68=</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">Texto descifrado:</span></span>
<span class="line"><span style="color:#90A4AE;">Quiero cifrar este mensaje de prueba</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="custom-container warning"><p class="custom-container-title">Cifrado siempre diferente, descifrado siempre igual</p><p>El resultado de cifrar un mensaje con la misma clave pública no siempre es igual, aunque al descifrar los mensajes con la clave privada siempre se obtiene el mensaje original.</p><p>Esto es debido a que, para aumentar la variabilidad (<strong>entropía</strong>) del mensaje cifrado al mensaje que se cifra se le añade una parte aleatoria (<strong>salt</strong>) que se descarta cuando se descifra.</p></div><p>En el código podemos observar cómo los procesos para cargar la clave desde un archivo usan las mismas clases que cuando se generaron, siendo el código muy parecido.</p><p>En cuanto al cifrado y descifrado se realiza con el <em>Engine Cipher</em> usando la misma secuencia de llamadas que con el cifrado simétrico.</p><h2 id="_6-2-3-cifrado-asimetrico-con-gnupg" tabindex="-1">6.2.3. Cifrado asimétrico con GnuPG</h2><p>Con la suite GnuPG también podemos generar pares de claves y cifrar y descifrar el contenido de los archivos usando diferentes algoritmos</p><div class="custom-container info"><p class="custom-container-title">Algoritmos disponibles para GnuPG</p><p>Para ver la lista de algoritmos disponibles tenemos que mostrar la ayuda del comando</p><blockquote><p>gpg --help</p></blockquote><p>y en la parte superior observamos la información de los algoritmos disponibles para cada tipo de servicio. En concreto, de resúmenes, en mi versión instalada:</p><p>Clave pública: RSA, ELG, DSA, ECDH, ECDSA, EDDSA</p></div><p>Para generar las claves, ejecutamos los siguientes comandos</p><p>TO-DO: Completar</p><p>Para cifrar y descifrar un archivo con las claves generadas, ejecutamos los siguientes comandos</p><p>TO-DO: Completar</p></div><!--[--><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">Last updated: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: vicente@iesdoctorbalmis.com">Vicente Martínez</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav"><p class="inner"><span class="prev"><a href="/psp_pages/en/unit6/symmetric-key.html" class="" aria-label="6.3 Encriptación simétrica"><!--[--><!--]--> 6.3 Encriptación simétrica <!--[--><!--]--></a></span><span class="next"><a href="/psp_pages/en/unit6/jsse.html" class="" aria-label="6.5 Comunicaciones seguras en Java"><!--[--><!--]--> 6.5 Comunicaciones seguras en Java <!--[--><!--]--></a></span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/psp_pages/assets/app.33df6748.js" defer></script>
  </body>
</html>
