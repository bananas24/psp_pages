"use strict";(self.webpackChunkapuntes_psp=self.webpackChunkapuntes_psp||[]).push([[2103],{6678:(s,l,o)=>{o.r(l),o.d(l,{data:()=>e});const e={key:"v-2a24fba0",path:"/es/unit3/producer-consumer.html",title:"3.3 Modelo productor-consumidor",lang:"es-ES",frontmatter:{title:"3.3 Modelo productor-consumidor"},excerpt:"",headers:[{level:2,title:"3.3.1. Esquema de sincronización y comunicación de hilos",slug:"_3-3-1-esquema-de-sincronizacion-y-comunicacion-de-hilos",children:[]},{level:2,title:"3.3.2 Clase Principal",slug:"_3-3-2-clase-principal",children:[]},{level:2,title:"3.3.3 Clase Productor y Consumidor",slug:"_3-3-3-clase-productor-y-consumidor",children:[]},{level:2,title:"3.3.4 Clase Compartida. Sincronización de hilos",slug:"_3-3-4-clase-compartida-sincronizacion-de-hilos",children:[]}],filePathRelative:"es/unit3/producer-consumer.md",git:{updatedTime:1635867742e3,contributors:[{name:"Vicente Martínez",email:"vicente@iesdoctorbalmis.com",commits:1}]}}},7587:(s,l,o)=>{o.r(l),o.d(l,{default:()=>V});var e=o(6252),n=o(2604);const a=(0,e._)("h1",{id:"_3-3-modelo-productor-consumidor",tabindex:"-1"},"3.3 Modelo productor-consumidor",-1),r={class:"table-of-contents"},c=(0,e.Uk)("3.3.1. Esquema de sincronización y comunicación de hilos"),t=(0,e.Uk)("3.3.2 Clase Principal"),_=(0,e.Uk)("3.3.3 Clase Productor y Consumidor"),i=(0,e.Uk)("3.3.4 Clase Compartida. Sincronización de hilos"),p=(0,e._)("h2",{id:"_3-3-1-esquema-de-sincronizacion-y-comunicacion-de-hilos",tabindex:"-1"},"3.3.1. Esquema de sincronización y comunicación de hilos",-1),A=(0,e._)("p",null,[(0,e.Uk)("La sincronización de threads implica disponer de mecanismos que permitan asegurar que no se producen situaciones de "),(0,e._)("code",null,"inanición o starvation"),(0,e.Uk)(" (bloqueo de hilos como consecuencia del acceso a recursos compartidos limitados), "),(0,e._)("code",null,"interbloqueos"),(0,e.Uk)(" (espera por parte de los hilos cuando una condición no puede ser satisfecha) y que, por lo tanto, se opera de forma correcta con los recursos compartidos por hilos concurrentes.")],-1),y=(0,e.Uk)("En esta sección vamos a ejemplificar la compartición de recursos a través de un objeto contenedor (objeto compartido) mediante el famoso algoritmo del Productor-Consumidor que podemos ver resumido en "),u={href:"https://es.wikipedia.org/wiki/Problema_productor-consumidor",target:"_blank",rel:"noopener noreferrer"},d=(0,e.Uk)("Wikipedia"),m=(0,e.Uk)("."),b=(0,e._)("p",null,"Si no se implementasen medidas de control, ya hemos visto que podrían darse situacion anómalas como:",-1),E=(0,e._)("ul",null,[(0,e._)("li",null,"El consumidor puede obtener los elementos producidos más de una vez, excediendo la producción del mismo (poder dejar la cuenta en números rojos en el ejemplo del banco, o que un lector pueda leer un libro antes de estar terminado)."),(0,e._)("li",null,"El productor sea más rápido que el Consumidor y genere más información de la que el sistema pueda almacenar, o bien parte de la información que genere se pierda sin que un Consumidor la haya recuperado."),(0,e._)("li",null,"El Consumidor es más rápidos que el Productor y puede terminar consumiendo dos o más veces el mismo valor, generando información inconsistente en el sistema.")],-1),D=(0,e._)("p",null,[(0,e.Uk)("Todas estas circunstancias son las que conocemos como condiciones de carrera o "),(0,e._)("code",null,"race conditions"),(0,e.Uk)(".")],-1),B=(0,e._)("p",null,"El esquema de clases representado por este modelo se repite fielmente entre los diferentes ejercicios que vamos a realizar, es lo que denominamos el modelo Productor-Consumidor.",-1),h=(0,e._)("p",null,[(0,e._)("img",{src:n,alt:"Producer-Consumer"})],-1),k=(0,e._)("p",null,[(0,e.Uk)("Este modelo se basa en tres clases, aunque dependiendo del problema, podemos encontrarnos que no tenemos "),(0,e._)("strong",null,"productor"),(0,e.Uk)(" o "),(0,e._)("strong",null,"consumidor"),(0,e.Uk)(".")],-1),U=(0,e._)("div",{class:"custom-container info"},[(0,e._)("p",{class:"custom-container-title"},"Modelo como patrón de diseño"),(0,e._)("p",null,"Es importante que nos ajustemos al esquema presentado en el modelo."),(0,e._)("p",null,"Como ya se ha dicho, a veces no habrá productor, otras no estará el consumidor, en otras el código de bloqueo estará sólo en una de las clases, pero no debemos inventar ni añadir nada al esquema, debemos encajar el problema a solucionar dentro del código proporcionado.")],-1),g=(0,e._)("h2",{id:"_3-3-2-clase-principal",tabindex:"-1"},"3.3.2 Clase Principal",-1),C=(0,e._)("blockquote",null,[(0,e._)("p",null,"La clase principal siempre va a tener la misma estructura. El siguiente código se puede usar como plantilla")],-1),v=(0,e._)("p",null,"En esta clase se declara el objeto o propiedad que van a compartir el productor y el consumidor. Este objeto es a través del que se realiza la comunicación, sincronización e intercambio de información entre los hilos.",-1),f=(0,e._)("p",null,"Aquí se representa como un objeto, aunque puede ser una Colección o cualquier estructura de datos que puedan compartir los hilos.",-1),q=(0,e._)("div",{class:"language-java ext-java line-numbers-mode"},[(0,e._)("pre",{class:"shiki",style:{"background-color":"#FAFAFA"}},[(0,e._)("code",null,[(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#9C3EDA"}},"public"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#9C3EDA"}},"class"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#E2931D"}},"ClasePrincipal"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#39ADB5"}},"{"),(0,e._)("span",{style:{color:"#90A4AE"}}," ")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"}),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"    "),(0,e._)("span",{style:{color:"#9C3EDA"}},"public"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#9C3EDA"}},"static"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#9C3EDA"}},"void"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#6182B8"}},"main"),(0,e._)("span",{style:{color:"#39ADB5"}},"("),(0,e._)("span",{style:{color:"#9C3EDA"}},"String"),(0,e._)("span",{style:{color:"#39ADB5"}},"[]"),(0,e._)("span",{style:{color:"#90A4AE"}}," args"),(0,e._)("span",{style:{color:"#39ADB5"}},")"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#39ADB5"}},"{"),(0,e._)("span",{style:{color:"#90A4AE"}},"    ")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"        "),(0,e._)("span",{style:{color:"#9C3EDA"}},"ClaseCompartida"),(0,e._)("span",{style:{color:"#90A4AE"}}," objetoCompartido "),(0,e._)("span",{style:{color:"#39ADB5"}},"="),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#39ADB5","font-style":"italic"}},"new"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#6182B8"}},"ObjetoCompartido"),(0,e._)("span",{style:{color:"#39ADB5"}},"();")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"        "),(0,e._)("span",{style:{color:"#9C3EDA"}},"Productor"),(0,e._)("span",{style:{color:"#90A4AE"}}," p  "),(0,e._)("span",{style:{color:"#39ADB5"}},"="),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#39ADB5","font-style":"italic"}},"new"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#6182B8"}},"Productor"),(0,e._)("span",{style:{color:"#39ADB5"}},"("),(0,e._)("span",{style:{color:"#90A4AE"}},"objetoCompartido"),(0,e._)("span",{style:{color:"#39ADB5"}},");")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"        "),(0,e._)("span",{style:{color:"#9C3EDA"}},"Consumidor"),(0,e._)("span",{style:{color:"#90A4AE"}}," c  "),(0,e._)("span",{style:{color:"#39ADB5"}},"="),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#39ADB5","font-style":"italic"}},"new"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#6182B8"}},"Consumidor"),(0,e._)("span",{style:{color:"#39ADB5"}},"("),(0,e._)("span",{style:{color:"#90A4AE"}},"objetoCompartido"),(0,e._)("span",{style:{color:"#39ADB5"}},");")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"        productor"),(0,e._)("span",{style:{color:"#39ADB5"}},"."),(0,e._)("span",{style:{color:"#6182B8"}},"start"),(0,e._)("span",{style:{color:"#39ADB5"}},"();")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"        consumidor"),(0,e._)("span",{style:{color:"#39ADB5"}},"."),(0,e._)("span",{style:{color:"#6182B8"}},"start"),(0,e._)("span",{style:{color:"#39ADB5"}},"();")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"}),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#39ADB5"}},"        "),(0,e._)("span",{style:{color:"#90A4AE","font-style":"italic"}},"// No es obligatorio, pero en ocasiones puede interesar que la ClasePrincipal")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#39ADB5"}},"        "),(0,e._)("span",{style:{color:"#90A4AE","font-style":"italic"}},"// espere a que acaben los hilos")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"        productor"),(0,e._)("span",{style:{color:"#39ADB5"}},"."),(0,e._)("span",{style:{color:"#6182B8"}},"join"),(0,e._)("span",{style:{color:"#39ADB5"}},"();")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"        consumidor"),(0,e._)("span",{style:{color:"#39ADB5"}},"."),(0,e._)("span",{style:{color:"#6182B8"}},"join"),(0,e._)("span",{style:{color:"#39ADB5"}},"();")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"}),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#39ADB5"}},"        "),(0,e._)("span",{style:{color:"#90A4AE","font-style":"italic"}},"// Acciones a realizar una vez hayan acabado el productor y el consumidor")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"    "),(0,e._)("span",{style:{color:"#39ADB5"}},"}")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"    ")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#39ADB5"}},"}")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"})])]),(0,e._)("div",{class:"highlight-lines"},[(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("div",{class:"highlight-line"}," "),(0,e._)("div",{class:"highlight-line"}," "),(0,e._)("div",{class:"highlight-line"}," "),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br")]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"11"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"12"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"13"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"14"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"15"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"16"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"17"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"18"),(0,e._)("br")])],-1),j=(0,e._)("div",{class:"custom-container warning"},[(0,e._)("p",{class:"custom-container-title"},"Número de hilos por tipo"),(0,e._)("p",null,"En el ejemplo se crea un hilo de cada tipo. Esto no tiene porqué ser así."),(0,e._)("p",null,[(0,e.Uk)("Cada problema determinará el número de hilos "),(0,e._)("em",null,"Productores"),(0,e.Uk)(" y "),(0,e._)("em",null,"Consumidores"),(0,e.Uk)(" necesarios, por lo que será en este método main, o en algún otro método de la "),(0,e._)("em",null,"ClasePrincipal"),(0,e.Uk)(" donde se realice la gestión de los hilos.")]),(0,e._)("p",null,"De igual forma, dependerá de cada problema si el hilo principal debe esperar a que el resto finalice o no.")],-1),z=(0,e._)("div",{class:"pagebreak"},null,-1),P=(0,e._)("h2",{id:"_3-3-3-clase-productor-y-consumidor",tabindex:"-1"},"3.3.3 Clase Productor y Consumidor",-1),S=(0,e._)("blockquote",null,[(0,e._)("p",null,[(0,e.Uk)("Por otro lado vamos a tener la clase del "),(0,e._)("strong",null,"productor"),(0,e.Uk)(" y del "),(0,e._)("strong",null,"consumidor"),(0,e.Uk)(" que se encargan de realizar las llamadas necesarias a los métodos del objeto compartido que reciben como parámetro.")])],-1),x=(0,e._)("p",null,[(0,e.Uk)("Estas dos clases son las que van a tener, dentro del método "),(0,e._)("strong",null,"run"),(0,e.Uk)(", la lógica de la aplicación, accediendo al objeto compartido, modificando las propiedades compartidas entre los diferentes hilos (productores y/o consumidores) y actualizando el estado del objeto compartido para que module su funcionalidad.")],-1),w=(0,e._)("div",{class:"language-java ext-java line-numbers-mode"},[(0,e._)("pre",{class:"shiki",style:{"background-color":"#FAFAFA"}},[(0,e._)("code",null,[(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#9C3EDA"}},"public"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#9C3EDA"}},"class"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#E2931D"}},"Consumidor"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#9C3EDA"}},"extends"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#E2931D"}},"Thread"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#39ADB5"}},"{")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"    "),(0,e._)("span",{style:{color:"#9C3EDA"}},"private"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#9C3EDA"}},"ClaseCompartida"),(0,e._)("span",{style:{color:"#90A4AE"}}," objetoCompartido"),(0,e._)("span",{style:{color:"#39ADB5"}},";")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"    ")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"    "),(0,e._)("span",{style:{color:"#6182B8"}},"Consumidor"),(0,e._)("span",{style:{color:"#39ADB5"}},"("),(0,e._)("span",{style:{color:"#9C3EDA"}},"ClaseCompartida"),(0,e._)("span",{style:{color:"#90A4AE"}}," objetoCompartido"),(0,e._)("span",{style:{color:"#39ADB5"}},")"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#39ADB5"}},"{")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"        "),(0,e._)("span",{style:{color:"#39ADB5"}},"this."),(0,e._)("span",{style:{color:"#90A4AE"}},"objetoCompartido "),(0,e._)("span",{style:{color:"#39ADB5"}},"="),(0,e._)("span",{style:{color:"#90A4AE"}}," objetoCompartido"),(0,e._)("span",{style:{color:"#39ADB5"}},";")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"    "),(0,e._)("span",{style:{color:"#39ADB5"}},"}")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"    ")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"    "),(0,e._)("span",{style:{color:"#39ADB5"}},"@"),(0,e._)("span",{style:{color:"#9C3EDA"}},"Override")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"    "),(0,e._)("span",{style:{color:"#9C3EDA"}},"public"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#9C3EDA"}},"void"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#6182B8"}},"run"),(0,e._)("span",{style:{color:"#39ADB5"}},"()"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#39ADB5"}},"{")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#39ADB5"}},"        "),(0,e._)("span",{style:{color:"#90A4AE","font-style":"italic"}},"// La ejecución del método run estará normalmente gestionada por un bucle")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#39ADB5"}},"        "),(0,e._)("span",{style:{color:"#90A4AE","font-style":"italic"}},"// que controlará el ciclo de vida del hilo y se adaptará al problema.")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#39ADB5"}},"        "),(0,e._)("span",{style:{color:"#90A4AE","font-style":"italic"}},"// En el caso de simulaciones se harán esperas proporcionales.")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"        "),(0,e._)("span",{style:{color:"#39ADB5","font-style":"italic"}},"try"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#39ADB5"}},"{")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#39ADB5"}},"            "),(0,e._)("span",{style:{color:"#90A4AE","font-style":"italic"}},"// Código que hace el hilo consumidor")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"            objetoCompartido"),(0,e._)("span",{style:{color:"#39ADB5"}},"."),(0,e._)("span",{style:{color:"#6182B8"}},"accionDeConsumir"),(0,e._)("span",{style:{color:"#39ADB5"}},"();")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#39ADB5"}},"            "),(0,e._)("span",{style:{color:"#90A4AE","font-style":"italic"}},"// La espera es opcional")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"            Thread"),(0,e._)("span",{style:{color:"#39ADB5"}},"."),(0,e._)("span",{style:{color:"#6182B8"}},"sleep"),(0,e._)("span",{style:{color:"#39ADB5"}},"(("),(0,e._)("span",{style:{color:"#9C3EDA"}},"long"),(0,e._)("span",{style:{color:"#39ADB5"}},")("),(0,e._)("span",{style:{color:"#90A4AE"}},"Math"),(0,e._)("span",{style:{color:"#39ADB5"}},"."),(0,e._)("span",{style:{color:"#6182B8"}},"random"),(0,e._)("span",{style:{color:"#39ADB5"}},"()*"),(0,e._)("span",{style:{color:"#F76D47"}},"1000"),(0,e._)("span",{style:{color:"#39ADB5"}},"+"),(0,e._)("span",{style:{color:"#F76D47"}},"1000"),(0,e._)("span",{style:{color:"#39ADB5"}},"));")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"        "),(0,e._)("span",{style:{color:"#39ADB5"}},"}"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#39ADB5","font-style":"italic"}},"catch"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#39ADB5"}},"("),(0,e._)("span",{style:{color:"#9C3EDA"}},"InterruptedException"),(0,e._)("span",{style:{color:"#90A4AE"}}," ex"),(0,e._)("span",{style:{color:"#39ADB5"}},")"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#39ADB5"}},"{")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"}),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"        "),(0,e._)("span",{style:{color:"#39ADB5"}},"}"),(0,e._)("span",{style:{color:"#90A4AE"}},"         ")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"    "),(0,e._)("span",{style:{color:"#39ADB5"}},"}")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#39ADB5"}},"}"),(0,e._)("span",{style:{color:"#90A4AE"}},"    ")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"})])]),(0,e._)("div",{class:"highlight-lines"},[(0,e._)("br"),(0,e._)("div",{class:"highlight-line"}," "),(0,e._)("br"),(0,e._)("br"),(0,e._)("div",{class:"highlight-line"}," "),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("div",{class:"highlight-line"}," "),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br")]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"11"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"12"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"13"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"14"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"15"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"16"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"17"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"18"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"19"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"20"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"21"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"22"),(0,e._)("br")])],-1),F=(0,e._)("div",{class:"language-java ext-java line-numbers-mode"},[(0,e._)("pre",{class:"shiki",style:{"background-color":"#FAFAFA"}},[(0,e._)("code",null,[(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#9C3EDA"}},"public"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#9C3EDA"}},"class"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#E2931D"}},"Productor"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#9C3EDA"}},"extends"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#E2931D"}},"Thread"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#39ADB5"}},"{")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"    "),(0,e._)("span",{style:{color:"#9C3EDA"}},"private"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#9C3EDA"}},"ClaseCompartida"),(0,e._)("span",{style:{color:"#90A4AE"}}," objetoCompartido"),(0,e._)("span",{style:{color:"#39ADB5"}},";")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"    ")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"    "),(0,e._)("span",{style:{color:"#6182B8"}},"Productor"),(0,e._)("span",{style:{color:"#39ADB5"}},"("),(0,e._)("span",{style:{color:"#9C3EDA"}},"ClaseCompartida"),(0,e._)("span",{style:{color:"#90A4AE"}}," objetoCompartido"),(0,e._)("span",{style:{color:"#39ADB5"}},")"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#39ADB5"}},"{")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"        "),(0,e._)("span",{style:{color:"#39ADB5"}},"this."),(0,e._)("span",{style:{color:"#90A4AE"}},"objetoCompartido "),(0,e._)("span",{style:{color:"#39ADB5"}},"="),(0,e._)("span",{style:{color:"#90A4AE"}}," objetoCompartido"),(0,e._)("span",{style:{color:"#39ADB5"}},";")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"    "),(0,e._)("span",{style:{color:"#39ADB5"}},"}")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"    ")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"    "),(0,e._)("span",{style:{color:"#39ADB5"}},"@"),(0,e._)("span",{style:{color:"#9C3EDA"}},"Override")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"    "),(0,e._)("span",{style:{color:"#9C3EDA"}},"public"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#9C3EDA"}},"void"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#6182B8"}},"run"),(0,e._)("span",{style:{color:"#39ADB5"}},"()"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#39ADB5"}},"{")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#39ADB5"}},"        "),(0,e._)("span",{style:{color:"#90A4AE","font-style":"italic"}},"// La ejecución del método run estará normalmente gestionada por un bucle")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#39ADB5"}},"        "),(0,e._)("span",{style:{color:"#90A4AE","font-style":"italic"}},"// que controlará el ciclo de vida del hilo y se adaptará al problema.")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#39ADB5"}},"        "),(0,e._)("span",{style:{color:"#90A4AE","font-style":"italic"}},"// En el caso de simulaciones se harán esperas proporcionales.")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"        "),(0,e._)("span",{style:{color:"#39ADB5","font-style":"italic"}},"try"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#39ADB5"}},"{")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#39ADB5"}},"            "),(0,e._)("span",{style:{color:"#90A4AE","font-style":"italic"}},"// Código que hace el hilo productor")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"            objetoCompartido"),(0,e._)("span",{style:{color:"#39ADB5"}},"."),(0,e._)("span",{style:{color:"#6182B8"}},"accionDeProducir"),(0,e._)("span",{style:{color:"#39ADB5"}},"();")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#39ADB5"}},"            "),(0,e._)("span",{style:{color:"#90A4AE","font-style":"italic"}},"// La espera es opcional")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"            Thread"),(0,e._)("span",{style:{color:"#39ADB5"}},"."),(0,e._)("span",{style:{color:"#6182B8"}},"sleep"),(0,e._)("span",{style:{color:"#39ADB5"}},"(("),(0,e._)("span",{style:{color:"#9C3EDA"}},"long"),(0,e._)("span",{style:{color:"#39ADB5"}},")("),(0,e._)("span",{style:{color:"#90A4AE"}},"Math"),(0,e._)("span",{style:{color:"#39ADB5"}},"."),(0,e._)("span",{style:{color:"#6182B8"}},"random"),(0,e._)("span",{style:{color:"#39ADB5"}},"()*"),(0,e._)("span",{style:{color:"#F76D47"}},"1000"),(0,e._)("span",{style:{color:"#39ADB5"}},"+"),(0,e._)("span",{style:{color:"#F76D47"}},"1000"),(0,e._)("span",{style:{color:"#39ADB5"}},"));")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"        "),(0,e._)("span",{style:{color:"#39ADB5"}},"}"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#39ADB5","font-style":"italic"}},"catch"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#39ADB5"}},"("),(0,e._)("span",{style:{color:"#9C3EDA"}},"InterruptedException"),(0,e._)("span",{style:{color:"#90A4AE"}}," ex"),(0,e._)("span",{style:{color:"#39ADB5"}},")"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#39ADB5"}},"{")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"}),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"        "),(0,e._)("span",{style:{color:"#39ADB5"}},"}"),(0,e._)("span",{style:{color:"#90A4AE"}},"         ")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"    "),(0,e._)("span",{style:{color:"#39ADB5"}},"}")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#39ADB5"}},"}"),(0,e._)("span",{style:{color:"#90A4AE"}}," ")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"})])]),(0,e._)("div",{class:"highlight-lines"},[(0,e._)("br"),(0,e._)("div",{class:"highlight-line"}," "),(0,e._)("br"),(0,e._)("br"),(0,e._)("div",{class:"highlight-line"}," "),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("div",{class:"highlight-line"}," "),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br")]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"11"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"12"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"13"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"14"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"15"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"16"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"17"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"18"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"19"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"20"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"21"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"22"),(0,e._)("br")])],-1),L=(0,e._)("div",{class:"pagebreak"},null,-1),M=(0,e._)("h2",{id:"_3-3-4-clase-compartida-sincronizacion-de-hilos",tabindex:"-1"},"3.3.4 Clase Compartida. Sincronización de hilos",-1),W=(0,e._)("p",null,[(0,e.Uk)("El modelo se completa con la clase compartida. Aquí vamos a crear los métodos a los que acceden productores y consumidores y, además, vamos a realizar la sincronización entre hilos para que no se produzcan "),(0,e._)("code",null,"condiciones de carrera"),(0,e.Uk)(".")],-1),I=(0,e._)("div",{class:"language-java ext-java line-numbers-mode"},[(0,e._)("pre",{class:"shiki",style:{"background-color":"#FAFAFA"}},[(0,e._)("code",null,[(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#9C3EDA"}},"class"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#E2931D"}},"ClaseCompartida"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#39ADB5"}},"{")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"    "),(0,e._)("span",{style:{color:"#9C3EDA"}},"int"),(0,e._)("span",{style:{color:"#90A4AE"}}," valorAccedidoSimultaneamente"),(0,e._)("span",{style:{color:"#39ADB5"}},";")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"    ")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"    "),(0,e._)("span",{style:{color:"#6182B8"}},"ClaseCompartida"),(0,e._)("span",{style:{color:"#39ADB5"}},"()"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#39ADB5"}},"{")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#39ADB5"}},"        "),(0,e._)("span",{style:{color:"#90A4AE","font-style":"italic"}},"// Se inicializa el valor")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"        "),(0,e._)("span",{style:{color:"#39ADB5"}},"this."),(0,e._)("span",{style:{color:"#90A4AE"}},"valorAccedidoSimultaneamente "),(0,e._)("span",{style:{color:"#39ADB5"}},"="),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#F76D47"}},"0"),(0,e._)("span",{style:{color:"#39ADB5"}},";")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"    "),(0,e._)("span",{style:{color:"#39ADB5"}},"}")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"}),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"    "),(0,e._)("span",{style:{color:"#9C3EDA"}},"public"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#9C3EDA"}},"synchronized"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#9C3EDA"}},"void"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#6182B8"}},"accionDeConsumir"),(0,e._)("span",{style:{color:"#39ADB5"}},"()"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#39ADB5"}},"{")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#39ADB5"}},"        "),(0,e._)("span",{style:{color:"#90A4AE","font-style":"italic"}},"// Si no se cumple la condición para poder consumir, el consumidor debe esperar")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"        "),(0,e._)("span",{style:{color:"#39ADB5","font-style":"italic"}},"while"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#39ADB5"}},"("),(0,e._)("span",{style:{color:"#6182B8"}},"valorAccedidoSimultaneamente"),(0,e._)("span",{style:{color:"#39ADB5"}},"()"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#39ADB5"}},"=="),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#F76D47"}},"0"),(0,e._)("span",{style:{color:"#39ADB5"}},")"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#39ADB5"}},"{")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"            "),(0,e._)("span",{style:{color:"#39ADB5","font-style":"italic"}},"try"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#39ADB5"}},"{")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"                System"),(0,e._)("span",{style:{color:"#39ADB5"}},"."),(0,e._)("span",{style:{color:"#90A4AE"}},"out"),(0,e._)("span",{style:{color:"#39ADB5"}},"."),(0,e._)("span",{style:{color:"#6182B8"}},"println"),(0,e._)("span",{style:{color:"#39ADB5"}},"("),(0,e._)("span",{style:{color:"#39ADB5"}},'"'),(0,e._)("span",{style:{color:"#91B859"}},"Consumidor espera..."),(0,e._)("span",{style:{color:"#39ADB5"}},'"'),(0,e._)("span",{style:{color:"#39ADB5"}},");")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"                "),(0,e._)("span",{style:{color:"#6182B8"}},"wait"),(0,e._)("span",{style:{color:"#39ADB5"}},"();")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"            "),(0,e._)("span",{style:{color:"#39ADB5"}},"}"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#39ADB5","font-style":"italic"}},"catch"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#39ADB5"}},"("),(0,e._)("span",{style:{color:"#9C3EDA"}},"InterruptedException"),(0,e._)("span",{style:{color:"#90A4AE"}}," ex"),(0,e._)("span",{style:{color:"#39ADB5"}},")"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#39ADB5"}},"{")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#39ADB5"}},"                "),(0,e._)("span",{style:{color:"#90A4AE","font-style":"italic"}},"// Si es necesario se realizará la gestión de la Interrupción")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"            "),(0,e._)("span",{style:{color:"#39ADB5"}},"}")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"        "),(0,e._)("span",{style:{color:"#39ADB5"}},"}")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"                ")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#39ADB5"}},"        "),(0,e._)("span",{style:{color:"#90A4AE","font-style":"italic"}},"// Cuando se ha cumplido la condición para consumir, el consumidor consume")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"        valorAccedidoSimultaneamente"),(0,e._)("span",{style:{color:"#39ADB5"}},"--;")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"        System"),(0,e._)("span",{style:{color:"#39ADB5"}},"."),(0,e._)("span",{style:{color:"#90A4AE"}},"out"),(0,e._)("span",{style:{color:"#39ADB5"}},"."),(0,e._)("span",{style:{color:"#6182B8"}},"printf"),(0,e._)("span",{style:{color:"#39ADB5"}},"("),(0,e._)("span",{style:{color:"#39ADB5"}},'"'),(0,e._)("span",{style:{color:"#91B859"}},"Se ha consumido: %d."),(0,e._)("span",{style:{color:"#90A4AE"}},"\\n"),(0,e._)("span",{style:{color:"#39ADB5"}},'"'),(0,e._)("span",{style:{color:"#39ADB5"}},","),(0,e._)("span",{style:{color:"#90A4AE"}}," valorAccedidoSimultaneamente"),(0,e._)("span",{style:{color:"#39ADB5"}},");"),(0,e._)("span",{style:{color:"#90A4AE"}},"        ")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"}),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#39ADB5"}},"        "),(0,e._)("span",{style:{color:"#90A4AE","font-style":"italic"}},"// Se activa a otros hilos que puedan estar en espera")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"        "),(0,e._)("span",{style:{color:"#6182B8"}},"notifyAll"),(0,e._)("span",{style:{color:"#39ADB5"}},"();")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"    "),(0,e._)("span",{style:{color:"#39ADB5"}},"}")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"    ")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"    "),(0,e._)("span",{style:{color:"#9C3EDA"}},"public"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#9C3EDA"}},"synchronized"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#9C3EDA"}},"void"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#6182B8"}},"accionDeProducir"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#39ADB5"}},"()"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#39ADB5"}},"{")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#39ADB5"}},"        "),(0,e._)("span",{style:{color:"#90A4AE","font-style":"italic"}},"// Si no se cumple la condición para poder producir, el productor debe esperar")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"        "),(0,e._)("span",{style:{color:"#39ADB5","font-style":"italic"}},"while"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#39ADB5"}},"("),(0,e._)("span",{style:{color:"#6182B8"}},"valorAccedidoSimultaneamente"),(0,e._)("span",{style:{color:"#39ADB5"}},"()"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#39ADB5"}},">"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#F76D47"}},"10"),(0,e._)("span",{style:{color:"#39ADB5"}},")"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#39ADB5"}},"{")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"            "),(0,e._)("span",{style:{color:"#39ADB5","font-style":"italic"}},"try"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#39ADB5"}},"{")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"                System"),(0,e._)("span",{style:{color:"#39ADB5"}},"."),(0,e._)("span",{style:{color:"#90A4AE"}},"out"),(0,e._)("span",{style:{color:"#39ADB5"}},"."),(0,e._)("span",{style:{color:"#6182B8"}},"println"),(0,e._)("span",{style:{color:"#39ADB5"}},"("),(0,e._)("span",{style:{color:"#39ADB5"}},'"'),(0,e._)("span",{style:{color:"#91B859"}},"Productor espera..."),(0,e._)("span",{style:{color:"#39ADB5"}},'"'),(0,e._)("span",{style:{color:"#39ADB5"}},");")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"                "),(0,e._)("span",{style:{color:"#6182B8"}},"wait"),(0,e._)("span",{style:{color:"#39ADB5"}},"();")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"            "),(0,e._)("span",{style:{color:"#39ADB5"}},"}"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#39ADB5","font-style":"italic"}},"catch"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#39ADB5"}},"("),(0,e._)("span",{style:{color:"#9C3EDA"}},"InterruptedException"),(0,e._)("span",{style:{color:"#90A4AE"}}," ex"),(0,e._)("span",{style:{color:"#39ADB5"}},")"),(0,e._)("span",{style:{color:"#90A4AE"}}," "),(0,e._)("span",{style:{color:"#39ADB5"}},"{")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#39ADB5"}},"                "),(0,e._)("span",{style:{color:"#90A4AE","font-style":"italic"}},"// Si es necesario se realizará la gestión de la Interrupción                ")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"            "),(0,e._)("span",{style:{color:"#39ADB5"}},"}")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"        "),(0,e._)("span",{style:{color:"#39ADB5"}},"}")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"        ")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#39ADB5"}},"        "),(0,e._)("span",{style:{color:"#90A4AE","font-style":"italic"}},"// Cuando se ha cumplido la condición para producir, el productor produce")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"        valorAccedidoSimultaneamente"),(0,e._)("span",{style:{color:"#39ADB5"}},"++;")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"        System"),(0,e._)("span",{style:{color:"#39ADB5"}},"."),(0,e._)("span",{style:{color:"#90A4AE"}},"out"),(0,e._)("span",{style:{color:"#39ADB5"}},"."),(0,e._)("span",{style:{color:"#6182B8"}},"printf"),(0,e._)("span",{style:{color:"#39ADB5"}},"("),(0,e._)("span",{style:{color:"#39ADB5"}},'"'),(0,e._)("span",{style:{color:"#91B859"}},"Se ha producido: %d."),(0,e._)("span",{style:{color:"#90A4AE"}},"\\n"),(0,e._)("span",{style:{color:"#39ADB5"}},'"'),(0,e._)("span",{style:{color:"#39ADB5"}},","),(0,e._)("span",{style:{color:"#90A4AE"}}," valorAccedidoSimultaneamente"),(0,e._)("span",{style:{color:"#39ADB5"}},");"),(0,e._)("span",{style:{color:"#90A4AE"}},"        ")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"}),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#39ADB5"}},"        "),(0,e._)("span",{style:{color:"#90A4AE","font-style":"italic"}},"// Se activa a otros hilos que puedan estar en espera")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"        "),(0,e._)("span",{style:{color:"#6182B8"}},"notifyAll"),(0,e._)("span",{style:{color:"#39ADB5"}},"();")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#90A4AE"}},"    "),(0,e._)("span",{style:{color:"#39ADB5"}},"}")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"})])]),(0,e._)("div",{class:"highlight-lines"},[(0,e._)("br"),(0,e._)("div",{class:"highlight-line"}," "),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("div",{class:"highlight-line"}," "),(0,e._)("br"),(0,e._)("div",{class:"highlight-line"}," "),(0,e._)("br"),(0,e._)("br"),(0,e._)("div",{class:"highlight-line"}," "),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("div",{class:"highlight-line"}," "),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("div",{class:"highlight-line"}," "),(0,e._)("br"),(0,e._)("br"),(0,e._)("div",{class:"highlight-line"}," "),(0,e._)("br"),(0,e._)("div",{class:"highlight-line"}," "),(0,e._)("br"),(0,e._)("br"),(0,e._)("div",{class:"highlight-line"}," "),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("div",{class:"highlight-line"}," "),(0,e._)("br"),(0,e._)("br"),(0,e._)("br"),(0,e._)("div",{class:"highlight-line"}," "),(0,e._)("br")]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"11"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"12"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"13"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"14"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"15"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"16"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"17"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"18"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"19"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"20"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"21"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"22"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"23"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"24"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"25"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"26"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"27"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"28"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"29"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"30"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"31"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"32"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"33"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"34"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"35"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"36"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"37"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"38"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"39"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"40"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"41"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"42"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"43"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"44"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"45"),(0,e._)("br")])],-1),T=(0,e._)("p",null,[(0,e.Uk)("Lo interesante del código anterior, como ya hemos visto con anterioridad, es la pareja de métodos "),(0,e._)("code",null,"wait / notifyAll"),(0,e.Uk)(", junto con el modificador "),(0,e._)("code",null,"synchronized"),(0,e.Uk)(".")],-1),O=(0,e._)("ul",null,[(0,e._)("li",null,[(0,e.Uk)("Cuando se llama a un método "),(0,e._)("strong",null,"synchronized"),(0,e.Uk)(" este método se ejecuta sí y solo sí no hay otro hilo ejecutando otro método "),(0,e._)("strong",null,"synchronized"),(0,e.Uk)(),(0,e._)("code",null,"del mismo objeto"),(0,e.Uk)(". Si se diese ese caso, el hilo se quedará en espera hasta que otro hilo ejecute una llamada "),(0,e._)("strong",null,"notifyAll"),(0,e.Uk)(". En ese momento todos los hilos que estén esperando se despiertan y sólo uno de ellos vuelve a ejecutarse.")]),(0,e._)("li",null,[(0,e.Uk)("Cuando se hace una llamada al método "),(0,e._)("strong",null,"wait"),(0,e.Uk)(", un hilo se queda en espera y, además, libera el bloqueo de uso del método "),(0,e._)("strong",null,"synchronized"),(0,e.Uk)(". El hilo se quedará en espera hasta que otro hilo ejecute una llamada "),(0,e._)("strong",null,"notifyAll"),(0,e.Uk)(".")]),(0,e._)("li",null,[(0,e.Uk)("Cuando se hace una llamada al método "),(0,e._)("strong",null,"notifyAll"),(0,e.Uk)(", todos los hilos que están en espera por haber hecho "),(0,e._)("strong",null,"wait"),(0,e.Uk)(" se despiertan y pasan a esperar poder tomar el control del bloqueo del "),(0,e._)("strong",null,"synchronized"),(0,e.Uk)(". A partir de ese momento, de forma aleatoria, uno de ellos o de lo que ya estaban en la cola del bloqueo "),(0,e._)("strong",null,"synchronized"),(0,e.Uk)(" toma el control y empieza/sigue ejecutándose.")])],-1),R=(0,e._)("blockquote",null,[(0,e._)("p",null,[(0,e.Uk)("Con los métodos "),(0,e._)("strong",null,"wait"),(0,e.Uk)(", "),(0,e._)("strong",null,"notifyAll"),(0,e.Uk)(" y los bloques de código "),(0,e._)("strong",null,"synchronized"),(0,e.Uk)(" se consigue evitar que varios hilos puedan modificar a la vez una variable "),(0,e._)("em",null,"(Ver líneas 21 y 40 del ejemplo anterior)"),(0,e.Uk)(".")])],-1),N=(0,e._)("div",{class:"custom-container info"},[(0,e._)("p",{class:"custom-container-title"},"Resumen del modelo Productor-Consumidor"),(0,e._)("p",null,"El modelo Productor-Consumidor original trabaja con un buffer en el que el Productor va depositando información y el Consumidor la va sacando, de forma que el buffer nunca se llene ni se pueda leer si está vacío."),(0,e._)("p",null,"En nuestro ejemplo, lo hemos simplificado al uso de una variable que nunca puede exceder el valor de 10 ni ser inferior a 0."),(0,e._)("p",null,"Como ya hemos dicho, esa variable puede ser cualquier tipo de dato, y el código de las clases variará en función de ello, para adaptarlo al problema y al control del tipo de dato utilizado."),(0,e._)("p",null,"Además, las condiciones o estados que se utilizan para las esperas y las actualizaciones será lo que nosotros, como programadores, tengamos que adaptar al modelo para hacerlo funcionar en situaciones diferentes.")],-1),V={render:function(s,l){const o=(0,e.up)("DownloadPDF-component"),n=(0,e.up)("DocumentCover-component"),V=(0,e.up)("RouterLink"),H=(0,e.up)("OutboundLink");return(0,e.wg)(),(0,e.iD)(e.HY,null,[(0,e.Wm)(o),(0,e.Wm)(n,{titulo:"3.3 Modelo productor-consumidor"}),a,(0,e._)("nav",r,[(0,e._)("ul",null,[(0,e._)("li",null,[(0,e.Wm)(V,{to:"#_3-3-1-esquema-de-sincronizacion-y-comunicacion-de-hilos"},{default:(0,e.w5)((()=>[c])),_:1})]),(0,e._)("li",null,[(0,e.Wm)(V,{to:"#_3-3-2-clase-principal"},{default:(0,e.w5)((()=>[t])),_:1})]),(0,e._)("li",null,[(0,e.Wm)(V,{to:"#_3-3-3-clase-productor-y-consumidor"},{default:(0,e.w5)((()=>[_])),_:1})]),(0,e._)("li",null,[(0,e.Wm)(V,{to:"#_3-3-4-clase-compartida-sincronizacion-de-hilos"},{default:(0,e.w5)((()=>[i])),_:1})])])]),p,A,(0,e._)("p",null,[y,(0,e._)("a",u,[d,(0,e.Wm)(H)]),m]),b,E,D,B,h,k,U,g,C,v,f,q,j,z,P,S,x,w,F,L,M,W,I,T,O,R,N],64)}}},2604:(s,l,o)=>{s.exports=o.p+"assets/img/ProducerConsumer.d96a041f.png"}}]);