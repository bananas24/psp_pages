"use strict";(self.webpackChunkapuntes_psp=self.webpackChunkapuntes_psp||[]).push([[8476],{9005:(s,a,n)=>{n.r(a),n.d(a,{data:()=>l});const l={key:"v-03a9dd55",path:"/es/unit6/symmetric-key.html",title:"6.3 Encriptación simétrica",lang:"es-ES",frontmatter:{title:"6.3 Encriptación simétrica"},excerpt:"",headers:[{level:2,title:"6.3.1. Clave secreta",slug:"_6-3-1-clave-secreta",children:[]},{level:2,title:"6.2.2. Cipher",slug:"_6-2-2-cipher",children:[{level:3,title:"Cuáles son las transformaciones básicas proporcionadas por Java",slug:"cuales-son-las-transformaciones-basicas-proporcionadas-por-java",children:[]}]},{level:2,title:"6.2.2. Clases stream para cifrado y descifrado simétrico",slug:"_6-2-2-clases-stream-para-cifrado-y-descifrado-simetrico",children:[]},{level:2,title:"6.2.3. MessageDigest con GnuPG",slug:"_6-2-3-messagedigest-con-gnupg",children:[]}],filePathRelative:"es/unit6/symmetric-key.md",git:{updatedTime:null,contributors:[]}}},1923:(s,a,n)=>{n.r(a),n.d(a,{default:()=>y});var l=n(6252);const e=(0,l._)("h1",{id:"_6-3-encriptacion-simetrica",tabindex:"-1"},"6.3 Encriptación simétrica",-1),p={class:"table-of-contents"},o=(0,l.Uk)("6.3.1. Clave secreta"),r=(0,l.Uk)("6.2.2. Cipher"),t=(0,l.Uk)("Cuáles son las transformaciones básicas proporcionadas por Java"),c=(0,l.Uk)("6.2.2. Clases stream para cifrado y descifrado simétrico"),A=(0,l.Uk)("6.2.3. MessageDigest con GnuPG"),i=(0,l.uE)('<h2 id="_6-3-1-clave-secreta" tabindex="-1">6.3.1. Clave secreta</h2><p>Un <em>Message digest</em> o resumen de mensaje, más conocidos como <strong>funciones hash</strong>, es una marca digital de un bloque de datos. Existe un gran número de algoritmos diseñados para procesar esto resúmenes, los dos más conocidos son SHA-1 y MD5.</p><p>De un resumen cabe destacar las siguientes características:</p><ul><li>Para el mismo algoritmo, el resumen siempre tiene el mismo tamaño, independientemente del tamaño de los datos que se haya usado para generarlo.</li><li>Es imposible recuperar la información original a partir de un resumen.</li><li>El resumen no debe desvelar nada sobre los datos que se utilizaron para generarlo.</li><li>Es computacionalmente inviable encontrar dos mensajes que tengan el mismo valor de resumen. Matemáticamente es altamente improbable, pero no imposible.</li><li>Un pequeño cambio en los datos resumidos genera un resumen completamente diferente.</li></ul><p>Los resúmenes se usan para generar identificadores únicos y confiables. A veces se les llama <em>checksum</em>, ya que sirven para comprobar si una descarga se ha realizado correctamente, generando su resumen y comparándolo con el que generó el archivo original.</p><div class="custom-container warning"><p class="custom-container-title">Un hash no sirve para cifrar</p><p>Es importante destacar que, debido a que es imposible obtener los datos que generaron un resumen a partir del propio resumen, el resumen no se puede usar para cifrar información.</p><p>Por el contrario, es un mecanismo que se usa para comparar. Su uso más extendido es con las contraseñas, ya que en las bases de datos se guarda un resumen en vez de la contraseña en claro. De esta forma, cuando se recibe una contraseña se genera su resumen y se compara con el valor almacenado.</p></div><h2 id="_6-2-2-cipher" tabindex="-1">6.2.2. Cipher</h2><p>Para cifrar y descifrar un mensaje necesitamos una clave y escoger el tipo de cifrado que queremos. En JCA se procede de la siguiente forma:</p><ol><li>Se crea un objeto de la clase <em>SecretKey</em> a partir de un KeyGenerator obtenido con el método estático <em>getInstance()</em>, especificando el nombre del algoritmo. Opcionalmente, se puede especificar el nombre del proveedor.</li><li>Así obtenemos una clave aleatoria de tipo OTP (One Time Password) ya que cada vez que ejecutemos el programa la clave será diferente.</li><li>Se crea un objeto de tipo Cipher indicando qué algoritmo vamos a usar. Y después, con el método <em>init()</em> se indica qué vamos a hacer (cifrar/descifrar) y con qué clave.</li><li>Se añaden datos con el método <em>update()</em>. Se puede añadir un byte o un array de bytes. Este método se puede invocar varias veces para ir añadiendo nuevos datos.</li><li>Se obtiene el valor cifrado con el método <em>doFinal()</em>.</li><li>Si se quisiera descifrar, sólo hay que volver a invocar al método <em>init()</em> indicando en este caso que queremos descifrar.</li></ol><p>A continuación podemos ver un ejemplo</p><div class="language-java ext-java line-numbers-mode"><pre class="shiki" style="background-color:#FAFAFA;"><code><span class="line"><span style="color:#9C3EDA;">public</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">class</span><span style="color:#90A4AE;"> </span><span style="color:#E2931D;">SecretKeyEncrypt</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">public</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">static</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">void</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">main</span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">String</span><span style="color:#39ADB5;">[]</span><span style="color:#90A4AE;"> args</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>\n<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#9C3EDA;">SecretKey</span><span style="color:#90A4AE;"> claveSecreta </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">null;</span></span>\n<span class="line"><span style="color:#90A4AE;">        </span></span>\n<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;font-style:italic;">try</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">//Generamos clave secreta</span></span>\n<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Podemos crear una nueva clave</span></span>\n<span class="line"><span style="color:#90A4AE;">            claveSecreta </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">getNewKey</span><span style="color:#39ADB5;">();</span></span>\n<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// O bien usar una clave guardada en algún almacén, fichero, etc.</span></span>\n<span class="line"><span style="color:#90A4AE;">            claveSecreta </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">getKeyFromData</span><span style="color:#39ADB5;">();</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#90A4AE;">            System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">out</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">Clave usada: </span><span style="color:#39ADB5;">&quot;</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> claveSecreta</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getFormat</span><span style="color:#39ADB5;">());</span></span>\n<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">//Se define el objeto Cipher (Algoritmo/modo/relleno)</span></span>\n<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#9C3EDA;">Cipher</span><span style="color:#90A4AE;"> c </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> Cipher</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getInstance</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">DESede</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">);</span><span style="color:#90A4AE;"> </span><span style="color:#90A4AE;font-style:italic;">// AES/ECB/PKCS5Padding</span></span>\n<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Configuramos el modo de CIFRADO</span></span>\n<span class="line"><span style="color:#90A4AE;">            c</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">init</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">Cipher</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">ENCRYPT_MODE</span><span style="color:#39ADB5;">,</span><span style="color:#90A4AE;"> claveSecreta</span><span style="color:#39ADB5;">);</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Aquí leemos la información que queremos cifrar</span></span>\n<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Puede ser una cadena o leerla de un archivo</span></span>\n<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#9C3EDA;">byte</span><span style="color:#39ADB5;">[]</span><span style="color:#90A4AE;"> textoPlano </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">Texto que queremos cifrar para la prueba</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getBytes</span><span style="color:#39ADB5;">();</span></span>\n<span class="line"><span style="color:#90A4AE;">            </span></span>\n<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Si queremos ir cifrando poco a poco, vamos haciendo llamadas</span></span>\n<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// al método update</span></span>\n<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// c.update(textoPlano);</span></span>\n<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Se realiza el poceso final de cifrado de la información</span></span>\n<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#9C3EDA;">byte</span><span style="color:#39ADB5;">[]</span><span style="color:#90A4AE;"> textoCifrado </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> c</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">doFinal</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">textoPlano</span><span style="color:#39ADB5;">);</span></span>\n<span class="line"><span style="color:#90A4AE;">            System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">out</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">Texto cifrado con clave secreta (raw):</span><span style="color:#90A4AE;">\\n</span><span style="color:#39ADB5;">&quot;</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">String</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">textoCifrado</span><span style="color:#39ADB5;">));</span></span>\n<span class="line"><span style="color:#90A4AE;">            System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">out</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">Texto cifrado con clave secreta (hex):</span><span style="color:#90A4AE;">\\n</span><span style="color:#39ADB5;">&quot;</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">toHexadecimal</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">textoCifrado</span><span style="color:#39ADB5;">));</span></span>\n<span class="line"><span style="color:#90A4AE;">                        </span></span>\n<span class="line"><span style="color:#90A4AE;">            </span></span>\n<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// El proceso de descifrado es equivalente</span></span>\n<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Cambiamos el modo de ENCRYPT a DECRYPT</span></span>\n<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Usamos la misma clave</span></span>\n<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Pasamos el texto cifrado para obtener el original</span></span>\n<span class="line"><span style="color:#90A4AE;">            c</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">init</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">Cipher</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">DECRYPT_MODE</span><span style="color:#39ADB5;">,</span><span style="color:#90A4AE;"> claveSecreta</span><span style="color:#39ADB5;">);</span></span>\n<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#9C3EDA;">byte</span><span style="color:#39ADB5;">[]</span><span style="color:#90A4AE;"> textoOriginal </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> c</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">doFinal</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">textoCifrado</span><span style="color:#39ADB5;">);</span></span>\n<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">//Leemos blques de bytes del fichero y lo vamos escribiendo ya cifrado en el fichero de salida</span></span>\n<span class="line"><span style="color:#90A4AE;">            System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">out</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">Texto descifrado:</span><span style="color:#90A4AE;">\\n</span><span style="color:#39ADB5;">&quot;</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">String</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">textoOriginal</span><span style="color:#39ADB5;">));</span></span>\n<span class="line"><span style="color:#90A4AE;">            </span></span>\n<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">catch</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">Exception</span><span style="color:#90A4AE;"> e</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>\n<span class="line"><span style="color:#90A4AE;">            e</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">printStackTrace</span><span style="color:#39ADB5;">();</span></span>\n<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span></span>\n<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#39ADB5;">}</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">static</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">SecretKey</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">getNewKey</span><span style="color:#39ADB5;">()</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">throws</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">InvalidKeySpecException</span><span style="color:#39ADB5;">,</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">NoSuchAlgorithmException</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>\n<span class="line"><span style="color:#90A4AE;">    </span></span>\n<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#9C3EDA;">KeyGenerator</span><span style="color:#90A4AE;"> kg </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> KeyGenerator</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getInstance</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">DESede</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">);</span></span>\n<span class="line"><span style="color:#90A4AE;">            kg</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">init</span><span style="color:#39ADB5;">(</span><span style="color:#F76D47;">112</span><span style="color:#39ADB5;">);</span></span>\n<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#9C3EDA;">SecretKey</span><span style="color:#90A4AE;"> clave </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> kg</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">generateKey</span><span style="color:#39ADB5;">();</span></span>\n<span class="line"><span style="color:#90A4AE;">            </span></span>\n<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#39ADB5;font-style:italic;">return</span><span style="color:#90A4AE;"> clave</span><span style="color:#39ADB5;">;</span></span>\n<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#39ADB5;">}</span></span>\n<span class="line"><span style="color:#90A4AE;">    </span></span>\n<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">static</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">SecretKey</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">getKeyFromData</span><span style="color:#39ADB5;">()</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">throws</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">InvalidKeySpecException</span><span style="color:#39ADB5;">,</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">NoSuchAlgorithmException</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>\n<span class="line"><span style="color:#39ADB5;">        </span><span style="color:#90A4AE;font-style:italic;">// La clave se puede obtener desde un fichero o cualquier otra fuente</span></span>\n<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#9C3EDA;">byte</span><span style="color:#90A4AE;"> valorClave</span><span style="color:#39ADB5;">[]</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">12345678123456781234567812345678</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getBytes</span><span style="color:#39ADB5;">();</span></span>\n<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#9C3EDA;">SecretKeySpec</span><span style="color:#90A4AE;"> keySpec </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">SecretKeySpec</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">valorClave</span><span style="color:#39ADB5;">,</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">DESede</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">);</span></span>\n<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#9C3EDA;">SecretKeyFactory</span><span style="color:#90A4AE;"> keyFactory </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> SecretKeyFactory</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getInstance</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">DESede</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">);</span></span>\n<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#9C3EDA;">SecretKey</span><span style="color:#90A4AE;"> clave </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> keyFactory</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">generateSecret</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">keySpec</span><span style="color:#39ADB5;">);</span></span>\n<span class="line"><span style="color:#90A4AE;">        </span></span>\n<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;font-style:italic;">return</span><span style="color:#90A4AE;"> clave</span><span style="color:#39ADB5;">;</span></span>\n<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#39ADB5;">}</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">static</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">String</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">toHexadecimal</span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">byte</span><span style="color:#39ADB5;">[]</span><span style="color:#90A4AE;"> hash</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>\n<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#9C3EDA;">String</span><span style="color:#90A4AE;"> hex </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;&quot;</span><span style="color:#39ADB5;">;</span></span>\n<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;font-style:italic;">for</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">int</span><span style="color:#90A4AE;"> i </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#F76D47;">0</span><span style="color:#39ADB5;">;</span><span style="color:#90A4AE;"> i </span><span style="color:#39ADB5;">&lt;</span><span style="color:#90A4AE;"> hash</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">length</span><span style="color:#39ADB5;">;</span><span style="color:#90A4AE;"> i</span><span style="color:#39ADB5;">++)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>\n<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#9C3EDA;">String</span><span style="color:#90A4AE;"> h </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> Integer</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">toHexString</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">hash</span><span style="color:#39ADB5;">[</span><span style="color:#90A4AE;">i</span><span style="color:#39ADB5;">]</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&amp;</span><span style="color:#90A4AE;"> </span><span style="color:#F76D47;">0xFF</span><span style="color:#39ADB5;">);</span></span>\n<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#39ADB5;font-style:italic;">if</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">h</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">length</span><span style="color:#39ADB5;">()</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">==</span><span style="color:#90A4AE;"> </span><span style="color:#F76D47;">1</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>\n<span class="line"><span style="color:#90A4AE;">                hex </span><span style="color:#39ADB5;">+=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">0</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">;</span></span>\n<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#39ADB5;">}</span></span>\n<span class="line"><span style="color:#90A4AE;">            hex </span><span style="color:#39ADB5;">+=</span><span style="color:#90A4AE;"> h</span><span style="color:#39ADB5;">;</span></span>\n<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span></span>\n<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;font-style:italic;">return</span><span style="color:#90A4AE;"> hex</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">toUpperCase</span><span style="color:#39ADB5;">();</span></span>\n<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#39ADB5;">}</span></span>\n<span class="line"><span style="color:#90A4AE;">    </span></span>\n<span class="line"><span style="color:#39ADB5;">}</span></span>\n<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br></div></div><p>y esta sería la salida proporcionada</p><div class="language-bash ext-sh line-numbers-mode"><pre class="shiki" style="background-color:#FAFAFA;"><code><span class="line"><span style="color:#90A4AE;">Texto cifrado con clave secreta:</span></span>\n<span class="line"><span style="color:#90A4AE;">D0A61CD14B5844AD98B2C7BA795B327ACA0795B658C6F93EC6E1586A246BE71AC180B574207E8C4FFEB959B7D4642FCB</span></span>\n<span class="line"><span style="color:#90A4AE;">Texto descifrado:</span></span>\n<span class="line"><span style="color:#90A4AE;">Texto que queremos cifrar para la prueba</span></span>\n<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>Hay que tener en cuenta que en el ejemplo la clave se está usando primero para cifrar y luego para descifrar. Si esto lo hacemos en programas separados, los programas que quieran comunicarse deberán tener acceso a la clave.</p><p>Lo que se suele hacer es almacenar la clave en un archivo y, cuando se necesita para cifrar o descifrar, se lee con un método similar al método <em>getKeyFromData()</em> del ejemplo anterior.</p><h3 id="cuales-son-las-transformaciones-basicas-proporcionadas-por-java" tabindex="-1">Cuáles son las transformaciones básicas proporcionadas por Java</h3><p>En la siguiente tabla tenemos los algoritmos, modos y tipos de relleno, junto con la longitud de clave empleada, de los algoritmos de cifrado simétrico m&#39;as comunes.</p><table><thead><tr><th>Transformación (algoritmo/modo/relleno)</th><th>Key Size</th></tr></thead><tbody><tr><td>AES/CBC/NoPadding</td><td>128</td></tr><tr><td>AES/CBC/PKCS5Padding</td><td>128</td></tr><tr><td>AES/ECB/NoPadding</td><td>128</td></tr><tr><td>AES/ECB/PKCS5Padding</td><td>128</td></tr><tr><td>DES/CBC/NoPadding</td><td>56</td></tr><tr><td>DES/CBC/PKCS5Padding</td><td>56</td></tr><tr><td>DES/ECB/NoPadding</td><td>56</td></tr><tr><td>DES/ECB/PKCS5Padding</td><td>56</td></tr><tr><td>DESede/CBC/NoPadding</td><td>168</td></tr><tr><td>DESede/CBC/PKCS5Padding</td><td>168</td></tr><tr><td>DESede/ECB/NoPadding</td><td>168</td></tr><tr><td>DESede/ECB/PKCS5Padding</td><td>168</td></tr><tr><td>RSA/ECB/PKCS1Padding</td><td>1024, 2048</td></tr><tr><td>RSA/ECB/OAEPWithSHA-1AndMGF1Padding</td><td>1024, 2048</td></tr><tr><td>RSA/ECB/OAEPWithSHA-256AndMGF1Padding</td><td>1024, 2048</td></tr></tbody></table><h2 id="_6-2-2-clases-stream-para-cifrado-y-descifrado-simetrico" tabindex="-1">6.2.2. Clases stream para cifrado y descifrado simétrico</h2><p>Existen dos clases stream que permiten cifrar y descifrar directamente. Pertenecen al paquete <em>java.crypto</em> pero por lo demás funcionan exactamente igual que las clases Stream del paquete <em>java.io</em>, de las que además son clases descendientes y y tienen constructores que permiten crear streams encriptados sobre un InputStream y un OutputStream.</p><table><thead><tr><th>Clase</th><th>Ejemplo</th></tr></thead><tbody><tr><td>CipherInputStream</td><td>CipherInputStream (InputStream is, Cipher c)</td></tr><tr><td>CipherOutputStream</td><td>CipherOutputStream (OutputStream os, Cipher c)</td></tr></tbody></table><p>Por lo tanto, cuando tenemos que leer o escribir información, podemos añadir un envoltorio más al wrapper que utilizamos habitualmente y esto nos permite que tanto las lecturas como las escrituras se hagan cifradas, usando el algoritmo y la clave definidos para el objeto Cipher.</p><p>El uso más común es para leer o escribir en archivos en los que, de igual forma, cambiando el wrapper nos permite leer o escribir la información de forma cifrada/descifrada.</p><div class="custom-container warning"><p class="custom-container-title">Tamaño de bloque</p><p>Muchos de los algoritmos de cifrado simétrico trabajan con bloques de datos, por lo que no debemos intentar cifrar o descifrar más información de la que permite el tamaño de bloque.</p><p>La clase Cipher tiene un método <strong>getBlockSize()</strong> que nos devuelve el tamaño de bloque que permite el algoritmo configurado en su método <strong>init()</strong>.</p></div><p>Veamos un ejemplo de cómo quedaría el wrapper</p><div class="language-java ext-java line-numbers-mode"><pre class="shiki" style="background-color:#FAFAFA;"><code><span class="line"><span style="color:#9C3EDA;">public</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">class</span><span style="color:#90A4AE;"> </span><span style="color:#E2931D;">StreamCrypto</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">public</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">static</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">void</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">main</span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">String</span><span style="color:#39ADB5;">[]</span><span style="color:#90A4AE;"> args</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">throws</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">NoSuchAlgorithmException</span><span style="color:#39ADB5;">,</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">NoSuchPaddingException</span><span style="color:#39ADB5;">,</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">InvalidKeyException</span><span style="color:#39ADB5;">,</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">IOException</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>\n<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#9C3EDA;">File</span><span style="color:#90A4AE;"> file</span><span style="color:#39ADB5;">;</span></span>\n<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#9C3EDA;">String</span><span style="color:#90A4AE;"> filePath </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">a.txt</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">;</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#90A4AE;">        file </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">File</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">filePath</span><span style="color:#39ADB5;">);</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#39ADB5;">        </span><span style="color:#90A4AE;font-style:italic;">//Se define el objeto Cipher (Algoritmo/modo/relleno)</span></span>\n<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#9C3EDA;">Cipher</span><span style="color:#90A4AE;"> c </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> Cipher</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getInstance</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">AES/ECB/PKCS5Padding</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">);</span><span style="color:#90A4AE;"> </span><span style="color:#90A4AE;font-style:italic;">//DESede</span></span>\n<span class="line"><span style="color:#39ADB5;">        </span><span style="color:#90A4AE;font-style:italic;">// Configuramos el modo de CIFRADO</span></span>\n<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#9C3EDA;">byte</span><span style="color:#39ADB5;">[]</span><span style="color:#90A4AE;"> valorClave </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">12345678123456781234567812345678</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getBytes</span><span style="color:#39ADB5;">();</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#39ADB5;">        </span><span style="color:#90A4AE;font-style:italic;">// CIFRADO DEL STREAM (fichero a.txt)</span></span>\n<span class="line"><span style="color:#90A4AE;">        c</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">init</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">Cipher</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">ENCRYPT_MODE</span><span style="color:#39ADB5;">,</span></span>\n<span class="line"><span style="color:#90A4AE;">                </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">SecretKeySpec</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">valorClave</span><span style="color:#39ADB5;">,</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">AES</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">));</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;font-style:italic;">try</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">OutputStream</span><span style="color:#90A4AE;"> outputStream </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">BufferedOutputStream</span><span style="color:#39ADB5;">(</span></span>\n<span class="line"><span style="color:#90A4AE;">                </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">CipherOutputStream</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">FileOutputStream</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">file</span><span style="color:#39ADB5;">),</span><span style="color:#90A4AE;"> c</span><span style="color:#39ADB5;">)))</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>\n<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#39ADB5;font-style:italic;">for</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">int</span><span style="color:#90A4AE;"> i </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#F76D47;">0</span><span style="color:#39ADB5;">;</span><span style="color:#90A4AE;"> i </span><span style="color:#39ADB5;">&lt;</span><span style="color:#90A4AE;"> </span><span style="color:#F76D47;">10</span><span style="color:#39ADB5;">;</span><span style="color:#90A4AE;"> i</span><span style="color:#39ADB5;">++)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>\n<span class="line"><span style="color:#90A4AE;">                outputStream</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">write</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">String</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">Hello World</span><span style="color:#90A4AE;">\\n</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">).</span><span style="color:#6182B8;">getBytes</span><span style="color:#39ADB5;">());</span></span>\n<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#39ADB5;">}</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#39ADB5;">        </span><span style="color:#90A4AE;font-style:italic;">// DESCIFRADO DEL STREAM (fichero a.txt)</span></span>\n<span class="line"><span style="color:#90A4AE;">        c</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">init</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">Cipher</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">DECRYPT_MODE</span><span style="color:#39ADB5;">,</span></span>\n<span class="line"><span style="color:#90A4AE;">                </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">SecretKeySpec</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">valorClave</span><span style="color:#39ADB5;">,</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">AES</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">));</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;font-style:italic;">try</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">InputStream</span><span style="color:#90A4AE;"> inputStream </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">BufferedInputStream</span><span style="color:#39ADB5;">(</span></span>\n<span class="line"><span style="color:#90A4AE;">                </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">CipherInputStream</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">FileInputStream</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">file</span><span style="color:#39ADB5;">),</span><span style="color:#90A4AE;"> c</span><span style="color:#39ADB5;">)))</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#90A4AE;">            System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">out</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">Contenido del fichero (descifrado):</span><span style="color:#90A4AE;">\\n</span><span style="color:#39ADB5;">&quot;</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">String</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">inputStream</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">readAllBytes</span><span style="color:#39ADB5;">()));</span></span>\n<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#39ADB5;">}</span></span>\n<span class="line"><span style="color:#39ADB5;">}</span></span>\n<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><h2 id="_6-2-3-messagedigest-con-gnupg" tabindex="-1">6.2.3. MessageDigest con GnuPG</h2><p>Con la suite GnuPG también podemos cifrar el contenido de los archivos usando diferentes algoritmos</p><div class="custom-container info"><p class="custom-container-title">Algoritmos disponibles para GnuPG</p><p>Para ver la lista de algoritmos disponibles tenemos que mostrar la ayuda del comando</p><blockquote><p>gpg --help</p></blockquote><p>y en la parte superior observamos la información de los algoritmos disponibles para cada tipo de servicio. En concreto, de resúmenes, en mi versión instalada:</p><p>Cifrado: IDEA, 3DES, CAST5, BLOWFISH, AES, AES192, AES256, TWOFISH, CAMELLIA128, CAMELLIA192, CAMELLIA256</p></div><p>Para cifrar un archivo, ejecutamos el comando de la siguiente forma</p><div class="language-bash ext-sh line-numbers-mode"><pre class="shiki" style="background-color:#FAFAFA;"><code><span class="line"><span style="color:#90A4AE;">gpg --print-md SHA256 filename.ext</span></span>\n<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div>',31),y={render:function(s,a){const n=(0,l.up)("DownloadPDF-component"),y=(0,l.up)("DocumentCover-component"),u=(0,l.up)("RouterLink");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(n),(0,l.Wm)(y,{titulo:"6.3 Encriptación simétrica"}),e,(0,l._)("nav",p,[(0,l._)("ul",null,[(0,l._)("li",null,[(0,l.Wm)(u,{to:"#_6-3-1-clave-secreta"},{default:(0,l.w5)((()=>[o])),_:1})]),(0,l._)("li",null,[(0,l.Wm)(u,{to:"#_6-2-2-cipher"},{default:(0,l.w5)((()=>[r])),_:1}),(0,l._)("ul",null,[(0,l._)("li",null,[(0,l.Wm)(u,{to:"#cuales-son-las-transformaciones-basicas-proporcionadas-por-java"},{default:(0,l.w5)((()=>[t])),_:1})])])]),(0,l._)("li",null,[(0,l.Wm)(u,{to:"#_6-2-2-clases-stream-para-cifrado-y-descifrado-simetrico"},{default:(0,l.w5)((()=>[c])),_:1})]),(0,l._)("li",null,[(0,l.Wm)(u,{to:"#_6-2-3-messagedigest-con-gnupg"},{default:(0,l.w5)((()=>[A])),_:1})])])]),i],64)}}}}]);