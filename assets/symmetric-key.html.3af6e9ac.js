import{_ as c}from"./symmetric-encryption-primitive.e35e72d2.js";import{_ as r,r as o,o as i,c as A,d as a,a as s,w as l,b as e,f as y}from"./app.76d7e669.js";const d={},u=s("h1",{id:"_6-3-encriptacion-simetrica",tabindex:"-1"},"6.3 Encriptaci\xF3n sim\xE9trica",-1),E={class:"table-of-contents"},D=e("6.3.1. Clave secreta"),m=e("6.3.2. Cipher"),B=e("Transformaciones b\xE1sicas en Java"),v=e("6.3.3. Clases stream para cifrado y descifrado sim\xE9trico"),b=e("6.3.4. Cifrado sim\xE9trico con GnuPG"),f=y('<h2 id="_6-3-1-clave-secreta" tabindex="-1">6.3.1. Clave secreta</h2><p>Ahora nos interesa no s\xF3lo verificar la integridad de la informaci\xF3n intercambiada, sino tambi\xE9n mantener su privacidad, es decir, que no sea &quot;comprensible&quot; durante la transmisi\xF3n, intercambio o almacenamiento.</p><p>Tenemos un conjunto de algoritmos denominados de <strong>clave sim\xE9trica</strong> (tambi\xE9n conocidos como de clave secreta) en los que, mediante la aplicaci\xF3n de una clave conocida tanto por el emisos como por el receptor, la informaci\xF3n se <strong>encripta o cifra</strong> de forma que s\xF3lo pueda ser <strong>desencriptada o descifrada</strong> utilizando el mismo algoritmo y la misma clave.</p><div class="custom-container info"><p class="custom-container-title">El c\xF3digo Enigma</p><p>Como ejemplo de sistema sim\xE9trico est\xE1 Enigma. Este fue un sistema empleado por Alemania durante la Segunda Guerra Mundial, en el que las claves se distribu\xEDan a diario en forma de libros de c\xF3digos.</p><p>Cada d\xEDa, un operador de radio, receptor o transmisor, consultaba su copia del libro de c\xF3digos para encontrar la clave del d\xEDa. Todo el tr\xE1fico enviado por ondas de radio durante aquel d\xEDa era cifrado y descifrado usando las claves del d\xEDa.</p><p>Inglaterra us\xF3 m\xE1quinas para descifrar las claves durante aquella guerra y aunque el citado sistema alem\xE1n, Enigma, estaba provisto de un amplio abanico de claves, los ingleses dise\xF1aron m\xE1quinas de c\xF3mputo especializado, los Bombes, para comprobar las claves de modo mec\xE1nico hasta que la clave del d\xEDa era encontrada.</p><p>Esto significaba que algunas veces encontraban la clave del d\xEDa pocas horas despu\xE9s de que \xE9sta fuera puesta en uso, pero tambi\xE9n que otros d\xEDas no pod\xEDan encontrar la clave correcta.</p><p>Los Bombes no fueron m\xE1quinas de c\xF3mputo general, sino las precursoras de los ordenadores (computadoras) actuales.</p></div><p>Entre los algoritmos de cifrado sim\xE9trico m\xE1s utilizados se encuentran</p><ul><li>DES</li><li>3DES o Tiple DES</li><li>RC5</li><li>AES</li><li>Blowfish</li><li>IDEA</li></ul><p><img src="'+c+`" alt="cifrado sim\xE9trico"></p><h2 id="_6-3-2-cipher" tabindex="-1">6.3.2. Cipher</h2><p>Para cifrar y descifrar un mensaje necesitamos una clave y escoger el tipo de cifrado que queremos. En JCA se procede de la siguiente forma:</p><ol><li>Se crea un objeto de la clase <em>SecretKey</em> a partir de un KeyGenerator obtenido con el m\xE9todo est\xE1tico <em>getInstance()</em>, especificando el nombre del algoritmo. Opcionalmente, se puede especificar el nombre del proveedor.</li><li>As\xED podemos utilizar una clave prefijada o incluso una clave aleatoria de tipo OTP (One Time Password) ya que cada vez que ejecutemos el programa la clave ser\xE1 diferente.</li><li>Se crea un objeto de tipo Cipher indicando qu\xE9 algoritmo vamos a usar. Y despu\xE9s, con el m\xE9todo <em>init()</em> se indica qu\xE9 vamos a hacer (cifrar/descifrar) y con qu\xE9 clave.</li><li>Se a\xF1aden datos con el m\xE9todo <em>update()</em>. Se puede a\xF1adir un byte o un array de bytes. Este m\xE9todo se puede invocar varias veces para ir a\xF1adiendo nuevos datos.</li><li>Se obtiene el valor cifrado con el m\xE9todo <em>doFinal()</em>.</li><li>Si se quisiera descifrar, s\xF3lo hay que volver a invocar al m\xE9todo <em>init()</em> indicando en este caso que queremos descifrar.</li></ol><p>A continuaci\xF3n podemos ver un ejemplo</p><div class="language-java ext-java line-numbers-mode"><pre class="shiki" style="background-color:#FAFAFA;"><code><span class="line"><span style="color:#9C3EDA;">public</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">class</span><span style="color:#90A4AE;"> </span><span style="color:#E2931D;">SecretKeyEncrypt</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">public</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">static</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">void</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">main</span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">String</span><span style="color:#39ADB5;">[]</span><span style="color:#90A4AE;"> args</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#9C3EDA;">SecretKey</span><span style="color:#90A4AE;"> claveSecreta </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">null;</span></span>
<span class="line"><span style="color:#90A4AE;">        </span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;font-style:italic;">try</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">//Generamos clave secreta</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Podemos crear una nueva clave</span></span>
<span class="line"><span style="color:#90A4AE;">            claveSecreta </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">getNewKey</span><span style="color:#39ADB5;">();</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// O bien usar una clave guardada en alg\xFAn almac\xE9n, fichero, etc.</span></span>
<span class="line"><span style="color:#90A4AE;">            claveSecreta </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">getKeyFromData</span><span style="color:#39ADB5;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">            System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">out</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">Clave usada: </span><span style="color:#39ADB5;">&quot;</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> claveSecreta</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getFormat</span><span style="color:#39ADB5;">());</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">//Se define el objeto Cipher (Algoritmo/modo/relleno)</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#9C3EDA;">Cipher</span><span style="color:#90A4AE;"> c </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> Cipher</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getInstance</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">DESede</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">);</span><span style="color:#90A4AE;"> </span><span style="color:#90A4AE;font-style:italic;">// AES/ECB/PKCS5Padding</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Configuramos el modo de CIFRADO</span></span>
<span class="line"><span style="color:#90A4AE;">            c</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">init</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">Cipher</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">ENCRYPT_MODE</span><span style="color:#39ADB5;">,</span><span style="color:#90A4AE;"> claveSecreta</span><span style="color:#39ADB5;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Aqu\xED leemos la informaci\xF3n que queremos cifrar</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Puede ser una cadena o leerla de un archivo</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#9C3EDA;">byte</span><span style="color:#39ADB5;">[]</span><span style="color:#90A4AE;"> textoPlano </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">Texto que queremos cifrar para la prueba</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getBytes</span><span style="color:#39ADB5;">();</span></span>
<span class="line"><span style="color:#90A4AE;">            </span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Si queremos ir cifrando poco a poco, vamos haciendo llamadas</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// al m\xE9todo update</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// c.update(textoPlano);</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Se realiza el proceso final de cifrado de la informaci\xF3n</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#9C3EDA;">byte</span><span style="color:#39ADB5;">[]</span><span style="color:#90A4AE;"> textoCifrado </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> c</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">doFinal</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">textoPlano</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">            System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">out</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">Texto cifrado con clave secreta (raw):</span><span style="color:#90A4AE;">\\n</span><span style="color:#39ADB5;">&quot;</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">String</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">textoCifrado</span><span style="color:#39ADB5;">));</span></span>
<span class="line"><span style="color:#90A4AE;">            System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">out</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">Texto cifrado con clave secreta (hex):</span><span style="color:#90A4AE;">\\n</span><span style="color:#39ADB5;">&quot;</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">toHexadecimal</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">textoCifrado</span><span style="color:#39ADB5;">));</span></span>
<span class="line"><span style="color:#90A4AE;">                        </span></span>
<span class="line"><span style="color:#90A4AE;">            </span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// El proceso de descifrado es equivalente</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Cambiamos el modo de ENCRYPT a DECRYPT</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Usamos la misma clave</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Pasamos el texto cifrado para obtener el original</span></span>
<span class="line"><span style="color:#90A4AE;">            c</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">init</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">Cipher</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">DECRYPT_MODE</span><span style="color:#39ADB5;">,</span><span style="color:#90A4AE;"> claveSecreta</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#9C3EDA;">byte</span><span style="color:#39ADB5;">[]</span><span style="color:#90A4AE;"> textoOriginal </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> c</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">doFinal</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">textoCifrado</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">//Leemos bloques de bytes del fichero y lo vamos escribiendo ya cifrado en el fichero de salida</span></span>
<span class="line"><span style="color:#90A4AE;">            System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">out</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">Texto descifrado:</span><span style="color:#90A4AE;">\\n</span><span style="color:#39ADB5;">&quot;</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">String</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">textoOriginal</span><span style="color:#39ADB5;">));</span></span>
<span class="line"><span style="color:#90A4AE;">            </span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">catch</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">Exception</span><span style="color:#90A4AE;"> e</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">            e</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">printStackTrace</span><span style="color:#39ADB5;">();</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#39ADB5;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">static</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">SecretKey</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">getNewKey</span><span style="color:#39ADB5;">()</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">throws</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">InvalidKeySpecException</span><span style="color:#39ADB5;">,</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">NoSuchAlgorithmException</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">    </span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#9C3EDA;">KeyGenerator</span><span style="color:#90A4AE;"> kg </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> KeyGenerator</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getInstance</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">DESede</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">            kg</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">init</span><span style="color:#39ADB5;">(</span><span style="color:#F76D47;">112</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#9C3EDA;">SecretKey</span><span style="color:#90A4AE;"> clave </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> kg</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">generateKey</span><span style="color:#39ADB5;">();</span></span>
<span class="line"><span style="color:#90A4AE;">            </span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#39ADB5;font-style:italic;">return</span><span style="color:#90A4AE;"> clave</span><span style="color:#39ADB5;">;</span></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#39ADB5;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">static</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">SecretKey</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">getNewRandomKey</span><span style="color:#39ADB5;">()</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">throws</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">InvalidKeySpecException</span><span style="color:#39ADB5;">,</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">NoSuchAlgorithmException</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#39ADB5;">        </span><span style="color:#90A4AE;font-style:italic;">// Clave obtenida usando un generador de n\xFAmero aleatorios seguro</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#9C3EDA;">KeyGenerator</span><span style="color:#90A4AE;"> genClaves </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> KeyGenerator</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getInstance</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">DESede</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#39ADB5;">        </span><span style="color:#90A4AE;font-style:italic;">// Utilizamos un algoritmo de generaci\xF3n de aleatorios        </span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#9C3EDA;">SecureRandom</span><span style="color:#90A4AE;"> srand </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> SecureRandom</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getInstance</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">SHA1PRNG</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">        genClaves</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">init</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">srand</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">        </span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#9C3EDA;">SecretKey</span><span style="color:#90A4AE;"> clave </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> genClaves</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">generateKey</span><span style="color:#39ADB5;">();</span></span>
<span class="line"><span style="color:#90A4AE;">        System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">out</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">Formato de clave: </span><span style="color:#39ADB5;">&quot;</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> clave</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getFormat</span><span style="color:#39ADB5;">());</span></span>
<span class="line"><span style="color:#90A4AE;">        </span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#90A4AE;font-style:italic;">/*</span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;">        SecretKeyFactory keySpecFactory = SecretKeyFactory.getInstance(&quot;DESede&quot;);</span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;">        DESedeKeySpec keySpec = (DESedeKeySpec) keySpecFactory.getKeySpec(clave, DESedeKeySpec.class);</span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;">        byte[] valorClave = keySpec.getKey();</span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;">        */</span></span>
<span class="line"><span style="color:#90A4AE;">        </span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;font-style:italic;">return</span><span style="color:#90A4AE;"> clave</span><span style="color:#39ADB5;">;</span></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#39ADB5;">}</span></span>
<span class="line"><span style="color:#90A4AE;">    </span></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">static</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">SecretKey</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">getKeyFromData</span><span style="color:#39ADB5;">()</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">throws</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">InvalidKeySpecException</span><span style="color:#39ADB5;">,</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">NoSuchAlgorithmException</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#39ADB5;">        </span><span style="color:#90A4AE;font-style:italic;">// La clave se puede obtener desde un fichero o cualquier otra fuente</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#9C3EDA;">byte</span><span style="color:#90A4AE;"> valorClave</span><span style="color:#39ADB5;">[]</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">12345678123456781234567812345678</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getBytes</span><span style="color:#39ADB5;">();</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#9C3EDA;">SecretKeySpec</span><span style="color:#90A4AE;"> keySpec </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">SecretKeySpec</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">valorClave</span><span style="color:#39ADB5;">,</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">DESede</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#9C3EDA;">SecretKeyFactory</span><span style="color:#90A4AE;"> keyFactory </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> SecretKeyFactory</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getInstance</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">DESede</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#9C3EDA;">SecretKey</span><span style="color:#90A4AE;"> clave </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> keyFactory</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">generateSecret</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">keySpec</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">        </span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;font-style:italic;">return</span><span style="color:#90A4AE;"> clave</span><span style="color:#39ADB5;">;</span></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#39ADB5;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">static</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">Key</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">getKeyFromData2</span><span style="color:#39ADB5;">()</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">throws</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">InvalidKeySpecException</span><span style="color:#39ADB5;">,</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">NoSuchAlgorithmException</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#39ADB5;">        </span><span style="color:#90A4AE;font-style:italic;">// La clave se puede obtener desde un fichero o cualquier otra fuente</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#9C3EDA;">byte</span><span style="color:#90A4AE;"> valorClave</span><span style="color:#39ADB5;">[]</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">12345678123456781234567812345678</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getBytes</span><span style="color:#39ADB5;">();</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#9C3EDA;">Key</span><span style="color:#90A4AE;"> clave </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">SecretKeySpec</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">valorClave</span><span style="color:#39ADB5;">,</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">AES</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;font-style:italic;">return</span><span style="color:#90A4AE;"> clave</span><span style="color:#39ADB5;">;</span></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#39ADB5;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">static</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">String</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">toHexadecimal</span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">byte</span><span style="color:#39ADB5;">[]</span><span style="color:#90A4AE;"> hash</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#9C3EDA;">String</span><span style="color:#90A4AE;"> hex </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;&quot;</span><span style="color:#39ADB5;">;</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;font-style:italic;">for</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">int</span><span style="color:#90A4AE;"> i </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#F76D47;">0</span><span style="color:#39ADB5;">;</span><span style="color:#90A4AE;"> i </span><span style="color:#39ADB5;">&lt;</span><span style="color:#90A4AE;"> hash</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">length</span><span style="color:#39ADB5;">;</span><span style="color:#90A4AE;"> i</span><span style="color:#39ADB5;">++)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#9C3EDA;">String</span><span style="color:#90A4AE;"> h </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> Integer</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">toHexString</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">hash</span><span style="color:#39ADB5;">[</span><span style="color:#90A4AE;">i</span><span style="color:#39ADB5;">]</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&amp;</span><span style="color:#90A4AE;"> </span><span style="color:#F76D47;">0xFF</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#39ADB5;font-style:italic;">if</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">h</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">length</span><span style="color:#39ADB5;">()</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">==</span><span style="color:#90A4AE;"> </span><span style="color:#F76D47;">1</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">                hex </span><span style="color:#39ADB5;">+=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">0</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">;</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#39ADB5;">}</span></span>
<span class="line"><span style="color:#90A4AE;">            hex </span><span style="color:#39ADB5;">+=</span><span style="color:#90A4AE;"> h</span><span style="color:#39ADB5;">;</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;font-style:italic;">return</span><span style="color:#90A4AE;"> hex</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">toUpperCase</span><span style="color:#39ADB5;">();</span></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#39ADB5;">}</span></span>
<span class="line"><span style="color:#90A4AE;">    </span></span>
<span class="line"><span style="color:#39ADB5;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>y esta ser\xEDa la salida proporcionada</p><div class="language-bash ext-sh line-numbers-mode"><pre class="shiki" style="background-color:#FAFAFA;"><code><span class="line"><span style="color:#90A4AE;">Texto cifrado con clave secreta:</span></span>
<span class="line"><span style="color:#90A4AE;">D0A61CD14B5844AD98B2C7BA795B327ACA0795B658C6F93EC6E1586A246BE71AC180B574207E8C4FFEB959B7D4642FCB</span></span>
<span class="line"><span style="color:#90A4AE;">Texto descifrado:</span></span>
<span class="line"><span style="color:#90A4AE;">Texto que queremos cifrar para la prueba</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Hay que tener en cuenta que en el ejemplo la clave se est\xE1 usando primero para cifrar y luego para descifrar. Si esto lo hacemos en programas separados, los programas que quieran comunicarse deber\xE1n tener acceso a la clave.</p><p>Lo que se suele hacer es almacenar la clave en un archivo y, cuando se necesita para cifrar o descifrar, se lee con un m\xE9todo similar al m\xE9todo <em>getKeyFromData()</em> del ejemplo anterior.</p><h3 id="transformaciones-basicas-en-java" tabindex="-1">Transformaciones b\xE1sicas en Java</h3><p>En la siguiente tabla tenemos los algoritmos, modos y tipos de relleno, junto con la longitud de clave empleada, de los algoritmos de cifrado sim\xE9trico m&#39;as comunes.</p><table><thead><tr><th>Transformaci\xF3n (algoritmo/modo/relleno)</th><th>Key Size</th></tr></thead><tbody><tr><td>AES/CBC/NoPadding</td><td>128</td></tr><tr><td>AES/CBC/PKCS5Padding</td><td>128</td></tr><tr><td>AES/ECB/NoPadding</td><td>128</td></tr><tr><td>AES/ECB/PKCS5Padding</td><td>128</td></tr><tr><td>DES/CBC/NoPadding</td><td>56</td></tr><tr><td>DES/CBC/PKCS5Padding</td><td>56</td></tr><tr><td>DES/ECB/NoPadding</td><td>56</td></tr><tr><td>DES/ECB/PKCS5Padding</td><td>56</td></tr><tr><td>DESede/CBC/NoPadding</td><td>168</td></tr><tr><td>DESede/CBC/PKCS5Padding</td><td>168</td></tr><tr><td>DESede/ECB/NoPadding</td><td>168</td></tr><tr><td>DESede/ECB/PKCS5Padding</td><td>168</td></tr><tr><td>RSA/ECB/PKCS1Padding</td><td>1024, 2048</td></tr><tr><td>RSA/ECB/OAEPWithSHA-1AndMGF1Padding</td><td>1024, 2048</td></tr><tr><td>RSA/ECB/OAEPWithSHA-256AndMGF1Padding</td><td>1024, 2048</td></tr></tbody></table><h2 id="_6-3-3-clases-stream-para-cifrado-y-descifrado-simetrico" tabindex="-1">6.3.3. Clases stream para cifrado y descifrado sim\xE9trico</h2><p>Existen dos clases stream que permiten cifrar y descifrar directamente. Pertenecen al paquete <em>java.crypto</em> pero por lo dem\xE1s funcionan exactamente igual que las clases Stream del paquete <em>java.io</em>, de las que adem\xE1s son clases descendientes y y tienen constructores que permiten crear streams encriptados sobre un InputStream y un OutputStream.</p><table><thead><tr><th>Clase</th><th>Ejemplo</th></tr></thead><tbody><tr><td>CipherInputStream</td><td>CipherInputStream (InputStream is, Cipher c)</td></tr><tr><td>CipherOutputStream</td><td>CipherOutputStream (OutputStream os, Cipher c)</td></tr></tbody></table><p>Por lo tanto, cuando tenemos que leer o escribir informaci\xF3n, podemos a\xF1adir un envoltorio m\xE1s al wrapper que utilizamos habitualmente y esto nos permite que tanto las lecturas como las escrituras se hagan cifradas, usando el algoritmo y la clave definidos para el objeto Cipher.</p><p>El uso m\xE1s com\xFAn es para leer o escribir en archivos en los que, de igual forma, cambiando el wrapper nos permite leer o escribir la informaci\xF3n de forma cifrada/descifrada.</p><div class="custom-container warning"><p class="custom-container-title">Tama\xF1o de bloque</p><p>Muchos de los algoritmos de cifrado sim\xE9trico trabajan con bloques de datos, por lo que no debemos intentar cifrar o descifrar m\xE1s informaci\xF3n de la que permite el tama\xF1o de bloque.</p><p>La clase Cipher tiene un m\xE9todo <strong>getBlockSize()</strong> que nos devuelve el tama\xF1o de bloque que permite el algoritmo configurado en su m\xE9todo <strong>init()</strong>.</p></div><p>Veamos un ejemplo de c\xF3mo quedar\xEDa el wrapper</p><div class="language-java ext-java line-numbers-mode"><pre class="shiki" style="background-color:#FAFAFA;"><code><span class="line"><span style="color:#9C3EDA;">public</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">class</span><span style="color:#90A4AE;"> </span><span style="color:#E2931D;">StreamCrypto</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">public</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">static</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">void</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">main</span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">String</span><span style="color:#39ADB5;">[]</span><span style="color:#90A4AE;"> args</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">throws</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">NoSuchAlgorithmException</span><span style="color:#39ADB5;">,</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">NoSuchPaddingException</span><span style="color:#39ADB5;">,</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">InvalidKeyException</span><span style="color:#39ADB5;">,</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">IOException</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#9C3EDA;">File</span><span style="color:#90A4AE;"> file</span><span style="color:#39ADB5;">;</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#9C3EDA;">String</span><span style="color:#90A4AE;"> filePath </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">a.txt</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">        file </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">File</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">filePath</span><span style="color:#39ADB5;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#39ADB5;">        </span><span style="color:#90A4AE;font-style:italic;">//Se define el objeto Cipher (Algoritmo/modo/relleno)</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#9C3EDA;">Cipher</span><span style="color:#90A4AE;"> c </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> Cipher</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getInstance</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">AES/ECB/PKCS5Padding</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">);</span><span style="color:#90A4AE;"> </span><span style="color:#90A4AE;font-style:italic;">//DESede</span></span>
<span class="line"><span style="color:#39ADB5;">        </span><span style="color:#90A4AE;font-style:italic;">// Configuramos el modo de CIFRADO</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#9C3EDA;">byte</span><span style="color:#39ADB5;">[]</span><span style="color:#90A4AE;"> valorClave </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">12345678123456781234567812345678</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getBytes</span><span style="color:#39ADB5;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#39ADB5;">        </span><span style="color:#90A4AE;font-style:italic;">// CIFRADO DEL STREAM (fichero a.txt)</span></span>
<span class="line"><span style="color:#90A4AE;">        c</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">init</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">Cipher</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">ENCRYPT_MODE</span><span style="color:#39ADB5;">,</span></span>
<span class="line"><span style="color:#90A4AE;">                </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">SecretKeySpec</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">valorClave</span><span style="color:#39ADB5;">,</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">AES</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">));</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;font-style:italic;">try</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">OutputStream</span><span style="color:#90A4AE;"> outputStream </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">BufferedOutputStream</span><span style="color:#39ADB5;">(</span></span>
<span class="line"><span style="color:#90A4AE;">                </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">CipherOutputStream</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">FileOutputStream</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">file</span><span style="color:#39ADB5;">),</span><span style="color:#90A4AE;"> c</span><span style="color:#39ADB5;">)))</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#39ADB5;font-style:italic;">for</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">int</span><span style="color:#90A4AE;"> i </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#F76D47;">0</span><span style="color:#39ADB5;">;</span><span style="color:#90A4AE;"> i </span><span style="color:#39ADB5;">&lt;</span><span style="color:#90A4AE;"> </span><span style="color:#F76D47;">10</span><span style="color:#39ADB5;">;</span><span style="color:#90A4AE;"> i</span><span style="color:#39ADB5;">++)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">                outputStream</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">write</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">String</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">Hello World</span><span style="color:#90A4AE;">\\n</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">).</span><span style="color:#6182B8;">getBytes</span><span style="color:#39ADB5;">());</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#39ADB5;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#39ADB5;">        </span><span style="color:#90A4AE;font-style:italic;">// DESCIFRADO DEL STREAM (fichero a.txt)</span></span>
<span class="line"><span style="color:#90A4AE;">        c</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">init</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">Cipher</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">DECRYPT_MODE</span><span style="color:#39ADB5;">,</span></span>
<span class="line"><span style="color:#90A4AE;">                </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">SecretKeySpec</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">valorClave</span><span style="color:#39ADB5;">,</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">AES</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">));</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;font-style:italic;">try</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">InputStream</span><span style="color:#90A4AE;"> inputStream </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">BufferedInputStream</span><span style="color:#39ADB5;">(</span></span>
<span class="line"><span style="color:#90A4AE;">                </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">CipherInputStream</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">FileInputStream</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">file</span><span style="color:#39ADB5;">),</span><span style="color:#90A4AE;"> c</span><span style="color:#39ADB5;">)))</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">            System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">out</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">Contenido del fichero (descifrado):</span><span style="color:#90A4AE;">\\n</span><span style="color:#39ADB5;">&quot;</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">String</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">inputStream</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">readAllBytes</span><span style="color:#39ADB5;">()));</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#39ADB5;">}</span></span>
<span class="line"><span style="color:#39ADB5;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_6-3-4-cifrado-simetrico-con-gnupg" tabindex="-1">6.3.4. Cifrado sim\xE9trico con GnuPG</h2><p>Con la suite GnuPG tambi\xE9n podemos cifrar el contenido de los archivos usando diferentes algoritmos</p><div class="custom-container info"><p class="custom-container-title">Algoritmos disponibles para GnuPG</p><p>Para ver la lista de algoritmos disponibles tenemos que mostrar la ayuda del comando</p><blockquote><p>gpg --help</p></blockquote><p>y en la parte superior observamos la informaci\xF3n de los algoritmos disponibles para cada tipo de servicio. En concreto, de res\xFAmenes, en mi versi\xF3n instalada:</p><p>Cifrado: IDEA, 3DES, CAST5, BLOWFISH, AES, AES192, AES256, TWOFISH, CAMELLIA128, CAMELLIA192, CAMELLIA256</p></div><p>Para cifrar y descifrar un archivo, ejecutamos los siguientes comandos</p><div class="language-bash ext-sh line-numbers-mode"><pre class="shiki" style="background-color:#FAFAFA;"><code><span class="line"><span style="color:#90A4AE;">gpg --symmetric --cipher-algo 3DES filename.ext</span></span>
<span class="line"><span style="color:#90A4AE;">gpg --decrypt filename.ext.gpg</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>Vemos que para el cifrado nos solicita una clave y que con el par\xE1metro <em>--cipher-algo</em> indicamos qu\xE9 algoritmo de encriptaci\xF3n queremos utilizar.</p><p>El cifrado genera un archivo filename.ext.gpg.</p><p>Para el descifrado, no hace falta indicar el algoritmo, aunque se puede volver a usar el par\xE1metro <em>--cipher-algo</em> y la clave se queda en una cache de GnuPG durante un tiempo, por lo que no siempre la solicita.</p>`,35);function C(g,S){const p=o("DownloadPDF-component"),t=o("DocumentCover-component"),n=o("router-link");return i(),A("div",null,[a(p),a(t,{titulo:"6.3 Encriptaci\xF3n sim\xE9trica"}),u,s("nav",E,[s("ul",null,[s("li",null,[a(n,{to:"#_6-3-1-clave-secreta"},{default:l(()=>[D]),_:1})]),s("li",null,[a(n,{to:"#_6-3-2-cipher"},{default:l(()=>[m]),_:1}),s("ul",null,[s("li",null,[a(n,{to:"#transformaciones-basicas-en-java"},{default:l(()=>[B]),_:1})])])]),s("li",null,[a(n,{to:"#_6-3-3-clases-stream-para-cifrado-y-descifrado-simetrico"},{default:l(()=>[v]),_:1})]),s("li",null,[a(n,{to:"#_6-3-4-cifrado-simetrico-con-gnupg"},{default:l(()=>[b]),_:1})])])]),f])}const x=r(d,[["render",C],["__file","symmetric-key.html.vue"]]);export{x as default};
