import{_ as t,a as A,b as d}from"./digital-signature-sign-verify.3b3014a7.js";import{_ as y,r as p,o as u,c as v,d as n,a as s,w as e,b as a,f as c}from"./app.e2f96938.js";const m={},E=s("h1",{id:"_6-4-encriptacion-asimetrica",tabindex:"-1"},"6.4 Encriptaci\xF3n asim\xE9trica",-1),B={class:"table-of-contents"},D=a("6.4.1. Clave p\xFAblica y clave privada"),b=a("6.4.2. Firma digital"),f=a("Integridad"),g=a("Autenticaci\xF3n y no repudio"),h=a("6.4.3 Certificados digitales"),C=a("Claves digitales"),q=a("Infraestructura de clave p\xFAblica (PKI)"),S=a("6.4.4. Generaci\xF3n de pares de claves"),P=a("Tipos de ficheros para certificados digitales"),_=a("Generaci\xF3n de claves desde Java"),x=a("6.4.5. Cifrado y descifrado usando un par de claves"),K=a("6.2.3. Cifrado asim\xE9trico con GnuPG"),F=c('<h2 id="_6-4-1-clave-publica-y-clave-privada" tabindex="-1">6.4.1. Clave p\xFAblica y clave privada</h2><p>La criptograf\xEDa asim\xE9trica o <strong>criptograf\xEDa de clave p\xFAblica</strong> supuso una aut\xE9ntica revoluci\xF3n en su momento. Permit\xEDa el intercambio seguro de informaci\xF3n (confidencialidad, autenticaci\xF3n y no repudio) entre interlocutores que no compart\xEDan ning\xFAn secreto.</p><p>Se cre\xF3 en los a\xF1os 70 a partir del trabajo de <em>Diffie y Hellman</em> por una parte y de <em>Rivest, Shamir y Adleman</em> por otra.</p><p>Se basa en la existencia de un par de claves, una p\xFAblica y otra privada, entre las cuales existe una relaci\xF3n matem\xE1tica, de manera que es muy dif\xEDcil obtener la clave privada a partir de la p\xFAblica. Sin embargo, es muy sencillo obtener la clave p\xFAblica a partir de la privada.</p><div class="custom-container info"><p class="custom-container-title">Algoritmo RSA</p><p>En la familia de algoritmos RSA (Rivest, Shamir y Adleman) la clave p\xFAblica consiste en un n\xFAmero que es el producto de dos factores primos muy grandes (mayores que 10^100) y la clave privada se deriva de la factorizaci\xF3n de dicho n\xFAmero, es decir, los dos factores primos.</p><p>Requiere poco procesamiento multiplicar dos n\xFAmeros primos tan grandes, pero requiere una cantidad enorme de c\xE1lculos encontrar la factorizaci\xF3n del n\xFAmero.</p></div><p>A diferencia del cifrado sim\xE9trico, el el cifrado asim\xE9trico se usan funciones diferentes para cifrar y descifrar los mensajes.</p><ul><li>Para <strong>encriptaci\xF3n</strong> se usa la <strong>clave p\xFAblica</strong>. Cualquiera puede tener acceso a la clave p\xFAblica, mediante la cual, usando la funci\xF3n de cifrado, se encripta la informaci\xF3n dirigida a un destinatario concreto (el propietario de la clave privada asociada).</li><li>Para <strong>desencriptaci\xF3n</strong> se usa la <strong>clave privada</strong>, que debe mantenerse a buen recaudo ya que s\xF3lo con esa clave y la funci\xF3n de descifrado se puede desencriptar un mensaje cifrado con la clave p\xFAblica correspondiente.</li></ul><p>Entre los algoritmos de cifrado asim\xE9trico m\xE1s utilizados se encuentran</p><ul><li>Rivest Shamir Adleman (RSA). Basado en la factorizaci\xF3n de n\xFAmeros primos grandes.</li><li>Digital Signature Standard (DSS), que incorpora Digital Signature Algorithm (DSA).</li><li>Elliptical Curve Cryptography (ECC). Est\xE1 basado en las matem\xE1ticas de las curvas el\xEDpticas</li><li>the Diffie-Hellman exchange method.</li><li>TLS/SSL protocol.</li></ul><p><img src="'+t+'" alt="cifrado asim\xE9trico"></p><h2 id="_6-4-2-firma-digital" tabindex="-1">6.4.2. Firma digital</h2><p>Con la firma digital Para cifrar y descifrar un mensaje necesitamos una clave y escoger el tipo de cifrado que queremos. En JCA se procede de la siguiente forma:</p><p><img src="'+A+'" alt="cifrado asim\xE9trico"></p><p>El proceso b\xE1sico que se sigue para la firma electr\xF3nica es el siguiente:</p><ol><li>El usuario dispone de un documento electr\xF3nico (una hoja de c\xE1lculo, un pdf, una imagen, incluso un formulario en una p\xE1gina web) y de un <strong>certificado</strong> (clave p\xFAblica y clave privada) que le pertenece y le identifica.</li><li>La aplicaci\xF3n o dispositivo digital utilizados para la firma realiza un <strong>resumen del documento</strong>. El resumen de un documento de gran tama\xF1o puede llegar a ser tan solo de unas l\xEDneas. Este resumen es \xFAnico y cualquier modificaci\xF3n del documento implica tambi\xE9n una modificaci\xF3n del resumen.</li><li>La aplicaci\xF3n utiliza la clave privada para codificar el resumen.</li><li>La aplicaci\xF3n crea otro documento electr\xF3nico que contiene ese resumen codificado. Este nuevo documento es la firma electr\xF3nica.</li></ol><p>El resultado de todo este proceso es un documento electr\xF3nico obtenido a partir del documento original y de las claves del firmante. La firma electr\xF3nica, por tanto, es el mismo documento electr\xF3nico resultante.</p><p><img src="'+d+'" alt="verificaci\xF3n de firma digital"></p><h3 id="integridad" tabindex="-1">Integridad</h3><p>Como estamos comparando funciones de resumen de un documento, se puede detectar de forma muy sencilla si el documento ha sufrido alguna modificaci\xF3n respecto al momento en el que se firm\xF3, garantizando de esta forma la integridad de la informaci\xF3n firmada.</p><h3 id="autenticacion-y-no-repudio" tabindex="-1">Autenticaci\xF3n y no repudio</h3><p>Por las caracter\xEDsticas de los algoritmos de cifrado se puede determinar, a partir del resumen cifrado con la clave privada, mediante el uso de la clave p\xFAblica, que el mensaje recibido lo gener\xF3 el propietario de la clave privada.</p><p>Con esta caracter\xEDstica se puede probar y demostrar que el mensaje lo firm\xF3 el emisor y no cualquier otra persona, garantizando por un lado la autor\xEDa y por otro evitando que el emisor niegue haber generado esa informaci\xF3n.</p><h2 id="_6-4-3-certificados-digitales" tabindex="-1">6.4.3 Certificados digitales</h2><p>Un certificado digital es un documento electr\xF3nico expedido por una <strong>Autoridad de Certificaci\xF3n</strong> e identifica a una persona (f\xEDsica o jur\xEDdica) con un par de claves.Tiene como misi\xF3n validar y certificar que una firma electr\xF3nica se corresponde con una persona o entidad concreta.</p><p>Contiene la informaci\xF3n necesaria para firmar electr\xF3nicamente e identificar a su propietario con sus datos: nombre, NIF, algoritmo y claves de firma, fecha de expiraci\xF3n y organismo que lo expide.</p><p>La Autoridad de Certificaci\xF3n da fe de que la firma electr\xF3nica se corresponde con un usuario concreto. Esa es la raz\xF3n por la que los certificados est\xE1n firmados, a su vez, por la Autoridad de Certificaci\xF3n.</p><h3 id="claves-digitales" tabindex="-1">Claves digitales</h3><p>En un certificado, las claves digitales son los elementos esenciales para la firma e identificaci\xF3n del firmante. Existen dos claves, la <strong>clave privada</strong> y <strong>clave p\xFAblica</strong>, y trabajan de forma complementaria. <em>Lo que cifra o codifica una clave s\xF3lo lo puede descifrar o decodificar la otra</em>.</p><p>La diferencia entre ellas es que la clave privada est\xE1 pensada para que nunca salga del certificado y est\xE9 siempre bajo el control del firmante. En cambio, la clave p\xFAblica se puede repartir o enviar a otros usuarios.</p><p>En ocasiones, se habla de Certificado Privado para referirse al certificado que contiene la clave privada y la p\xFAblica y del Certificado P\xFAblico para referirse al certificado que s\xF3lo contiene la clave p\xFAblica.</p><div class="custom-container info"><p class="custom-container-title">Creaci\xF3n de Certificados digitales</p><p>Obtener el Certificado Digital depende de si el certificado est\xE1 contenido en una tarjeta, como el DNIe, o de si el certificado se guarda en un fichero software.</p><p>En ambos procesos hay un paso que es la identificaci\xF3n del responsable o usuario del certificado, lo cual requiere que \xE9ste <strong>se persone en las oficinas de una Autoridad de Registro</strong>. Estas oficinas corroboran la identidad.</p></div><h3 id="infraestructura-de-clave-publica-pki" tabindex="-1">Infraestructura de clave p\xFAblica (PKI)</h3><p>Una infraestructura de clave p\xFAblica (PKI) es una combinaci\xF3n de hardware, software, procedimientos de seguridad y marco legal que, en su conjunto, permite la ejecuci\xF3n con garant\xEDas de operaciones criptogr\xE1ficas, cumpliendo los requisitos de integridad, confidencialidad, autenticaci\xF3n y no repudio.</p><p>Una PKI permite establecer y gestionar asociaciones entre claves p\xFAblicas e identidades de personas y organizaciones.</p><p>La cuesti\xF3n entonces es determinar si un certificado es v\xE1lido o de confianza, ol o que es lo mismo, si representa a la persona u organizaci\xF3n que aparece como titular y propietario del certificado.</p><p>Para dar por v\xE1lido un certificado digital su firma digital debe ser v\xE1lida y su emisor debe ser un emisor de confianza. Por lo tanto, ahora queda determinar qu\xE9 emisores son de confianza.</p><div class="custom-container warning"><p class="custom-container-title">Autenticidad de los certificados</p><p>Los certificados deben estar firmados por una AC por dos motivos</p><ol><li>Garantizar su integridad, de forma que cualquier intento de modificaci\xF3n del certificado lo invalide.</li><li>Identificar al creador del certificado digital. Todo el sistema est\xE1 basado en una relaci\xF3n de confianza, en la que la AC que ha firmado el certificado es un emisor de confianza, normalmente instituciones p\xFAblicas o privadas de reconocido prestigio</li></ol></div><p>En nuestro sistema podemos ver y modificar qu\xE9 entidades de certificaci\xF3n consideramos como seguras, es decir, que los certificados que \xE9stas hayan firmado los tomaremos como v\xE1lidos.</p>',38),z={href:"https://docs.microsoft.com/es-es/exchange/trusted-root-certification-authorities-for-federation-trusts-exchange-2013-help",target:"_blank",rel:"noopener noreferrer"},w=a("Autoridades de confianza para apps de Azure"),j=s("p",null,[a("En Windows, si ejecutamos "),s("code",null,"certmgr.msc"),a(" podemos acceder a la configuraci\xF3n de certificados del sistema. En OSX lo podemos hacer con la aplicaci\xF3n "),s("code",null,"Llavero"),a(".")],-1),k=s("p",null,"Para nuestra navegaci\xF3n, la informaci\xF3n de qu\xE9 certificados considera el navegador como seguros, depende de en qu\xE9 AC confiemos (por defecto en la instalaci\xF3n vienen configurados los m\xE1s comunes)",-1),I={href:"https://www.adminfacil.es/como-ver-los-certificados-instalados-en-google-chrome/",target:"_blank",rel:"noopener noreferrer"},M=a("Ver certificados y AC en Chrome"),Q=c(`<div class="custom-container danger"><p class="custom-container-title">Certificados autofirmados</p><p><strong>Hemos de tener en cuenta que, con herramientas como las que proporciona Java, SSH o GnuPG cualquiera puede generar un certificado digital con la informaci\xF3n que quiera</strong></p><p>Para las pruebas vamos a firmar nuestros propios certificados. Incluso dentro de una compa\xF1\xEDa podemos ejercer nosotros mismos como Autoridad de Certificaci\xF3n de Confianza, firmando nuestros certificados.</p><p>Debemos preparar la configuraci\xF3n de nuestros sistemas para que <strong>conf\xEDen</strong> en esos certificados autofirmados, asumiendo el riesgo que esto conlleva.</p></div><h2 id="_6-4-4-generacion-de-pares-de-claves" tabindex="-1">6.4.4. Generaci\xF3n de pares de claves</h2><p>La generaci\xF3n y gesti\xF3n de pares de claves implica dos aspectos fundamentales.</p><p>Por un lado, tenemos la creaci\xF3n de las claves. Las claves las podemos haber descargado, generado con alguna de las utilidades disponibles para ellos o bien, como veremos a continuaci\xF3n, se pueden generar desde una aplicaci\xF3n, igual que hacemos con las claves sim\xE9tricas.</p><p>Por otro lado, tenemos la gesti\xF3n del almacenamiento de las claves. Las claves no dejan de ser archivos, que podemos tratar como archivos especiales, pero que usualmente se almacenan en repositorios especiales, denominados <code>keyrings</code> a los que puede acceder una aplicaci\xF3n y desde los que gestionamos las relaciones de confianza.</p><p>El JCA nos proporciona clases generadoras de claves. Estas clases se apoyan en buenos algoritmos de generaci\xF3n de n\xFAmeros aleatorios para satisfacer unos requisitos m\xEDnimos de seguridad.</p><div class="custom-container info"><p class="custom-container-title">SecureRandom</p><p>La generaci\xF3n de n\xFAmeros aleatorios juega un papel fundamental en la criptograf\xEDa, siendo uno de los <strong>Engine</strong> que proporciona el JCA junto con un amplio grupo de algoritmos.</p><p>La clase <strong>SecureRandom</strong> genera n\xFAmero aleatorios empleando alguno de los algoritmos disponibles y se puede utilizar un objeto de tipo SecureRandom para que los utilicen las clases generadoras de claves, tanto sim\xE9tricas como asim\xE9tricas</p></div><h3 id="tipos-de-ficheros-para-certificados-digitales" tabindex="-1">Tipos de ficheros para certificados digitales</h3><p>Hay varios tipos de ficheros que se utilizan para guardar certificados digitales siguiendo el est\xE1ndar X.509. Generalmente uncertificado no contiene s\xF3lo la clave, sino que tiene informaci\xF3n adicional.</p><p>Esxiten dos posibles codificaciones para almacenar certificados X.509</p><ul><li>der: Es una codificaci\xF3n binaria</li><li>dem: Es una codificaci\xF3n en formato texto guardado en Base64 y tienen un encabezado y pie que delimita el contenido del certificado</li></ul><p>Veamos un ejemplo de certificado con codificaci\xF3n dem</p><div class="language-bash ext-sh line-numbers-mode"><pre class="shiki" style="background-color:#FAFAFA;"><code><span class="line"><span style="color:#90A4AE;">-----BEGIN CERTIFICATE----- </span></span>
<span class="line"><span style="color:#90A4AE;">MIIDijCCAvOgAwIBAgIJAKRvtQxONVZoMA0GCSqGSIb3DQEBBAUAMIGLMQswCQYD </span></span>
<span class="line"><span style="color:#90A4AE;">VQQGEwJVUzETMBEGA1UECBMKQ2FsaWZvcm5pYTESMBAGA1UEBxMJU3Vubnl2YWxl </span></span>
<span class="line"><span style="color:#90A4AE;">MSAwHgYDVQQKExdBcnViYSBXaXJlbGVzcyBOZXR3b3JrczEMMAoGA1UECxMDVEFD </span></span>
<span class="line"><span style="color:#90A4AE;">MSMwIQYDVQQDExpteXNlcnZlci5hcnViYW5ldHdvcmtzLmNvbTAeFw0wODA0MzAy </span></span>
<span class="line"><span style="color:#90A4AE;">MzM3MDJaFw0xMDA0MzAyMzM3MDJaMIGLMQswCQYDVQQGEwJVUzETMBEGA1UECBMK </span></span>
<span class="line"><span style="color:#90A4AE;">Q2FsaWZvcm5pYTESMBAGA1UEBxMJU3Vubnl2YWxlMSAwHgYDVQQKExdBcnViYSBX </span></span>
<span class="line"><span style="color:#90A4AE;">aXJlbGVzcyBOZXR3b3JrczEMMAoGA1UECxMDVEFDMSMwIQYDVQQDExpteXNlcnZl </span></span>
<span class="line"><span style="color:#90A4AE;">ci5hcnViYW5ldHdvcmtzLmNvbTCBnzANBgkqhkiG9w0BAQEFAAOBjQAwgYkCgYEA </span></span>
<span class="line"><span style="color:#90A4AE;">zRwqc9prVXycGhHcsAjGPzC2MKU4DhXSr86Z89Jk8/cXEJBJ0C/NgdAqqDgxneUh </span></span>
<span class="line"><span style="color:#90A4AE;">nVyxGxODa7BNGAWSagdCsKLrbkchr479E3xLfgdc3UzAJITLGCXGiQ66NwQDyM5I </span></span>
<span class="line"><span style="color:#90A4AE;">G/xKYm4oqgyOE/lFTTkK0M8V0NmmJynyOCYC/AwQKjMCAwEAAaOB8zCB8DAdBgNV </span></span>
<span class="line"><span style="color:#90A4AE;">HQ4EFgQUM5btT6IlPGkLTTPvFccTVURO1p0wgcAGA1UdIwSBuDCBtYAUM5btT6Il </span></span>
<span class="line"><span style="color:#90A4AE;">PGkLTTPvFccTVURO1p2hgZGkgY4wgYsxCzAJBgNVBAYTAlVTMRMwEQYDVQQIEwpD </span></span>
<span class="line"><span style="color:#90A4AE;">YWxpZm9ybmlhMRIwEAYDVQQHEwlTdW5ueXZhbGUxIDAeBgNVBAoTF0FydWJhIFdp </span></span>
<span class="line"><span style="color:#90A4AE;">cmVsZXNzIE5ldHdvcmtzMQwwCgYDVQQLEwNUQUMxIzAhBgNVBAMTGm15c2VydmVy </span></span>
<span class="line"><span style="color:#90A4AE;">LmFydWJhbmV0d29ya3MuY29tggkApG+1DE41VmgwDAYDVR0TBAUwAwEB/zANBgkq </span></span>
<span class="line"><span style="color:#90A4AE;">hkiG9w0BAQQFAAOBgQBp71WeF6dKvqUSO1JFsVhBeUesbEgx9+tx6eP328uL0oSC </span></span>
<span class="line"><span style="color:#90A4AE;">fQ6EaiXZVbrQt+PMqG0F80+4wxVXug9EW5Ob9M/opaCGI+cgtpLCwSf6CjsmAcUc </span></span>
<span class="line"><span style="color:#90A4AE;">b6EjG/l4HW2BztYJfx15pk51M49TYS7okDKWYRT10y65xcyQdfUKvfDC1k5P9Q== </span></span>
<span class="line"><span style="color:#90A4AE;">-----END CERTIFICATE-----</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Adem\xE1s de la codificaci\xF3n, tenemos formatos de fichero est\xE1ndar para guardar los certificados usando una de las codificaciones anteriores</p>`,14),G=s("li",null,[a("cer, crt, der: Contienen certificados X.509 est\xE1ndares codificados como "),s("code",null,"der")],-1),L=a("p12: Realmente hace referencia a toda una familia de est\xE1ndares asociados al algoritmo RSA y definen el formato de almacenamiento de distintos tipos de claves, los PKCS#n (PKCS#8, PKCS#12, etc). Pueden contener, adem\xE1s de los datos del certificado, una clave privada. Si contiene la clave privada, \xE9sta estar\xE1 protegida por una contrase\xF1a que ser\xE1 necesaria para acceder a la clave privada. "),T={href:"https://es.wikipedia.org/wiki/PKCS",target:"_blank",rel:"noopener noreferrer"},V=a("PKCS en Wikipedia"),U=c(`<h3 id="generacion-de-claves-desde-java" tabindex="-1">Generaci\xF3n de claves desde Java</h3><p>Usando las clases del JCA, estos son los pasos que debemos seguir para generar un par de claves desde c\xF3digo</p><ol><li>El primer paso para obtener un par de claves es obtener un objeto <em>keyPairGenerator</em> para el algoritmo que queramos utilizar.</li><li>A continuaci\xF3n se inicializa el generador del par de claves llamando a alguna de las versiones del m\xE9todo <em>initialize</em>. En nuestro caso indicaremos el tama\xF1o de clave para el algoritmo seleccionado y un generador de n\xFAmeros aleatorios.</li><li>El \xFAltimo paso es generar el par de claves y guardarlas en los objetos PrivateKey y PublicKey respectivamente.</li><li>A partir de ese momento ya se pueden usar las claves para cifrar, descifrar e incluso para firmar. Sin embargo, si queremos reutilizar estas claves, lo que tendremos que hacer ser\xE1 guardarlas en sendos archivos.</li></ol><p>A continuaci\xF3n podemos ver un ejemplo de generaci\xF3n de claves, almacenamiento de las claves en un fichero y visualizaci\xF3n de la clave obtenida.</p><div class="language-java ext-java line-numbers-mode"><pre class="shiki" style="background-color:#FAFAFA;"><code><span class="line"><span style="color:#9C3EDA;">public</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">class</span><span style="color:#90A4AE;"> </span><span style="color:#E2931D;">U6S5_GenerateRsaKeyPair</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">private</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">static</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">final</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">int</span><span style="color:#90A4AE;"> tamanoClaveAsimetrica </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#F76D47;">1024</span><span style="color:#39ADB5;">;</span></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">private</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">static</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">final</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">String</span><span style="color:#90A4AE;"> algoritmoClaveAsimetrica </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">RSA</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">;</span></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">private</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">static</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">final</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">String</span><span style="color:#90A4AE;"> ficheroClavePublica </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">claves/clavepublica.der</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">;</span></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">private</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">static</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">final</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">String</span><span style="color:#90A4AE;"> ficheroClavePrivada </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">claves/claveprivada.pkcs8</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">public</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">static</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">void</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">main</span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">String</span><span style="color:#39ADB5;">[]</span><span style="color:#90A4AE;"> args</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;font-style:italic;">try</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Elijo un algoritmo de generaci\xF3n de n\xFAmeros aleatorios de los denominados</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// altamente seguros para generar el par de claves</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#9C3EDA;">SecureRandom</span><span style="color:#90A4AE;"> algoritmoSeguro </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> SecureRandom</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getInstanceStrong</span><span style="color:#39ADB5;">();</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Preparo el generados de claves para usar el algortimo RSA</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#9C3EDA;">KeyPairGenerator</span><span style="color:#90A4AE;"> genParClaves </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> KeyPairGenerator</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getInstance</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">algoritmoClaveAsimetrica</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">            genParClaves</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">initialize</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">tamanoClaveAsimetrica</span><span style="color:#39ADB5;">,</span><span style="color:#90A4AE;"> algoritmoSeguro</span><span style="color:#39ADB5;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Creo el par de claves y lo guardo en objetos</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#9C3EDA;">KeyPair</span><span style="color:#90A4AE;"> parClaves </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> genParClaves</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">generateKeyPair</span><span style="color:#39ADB5;">();</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#9C3EDA;">PublicKey</span><span style="color:#90A4AE;"> clavePublica </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> parClaves</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getPublic</span><span style="color:#39ADB5;">();</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#9C3EDA;">PrivateKey</span><span style="color:#90A4AE;"> clavePrivada </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> parClaves</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getPrivate</span><span style="color:#39ADB5;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Guardamos la clave p\xFAblica en un archivo y la visualizamos</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// La clave se guarda con codificaci\xF3n DER y en formato X.509</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#6182B8;">guardaClavePublicaX509</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">clavePublica</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">            </span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Guardamos la clave privada en un archivo y la visualizamos</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// La clave se guarda con codificaci\xF3n DER y en formato PKCS#8</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#6182B8;">guardaClavePrivadaPKCS8</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">clavePrivada</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">            </span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">catch</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">NoSuchAlgorithmException</span><span style="color:#90A4AE;"> ex</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">            System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">err</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">No se ha encontrado la implementaci\xF3n del algortimo en ning\xFAn Provider</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#39ADB5;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">private</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">static</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">void</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">guardaClavePublicaX509</span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">PublicKey</span><span style="color:#90A4AE;"> clavePublica</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;font-style:italic;">try</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">FileOutputStream</span><span style="color:#90A4AE;"> publicKeyFile </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">FileOutputStream</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">ficheroClavePublica</span><span style="color:#39ADB5;">))</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#9C3EDA;">X509EncodedKeySpec</span><span style="color:#90A4AE;"> codificacionClavePublica </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">X509EncodedKeySpec</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">clavePublica</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getEncoded</span><span style="color:#39ADB5;">(),</span><span style="color:#90A4AE;"> algoritmoClaveAsimetrica</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">            publicKeyFile</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">write</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">clavePublica</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getEncoded</span><span style="color:#39ADB5;">());</span></span>
<span class="line"><span style="color:#90A4AE;">            </span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Visualizamos la clave por consola</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#6182B8;">MostrarClaveBase64</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">codificacionClavePublica</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getEncoded</span><span style="color:#39ADB5;">(),</span></span>
<span class="line"><span style="color:#90A4AE;">                    codificacionClavePublica</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getFormat</span><span style="color:#39ADB5;">(),</span><span style="color:#90A4AE;"> ficheroClavePublica</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">catch</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">IOException</span><span style="color:#90A4AE;"> ex</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">            System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">out</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">Error almacenando la clave p\xFAblica en </span><span style="color:#39ADB5;">&quot;</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> ficheroClavePublica</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span><span style="color:#90A4AE;">                </span></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#39ADB5;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">private</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">static</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">void</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">guardaClavePrivadaPKCS8</span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">PrivateKey</span><span style="color:#90A4AE;"> clavePrivada</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;font-style:italic;">try</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">FileOutputStream</span><span style="color:#90A4AE;"> privateKeyFile </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">FileOutputStream</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">ficheroClavePrivada</span><span style="color:#39ADB5;">))</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#9C3EDA;">PKCS8EncodedKeySpec</span><span style="color:#90A4AE;"> codificacionClavePrivada </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">PKCS8EncodedKeySpec</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">clavePrivada</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getEncoded</span><span style="color:#39ADB5;">(),</span><span style="color:#90A4AE;"> algoritmoClaveAsimetrica</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">            privateKeyFile</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">write</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">clavePrivada</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getEncoded</span><span style="color:#39ADB5;">());</span></span>
<span class="line"><span style="color:#90A4AE;">            </span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Visualizamos la clave por consola</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#6182B8;">MostrarClaveBase64</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">codificacionClavePrivada</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getEncoded</span><span style="color:#39ADB5;">(),</span></span>
<span class="line"><span style="color:#90A4AE;">                    codificacionClavePrivada</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getFormat</span><span style="color:#39ADB5;">(),</span><span style="color:#90A4AE;"> ficheroClavePrivada</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">catch</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">IOException</span><span style="color:#90A4AE;"> ex</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">            System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">out</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">Error almacenando la clave privada en </span><span style="color:#39ADB5;">&quot;</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> ficheroClavePrivada</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span><span style="color:#90A4AE;">        </span></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#39ADB5;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">private</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">static</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">void</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">MostrarClaveBase64</span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">byte</span><span style="color:#39ADB5;">[]</span><span style="color:#90A4AE;"> clave</span><span style="color:#39ADB5;">,</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">String</span><span style="color:#90A4AE;"> formatoClave</span><span style="color:#39ADB5;">,</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">String</span><span style="color:#90A4AE;"> ficheroClave</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">        System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">out</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">Clave guardada en formato </span><span style="color:#39ADB5;">&quot;</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> formatoClave </span></span>
<span class="line"><span style="color:#90A4AE;">                </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;"> en fichero </span><span style="color:#39ADB5;">&quot;</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> ficheroClave</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">        System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">out</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">Base64</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getEncoder</span><span style="color:#39ADB5;">().</span><span style="color:#6182B8;">encodeToString</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">clave</span><span style="color:#39ADB5;">).</span><span style="color:#6182B8;">replaceAll</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">(.{76})</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">,</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">$1</span><span style="color:#90A4AE;">\\n</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">));</span></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#39ADB5;">}</span></span>
<span class="line"><span style="color:#39ADB5;">}</span></span>
<span class="line"></span></code></pre><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><br><br><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlight-line">\xA0</div><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlight-line">\xA0</div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Esta ser\xEDa la salida proporcionada</p><div class="language-bash ext-sh line-numbers-mode"><pre class="shiki" style="background-color:#FAFAFA;"><code><span class="line"><span style="color:#90A4AE;">Clave guardada en formato X.509 en fichero claves/clavepublica.der</span></span>
<span class="line"><span style="color:#90A4AE;">MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC4UFRgEIm3lFKO75QmqTPvkDs0fM6NUm2FHQcA</span></span>
<span class="line"><span style="color:#90A4AE;">cQHawLx9/WKXh9xkx/xYZZcc4L2YQYcwTu4jfk889iGKGLn2Kh4ywBY+g8uZ6ljM5PT6f95dU6Zd</span></span>
<span class="line"><span style="color:#90A4AE;">xATWOn1qsizBubf7kKhBL7xDnKU5do3XYzrSjme+9uIsgS7HQ7K0MbKrpQIDAQAB</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">Clave guardada en formato PKCS#8 en fichero claves/claveprivada.pkcs8</span></span>
<span class="line"><span style="color:#90A4AE;">MIICdgIBADANBgkqhkiG9w0BAQEFAASCAmAwggJcAgEAAoGBALhQVGAQibeUUo7vlCapM++QOzR8</span></span>
<span class="line"><span style="color:#90A4AE;">zo1SbYUdBwBxAdrAvH39YpeH3GTH/FhllxzgvZhBhzBO7iN+Tzz2IYoYufYqHjLAFj6Dy5nqWMzk</span></span>
<span class="line"><span style="color:#90A4AE;">9Pp/3l1Tpl3EBNY6fWqyLMG5t/uQqEEvvEOcpTl2jddjOtKOZ7724iyBLsdDsrQxsqulAgMBAAEC</span></span>
<span class="line"><span style="color:#90A4AE;">gYA97xBLL4N3YqnTSgIYc6b2Cxs56e5mYppWrohZx5996GHuXCSzEn4mh2TuN0Tt+T78WJiazQsM</span></span>
<span class="line"><span style="color:#90A4AE;">djceHv7qLqDd2kWn3IR0gX207KxwjG0I/sAP2z/i9NZ7DPL+FUv8lmeYUfDj8h3wkyhmBqn+tan1</span></span>
<span class="line"><span style="color:#90A4AE;">0xIOcZUrr/yRhrjZLI1SCQJBAPEc4uWSbyBLHVC6SNga7XWNmwi8Mq4PZJdhW9RJWDxg9zOlC/HV</span></span>
<span class="line"><span style="color:#90A4AE;">rV60ddbfW/ldIqCH33DUge5U5YhD6Mla/XMCQQDDsahcwTksp2bJowMTRgFHT094sihtSlQ7sgdI</span></span>
<span class="line"><span style="color:#90A4AE;">uAemuMvBmVTHleFBWMqz1rAN6A/76yef3WK4I+nsmeCGa+yHAkEA7BR1kYT8q+kATi/n7TkIcoZx</span></span>
<span class="line"><span style="color:#90A4AE;">W28yTD2kJ5jbWhNqgswKn5WmCWdH9qfJjddrbdEke3wuaoKYqeyURgUAJE+kQwJADhEsQBanrH0Q</span></span>
<span class="line"><span style="color:#90A4AE;">F3h/VRhYKS8bUFrGKy0Hpw7iFSkda6+m/fCutnYgrhja4ViSaT2AQKSjwYsheIkkXJynFiKV6wJA</span></span>
<span class="line"><span style="color:#90A4AE;">PUHXqlvfgPr4w2U+Ddq7h/gp59kO0uojGrEBO0B2wt3PuuSQlZlMN97Ly9QmB6LYRtw6woCZZZOD</span></span>
<span class="line"><span style="color:#90A4AE;">ePqA7rf8IA==</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>En el ejemplo anterior en lugar de utilizar clases est\xE1ndar para volcar el contenido binario de las claves a un archivo en formato raw, se utilizan clases codificadoras para generar ficheros binarios en formatos est\xE1ndares, tanto para la clave p\xFAblica como para la privada.</p><p>Esto tiene la enorme ventaja de que se pueden utilizar las claves generadas con herramientas est\xE1ndar como openssl. Adem\xE1s, facilita la tarea ya que las claves p\xFAblica y privada para criptograf\xEDa asim\xE9trica son objetos compuestos.</p><div class="custom-container info"><p class="custom-container-title">Codificaci\xF3n Base64</p><p>Base64 es un grupo de esquemas de codificaci\xF3n de binario a texto que representa los datos binarios mediante una cadena.</p><p>Los esquemas de codificaci\xF3n Base64 son com\xFAnmente usados cuando se necesita codificar datos binarios para que sean almacenados y transferidos sobre un medio dise\xF1ado para tratar con datos textuales. Esto es para asegurar que los datos se mantienen intactos y sin modificaciones durante la transmisi\xF3n.</p><p>Los valores codificados en Base64 como texto se muestran en filas de 76 caracteres como m\xE1ximo, para mejor legibilidad, y siguiendo convenciones habituales.</p><p>Para verlos en pantalla se a\xF1ade un salto de l\xEDnea despu\xE9s de cada grupo de 76 caracteres usando <code>replaceAll(&quot;(.{76})&quot;, &quot;$1\\n&quot;)</code>.</p></div><p>Las claves que se han guardado con el programa tienen las siguientes caracter\xEDsticas:</p><ul><li>La clave p\xFAblica se guarda en un fichero <code>clavepublica.der</code>, con el formato de la estructura <em>SubjectPublicKeyInfo</em> en formato <em>ASN.1</em> definido en el est\xE1ndar <em>X.509</em>, y con codificaci\xF3n <em>DER (binaria)</em>. Para eso se ha utilizado la clase codificadora <strong>X509EncodedKeySpec</strong>.</li><li>La clave privada se guarda en un fichero <code>claveprivada.pkcs8</code>, en formato <em>PKCS#8</em>, y con codificaci\xF3n <em>DER (binaria)</em>. Para eso se ha utilizado la clase codificadora <strong>PKCS8EncodedKeySpec</strong>.</li></ul><div class="custom-container info"><p class="custom-container-title">Codificaciones por defecto</p><p>Las codificaciones usadas en el programa coinciden con las codificacione por defecto que usan las clases PrivateKey y PublicKey, como se puede ver en los valores proporcionados por los m\xE9todos getFormat() y getEncoded().</p></div><h2 id="_6-4-5-cifrado-y-descifrado-usando-un-par-de-claves" tabindex="-1">6.4.5. Cifrado y descifrado usando un par de claves</h2><p>Aunque ya hemos visto que las claves se pueden generar desde c\xF3digo, lo normal es que una vez hayamos generado un par de claves, estas se puedan reutilizar desde las aplicaciones para cifrar y descifrar informaci\xF3n.</p><p>Si hemos guardado las claves en archivos, el primer paso que tendremos que realizar es recuperar esas claves para poder realizar las operaciones criptogr\xE1ficas con ellas.</p>`,16),Y={class:"custom-container question"},R=s("p",{class:"custom-container-title"},"Prueba de claves online",-1),N=s("p",null,"Podemos probar las claves generadas con una herramienta online.",-1),O={href:"https://www.devglan.com/online-tools/rsa-encryption-decryption",target:"_blank",rel:"noopener noreferrer"},X=a("Online RSA tool"),J=s("p",null,"Prueba a copiar el contenido (en Base64) de las claves p\xFAblica y privada para hacer un cifrado y un descifrado de la informaci\xF3n.",-1),W=s("p",null,"Tambi\xE9n puedes probar a simular una firma digital, realizando el cifrado con la clave privada y el descifrado con la clave p\xFAblica.",-1),H=c(`<p>Veamos un ejemplo de c\xF3mo se hace todo este proceso en Java</p><div class="language-java ext-java line-numbers-mode"><pre class="shiki" style="background-color:#FAFAFA;"><code><span class="line"><span style="color:#9C3EDA;">public</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">class</span><span style="color:#90A4AE;"> </span><span style="color:#E2931D;">U6S6_RsaKeyPairEncrypt</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">private</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">static</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">final</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">int</span><span style="color:#90A4AE;"> tamanoClaveAsimetrica </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#F76D47;">1024</span><span style="color:#39ADB5;">;</span></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">private</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">static</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">final</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">String</span><span style="color:#90A4AE;"> algoritmoClaveAsimetrica </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">RSA</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">;</span></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">private</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">static</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">final</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">String</span><span style="color:#90A4AE;"> ficheroClavePublica </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">claves/clavepublica.der</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">;</span></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">private</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">static</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">final</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">String</span><span style="color:#90A4AE;"> ficheroClavePrivada </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">claves/claveprivada.pkcs8</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">public</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">static</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">void</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">main</span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">String</span><span style="color:#39ADB5;">[]</span><span style="color:#90A4AE;"> args</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;font-style:italic;">try</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">//////////////////////////////////////////////////</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// CIFRADO</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">//////////////////////////////////////////////////</span></span>
<span class="line"><span style="color:#90A4AE;">            </span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Leemos la clave p\xFAblica de un archivo</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#9C3EDA;">PublicKey</span><span style="color:#90A4AE;"> clavePublica </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">leerClavePublica</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">ficheroClavePublica</span><span style="color:#39ADB5;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Preparamos la informaci\xF3n que queremos cifrar</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#9C3EDA;">String</span><span style="color:#90A4AE;"> textoEnClaro </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">Quiero cifrar este mensaje de prueba</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">;</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#9C3EDA;">byte</span><span style="color:#39ADB5;">[]</span><span style="color:#90A4AE;"> mensajeEnClaro </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> textoEnClaro</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getBytes</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">UTF-8</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">            </span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Realizamos el proceso de cifrado con clave p\xFAblica</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Los pasos son exactamente los mismos que con el cifrado sim\xE9trico</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#9C3EDA;">Cipher</span><span style="color:#90A4AE;"> cifrado </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> Cipher</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getInstance</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">algoritmoClaveAsimetrica</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">            cifrado</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">init</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">Cipher</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">ENCRYPT_MODE</span><span style="color:#39ADB5;">,</span><span style="color:#90A4AE;"> clavePublica</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#9C3EDA;">byte</span><span style="color:#39ADB5;">[]</span><span style="color:#90A4AE;"> mensajeCifrado </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> cifrado</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">doFinal</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">mensajeEnClaro</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Visualizamos el mensaje cifrado en modo texto</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#6182B8;">MostrarMensajeBase64</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">mensajeCifrado</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">            </span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">//////////////////////////////////////////////////</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// DESCIFRADO</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">//////////////////////////////////////////////////</span></span>
<span class="line"><span style="color:#90A4AE;">            </span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Leemos la clave privada de un archivo</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#9C3EDA;">PrivateKey</span><span style="color:#90A4AE;"> clavePrivada </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">leerClavePrivada</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">ficheroClavePrivada</span><span style="color:#39ADB5;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Realizamos el proceso de descifrado con clave privada</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Los pasos son exactamente los mismos que con el cifrado sim\xE9trico</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Cipher cifrado = Cipher.getInstance(algoritmoClaveAsimetrica);</span></span>
<span class="line"><span style="color:#90A4AE;">            cifrado</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">init</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">Cipher</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">DECRYPT_MODE</span><span style="color:#39ADB5;">,</span><span style="color:#90A4AE;"> clavePrivada</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#9C3EDA;">byte</span><span style="color:#39ADB5;">[]</span><span style="color:#90A4AE;"> mensajeDescifrado </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> cifrado</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">doFinal</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">mensajeCifrado</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Visualizamos el mensaje descifrado</span></span>
<span class="line"><span style="color:#90A4AE;">            System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">out</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">Texto descifrado:</span><span style="color:#90A4AE;">\\n</span><span style="color:#39ADB5;">&quot;</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">String</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">mensajeDescifrado</span><span style="color:#39ADB5;">,</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">UTF-8</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">));</span></span>
<span class="line"><span style="color:#90A4AE;">                        </span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">catch</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">UnsupportedEncodingException</span><span style="color:#90A4AE;"> ex</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">            System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">out</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">Codificaci\xF3n de caracteres UTF-8 no soportada</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">catch</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">NoSuchAlgorithmException</span><span style="color:#90A4AE;"> ex</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">            System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">err</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">No se ha encontrado la implementaci\xF3n del algoritmo </span><span style="color:#39ADB5;">&quot;</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> algoritmoClaveAsimetrica </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;"> en ning\xFAn Provider</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">catch</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">NoSuchPaddingException</span><span style="color:#90A4AE;"> ex</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">            System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">err</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">El relleno especificado para el algoritmo no est\xE1 permitido</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">catch</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">InvalidKeyException</span><span style="color:#90A4AE;"> ex</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">            System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">err</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">Especificaci\xF3n de clave no v\xE1lida</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">catch</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">IllegalBlockSizeException</span><span style="color:#90A4AE;"> ex</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">            System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">err</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">Tama\xF1o de bloque no v\xE1lido</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">catch</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">BadPaddingException</span><span style="color:#90A4AE;"> ex</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">            System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">err</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">Excepci\xF3n con el relleno usado por el algoritmo</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#39ADB5;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">private</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">static</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">PublicKey</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">leerClavePublica</span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">String</span><span style="color:#90A4AE;"> ficheroClave</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#9C3EDA;">byte</span><span style="color:#39ADB5;">[]</span><span style="color:#90A4AE;"> clavePublicaEncoded</span><span style="color:#39ADB5;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#39ADB5;">        </span><span style="color:#90A4AE;font-style:italic;">// Leemos la informaci\xF3n del archivo</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;font-style:italic;">try</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">FileInputStream</span><span style="color:#90A4AE;"> publicKeyFile </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">FileInputStream</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">ficheroClave</span><span style="color:#39ADB5;">))</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">            clavePublicaEncoded </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> publicKeyFile</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">readAllBytes</span><span style="color:#39ADB5;">();</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">catch</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">FileNotFoundException</span><span style="color:#90A4AE;"> ex</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">            System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">out</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">No se ha encontrado el archivo </span><span style="color:#39ADB5;">&quot;</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> ficheroClave </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;"> con la clave p\xFAblica.</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#39ADB5;font-style:italic;">return</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">null;</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">catch</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">IOException</span><span style="color:#90A4AE;"> ex</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">            System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">out</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">Se ha producido un error de E/S accediendo al archivo </span><span style="color:#39ADB5;">&quot;</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> ficheroClave </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;"> de la clave p\xFAblica.</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#39ADB5;font-style:italic;">return</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">null;</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#39ADB5;">        </span><span style="color:#90A4AE;font-style:italic;">// Generamos la clave a partir del array de bytes le\xEDdos</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#9C3EDA;">KeyFactory</span><span style="color:#90A4AE;"> keyFactory</span><span style="color:#39ADB5;">;</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;font-style:italic;">try</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">            keyFactory </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> KeyFactory</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getInstance</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">algoritmoClaveAsimetrica</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#9C3EDA;">X509EncodedKeySpec</span><span style="color:#90A4AE;"> codificacionClavePublica </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">X509EncodedKeySpec</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">clavePublicaEncoded</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#9C3EDA;">PublicKey</span><span style="color:#90A4AE;"> clavePublica </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> keyFactory</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">generatePublic</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">codificacionClavePublica</span><span style="color:#39ADB5;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Devolvemos la clave p\xFAblica generada</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#39ADB5;font-style:italic;">return</span><span style="color:#90A4AE;"> clavePublica</span><span style="color:#39ADB5;">;</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">catch</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">NoSuchAlgorithmException</span><span style="color:#90A4AE;"> ex</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">            System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">err</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">No se ha encontrado la implementaci\xF3n del algoritmo </span><span style="color:#39ADB5;">&quot;</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> algoritmoClaveAsimetrica </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;"> en ning\xFAn Provider</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#39ADB5;font-style:italic;">return</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">null;</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">catch</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">InvalidKeySpecException</span><span style="color:#90A4AE;"> ex</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">            Logger</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getLogger</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">U6S6_RsaKeyPairEncrypt</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">class</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getName</span><span style="color:#39ADB5;">()).</span><span style="color:#6182B8;">log</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">Level</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">SEVERE</span><span style="color:#39ADB5;">,</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">null,</span><span style="color:#90A4AE;"> ex</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#39ADB5;font-style:italic;">return</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">null;</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#39ADB5;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">private</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">static</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">PrivateKey</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">leerClavePrivada</span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">String</span><span style="color:#90A4AE;"> ficheroClave</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#9C3EDA;">byte</span><span style="color:#39ADB5;">[]</span><span style="color:#90A4AE;"> clavePrivadaEncoded</span><span style="color:#39ADB5;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#39ADB5;">        </span><span style="color:#90A4AE;font-style:italic;">// Leemos la informaci\xF3n del archivo</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;font-style:italic;">try</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">FileInputStream</span><span style="color:#90A4AE;"> privateKeyFile </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">FileInputStream</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">ficheroClave</span><span style="color:#39ADB5;">))</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">            clavePrivadaEncoded </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> privateKeyFile</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">readAllBytes</span><span style="color:#39ADB5;">();</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">catch</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">FileNotFoundException</span><span style="color:#90A4AE;"> ex</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">            System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">out</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">No se ha encontrado el archivo </span><span style="color:#39ADB5;">&quot;</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> ficheroClave </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;"> con la clave privada.</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#39ADB5;font-style:italic;">return</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">null;</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">catch</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">IOException</span><span style="color:#90A4AE;"> ex</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">            System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">out</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">Se ha producido un error de E/S accediendo al archivo </span><span style="color:#39ADB5;">&quot;</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> ficheroClave </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;"> de la clave privada.</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#39ADB5;font-style:italic;">return</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">null;</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#39ADB5;">        </span><span style="color:#90A4AE;font-style:italic;">// Generamos la clave a partir del array de bytes le\xEDdos</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#9C3EDA;">KeyFactory</span><span style="color:#90A4AE;"> keyFactory</span><span style="color:#39ADB5;">;</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;font-style:italic;">try</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">            keyFactory </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> KeyFactory</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getInstance</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">algoritmoClaveAsimetrica</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#9C3EDA;">PKCS8EncodedKeySpec</span><span style="color:#90A4AE;"> codificacionClavePrivada </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">PKCS8EncodedKeySpec</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">clavePrivadaEncoded</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#9C3EDA;">PrivateKey</span><span style="color:#90A4AE;"> clavePrivada </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> keyFactory</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">generatePrivate</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">codificacionClavePrivada</span><span style="color:#39ADB5;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Devolvemos la clave p\xFAblica generada</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#39ADB5;font-style:italic;">return</span><span style="color:#90A4AE;"> clavePrivada</span><span style="color:#39ADB5;">;</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">catch</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">NoSuchAlgorithmException</span><span style="color:#90A4AE;"> ex</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">            System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">err</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">No se ha encontrado la implementaci\xF3n del algoritmo </span><span style="color:#39ADB5;">&quot;</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> algoritmoClaveAsimetrica </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;"> en ning\xFAn Provider</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#39ADB5;font-style:italic;">return</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">null;</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">catch</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">InvalidKeySpecException</span><span style="color:#90A4AE;"> ex</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">            Logger</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getLogger</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">U6S6_RsaKeyPairEncrypt</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">class</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getName</span><span style="color:#39ADB5;">()).</span><span style="color:#6182B8;">log</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">Level</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">SEVERE</span><span style="color:#39ADB5;">,</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">null,</span><span style="color:#90A4AE;"> ex</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#39ADB5;font-style:italic;">return</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">null;</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#39ADB5;">}</span></span>
<span class="line"><span style="color:#90A4AE;">    </span></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">private</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">static</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">void</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">MostrarMensajeBase64</span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">byte</span><span style="color:#39ADB5;">[]</span><span style="color:#90A4AE;"> mensajeCifrado</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">        System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">out</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">Mensaje cifrado visualizado como texto en Base64:</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">);</span><span style="color:#90A4AE;">                </span></span>
<span class="line"><span style="color:#90A4AE;">        System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">out</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">Base64</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getEncoder</span><span style="color:#39ADB5;">().</span><span style="color:#6182B8;">encodeToString</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">mensajeCifrado</span><span style="color:#39ADB5;">).</span><span style="color:#6182B8;">replaceAll</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">(.{76})</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">,</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">$1</span><span style="color:#90A4AE;">\\n</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">));</span></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#39ADB5;">}</span><span style="color:#90A4AE;">    </span></span>
<span class="line"><span style="color:#39ADB5;">}</span></span>
<span class="line"></span></code></pre><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Y esta es la salida proporcionada</p><div class="language-bash ext-sh line-numbers-mode"><pre class="shiki" style="background-color:#FAFAFA;"><code><span class="line"><span style="color:#90A4AE;">Mensaje cifrado visualizado como texto en Base64:</span></span>
<span class="line"><span style="color:#90A4AE;">EV+7WrEf+4CYwckys9blk6DXnLHUm4i0k+4BIp3oNmPdo2skYY8bQsAhXToBx2gi/rMIK9wiJTH0</span></span>
<span class="line"><span style="color:#90A4AE;">yg99jpyaLeUgtga8PxWx1plgvxohzO/lALkf5AFRUczZh8F5QvOXCi93v2ycZCZXq7QmZTopkEQh</span></span>
<span class="line"><span style="color:#90A4AE;">ARSezD/1Al2UYPc2X68=</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">Texto descifrado:</span></span>
<span class="line"><span style="color:#90A4AE;">Quiero cifrar este mensaje de prueba</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="custom-container warning"><p class="custom-container-title">Cifrado siempre diferente, descifrado siempre igual</p><p>El resultado de cifrar un mensaje con la misma clave p\xFAblica no siempre es igual, aunque al descifrar los mensajes con la clave privada siempre se obtiene el mensaje original.</p><p>Esto es debido a que, para aumentar la variabilidad (<strong>entrop\xEDa</strong>) del mensaje cifrado al mensaje que se cifra se le a\xF1ade una parte aleatoria (<strong>salt</strong>) que se descarta cuando se descifra.</p></div><p>En el c\xF3digo podemos observar c\xF3mo los procesos para cargar la clave desde un archivo usan las mismas clases que cuando se generaron, siendo el c\xF3digo muy parecido.</p><p>En cuanto al cifrado y descifrado se realiza con el <em>Engine Cipher</em> usando la misma secuencia de llamadas que con el cifrado sim\xE9trico.</p><h2 id="_6-2-3-cifrado-asimetrico-con-gnupg" tabindex="-1">6.2.3. Cifrado asim\xE9trico con GnuPG</h2><p>Con la suite GnuPG tambi\xE9n podemos generar pares de claves y cifrar y descifrar el contenido de los archivos usando diferentes algoritmos</p><div class="custom-container info"><p class="custom-container-title">Algoritmos disponibles para GnuPG</p><p>Para ver la lista de algoritmos disponibles tenemos que mostrar la ayuda del comando</p><blockquote><p>gpg --help</p></blockquote><p>y en la parte superior observamos la informaci\xF3n de los algoritmos disponibles para cada tipo de servicio. En concreto, de res\xFAmenes, en mi versi\xF3n instalada:</p><p>Clave p\xFAblica: RSA, ELG, DSA, ECDH, ECDSA, EDDSA</p></div><p>Para generar las claves, ejecutamos los siguientes comandos</p><p>TO-DO: Completar</p><p>Para cifrar y descifrar un archivo con las claves generadas, ejecutamos los siguientes comandos</p><p>TO-DO: Completar</p>`,14);function Z($,ss){const r=p("DownloadPDF-component"),i=p("DocumentCover-component"),l=p("router-link"),o=p("ExternalLinkIcon");return u(),v("div",null,[n(r),n(i,{titulo:"6.4 Encriptaci\xF3n asim\xE9trica"}),E,s("nav",B,[s("ul",null,[s("li",null,[n(l,{to:"#_6-4-1-clave-publica-y-clave-privada"},{default:e(()=>[D]),_:1})]),s("li",null,[n(l,{to:"#_6-4-2-firma-digital"},{default:e(()=>[b]),_:1}),s("ul",null,[s("li",null,[n(l,{to:"#integridad"},{default:e(()=>[f]),_:1})]),s("li",null,[n(l,{to:"#autenticacion-y-no-repudio"},{default:e(()=>[g]),_:1})])])]),s("li",null,[n(l,{to:"#_6-4-3-certificados-digitales"},{default:e(()=>[h]),_:1}),s("ul",null,[s("li",null,[n(l,{to:"#claves-digitales"},{default:e(()=>[C]),_:1})]),s("li",null,[n(l,{to:"#infraestructura-de-clave-publica-pki"},{default:e(()=>[q]),_:1})])])]),s("li",null,[n(l,{to:"#_6-4-4-generacion-de-pares-de-claves"},{default:e(()=>[S]),_:1}),s("ul",null,[s("li",null,[n(l,{to:"#tipos-de-ficheros-para-certificados-digitales"},{default:e(()=>[P]),_:1})]),s("li",null,[n(l,{to:"#generacion-de-claves-desde-java"},{default:e(()=>[_]),_:1})])])]),s("li",null,[n(l,{to:"#_6-4-5-cifrado-y-descifrado-usando-un-par-de-claves"},{default:e(()=>[x]),_:1})]),s("li",null,[n(l,{to:"#_6-2-3-cifrado-asimetrico-con-gnupg"},{default:e(()=>[K]),_:1})])])]),F,s("p",null,[s("a",z,[w,n(o)])]),j,k,s("p",null,[s("a",I,[M,n(o)])]),Q,s("ul",null,[G,s("li",null,[L,s("a",T,[V,n(o)])])]),U,s("div",Y,[R,N,s("p",null,[s("a",O,[X,n(o)])]),J,W]),H])}const ls=y(m,[["render",Z],["__file","asymmetric-keys.html.vue"]]);export{ls as default};
