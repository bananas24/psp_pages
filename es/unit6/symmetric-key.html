<!DOCTYPE html>
<html lang="es-ES">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.67">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <meta name="theme-color" content="#3eaf7c"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="icon" href="/psp_pages/psp_favicon.png"><title>6.3 Encriptación simétrica | Programación de Servicios y Procesos</title><meta name="description" content="Módulo PSP de 2º DAM">
    <link rel="preload" href="/psp_pages/assets/style-2727dc94.css" as="style"><link rel="stylesheet" href="/psp_pages/assets/style-2727dc94.css">
    <link rel="modulepreload" href="/psp_pages/assets/app-613bf899.js"><link rel="modulepreload" href="/psp_pages/assets/symmetric-key.html-62b501e1.js"><link rel="modulepreload" href="/psp_pages/assets/symmetric-key.html-5545c915.js"><link rel="modulepreload" href="/psp_pages/assets/symmetric-encryption-primitive-db389e98.js"><link rel="prefetch" href="/psp_pages/assets/index.html-6f0a767e.js" as="script"><link rel="prefetch" href="/psp_pages/assets/test_page.html-dd9bfa0c.js" as="script"><link rel="prefetch" href="/psp_pages/assets/index.html-cabfd80d.js" as="script"><link rel="prefetch" href="/psp_pages/assets/index.html-b2243a66.js" as="script"><link rel="prefetch" href="/psp_pages/assets/concurrency.html-cea8977e.js" as="script"><link rel="prefetch" href="/psp_pages/assets/index.html-19fea898.js" as="script"><link rel="prefetch" href="/psp_pages/assets/operatingsystem.html-f449ae22.js" as="script"><link rel="prefetch" href="/psp_pages/assets/process.html-8105c484.js" as="script"><link rel="prefetch" href="/psp_pages/assets/curl_annex.html-20f0943c.js" as="script"><link rel="prefetch" href="/psp_pages/assets/index.html-5f3d69e7.js" as="script"><link rel="prefetch" href="/psp_pages/assets/iostreams.html-ce1373c1.js" as="script"><link rel="prefetch" href="/psp_pages/assets/processbuilder.html-e5fa9ba4.js" as="script"><link rel="prefetch" href="/psp_pages/assets/runtime.html-2b8c591d.js" as="script"><link rel="prefetch" href="/psp_pages/assets/alternatives.html-f009a03f.js" as="script"><link rel="prefetch" href="/psp_pages/assets/arraylist_annex.html-3e0b1784.js" as="script"><link rel="prefetch" href="/psp_pages/assets/debugger_annex.html-018103fd.js" as="script"><link rel="prefetch" href="/psp_pages/assets/hashmap_annex.html-53e5f82a.js" as="script"><link rel="prefetch" href="/psp_pages/assets/index.html-0431a5b4.js" as="script"><link rel="prefetch" href="/psp_pages/assets/producer-consumer.html-01e108b4.js" as="script"><link rel="prefetch" href="/psp_pages/assets/runnable.html-554443cd.js" as="script"><link rel="prefetch" href="/psp_pages/assets/synchronization.html-afaa97c2.js" as="script"><link rel="prefetch" href="/psp_pages/assets/index.html-67e08c72.js" as="script"><link rel="prefetch" href="/psp_pages/assets/sockets-tcp.html-740d24cc.js" as="script"><link rel="prefetch" href="/psp_pages/assets/sockets-udp.html-8878541f.js" as="script"><link rel="prefetch" href="/psp_pages/assets/stateful-protocols.html-90925254.js" as="script"><link rel="prefetch" href="/psp_pages/assets/tcp-ip.html-bc436d60.js" as="script"><link rel="prefetch" href="/psp_pages/assets/urls.html-f720c049.js" as="script"><link rel="prefetch" href="/psp_pages/assets/ftp.html-245f61ab.js" as="script"><link rel="prefetch" href="/psp_pages/assets/index.html-ab366f1c.js" as="script"><link rel="prefetch" href="/psp_pages/assets/mail.html-4d1979e7.js" as="script"><link rel="prefetch" href="/psp_pages/assets/asymmetric-keys.html-e6c1d7a6.js" as="script"><link rel="prefetch" href="/psp_pages/assets/hash-functions.html-039be00f.js" as="script"><link rel="prefetch" href="/psp_pages/assets/index.html-e47dde28.js" as="script"><link rel="prefetch" href="/psp_pages/assets/jsse.html-4a5f383e.js" as="script"><link rel="prefetch" href="/psp_pages/assets/security.html-06dff81c.js" as="script"><link rel="prefetch" href="/psp_pages/assets/symmetric-key.html-cdef9b44.js" as="script"><link rel="prefetch" href="/psp_pages/assets/concurrency.html-f3e9cece.js" as="script"><link rel="prefetch" href="/psp_pages/assets/index.html-1d48b7ac.js" as="script"><link rel="prefetch" href="/psp_pages/assets/operatingsystem.html-ddd465da.js" as="script"><link rel="prefetch" href="/psp_pages/assets/process.html-b6cfef96.js" as="script"><link rel="prefetch" href="/psp_pages/assets/curl_annex.html-60af0211.js" as="script"><link rel="prefetch" href="/psp_pages/assets/index.html-eacea1db.js" as="script"><link rel="prefetch" href="/psp_pages/assets/iostreams.html-aa4c3eda.js" as="script"><link rel="prefetch" href="/psp_pages/assets/processbuilder.html-32bbef96.js" as="script"><link rel="prefetch" href="/psp_pages/assets/runtime.html-b3314bfe.js" as="script"><link rel="prefetch" href="/psp_pages/assets/alternatives.html-170f520b.js" as="script"><link rel="prefetch" href="/psp_pages/assets/arraylist_annex.html-5ecf0008.js" as="script"><link rel="prefetch" href="/psp_pages/assets/debugger_annex.html-adce6756.js" as="script"><link rel="prefetch" href="/psp_pages/assets/hashmap_annex.html-9f09e7a7.js" as="script"><link rel="prefetch" href="/psp_pages/assets/index.html-8ed0d755.js" as="script"><link rel="prefetch" href="/psp_pages/assets/producer-consumer.html-d06bcb6f.js" as="script"><link rel="prefetch" href="/psp_pages/assets/runnable.html-07b43424.js" as="script"><link rel="prefetch" href="/psp_pages/assets/synchronization.html-53938350.js" as="script"><link rel="prefetch" href="/psp_pages/assets/index.html-facd1414.js" as="script"><link rel="prefetch" href="/psp_pages/assets/sockets-tcp.html-ed0d5d04.js" as="script"><link rel="prefetch" href="/psp_pages/assets/sockets-udp.html-9058d4f6.js" as="script"><link rel="prefetch" href="/psp_pages/assets/stateful-protocols.html-c1b2e06f.js" as="script"><link rel="prefetch" href="/psp_pages/assets/tcp-ip.html-a6d36f4c.js" as="script"><link rel="prefetch" href="/psp_pages/assets/urls.html-b4a10bea.js" as="script"><link rel="prefetch" href="/psp_pages/assets/ftp.html-9c666b6b.js" as="script"><link rel="prefetch" href="/psp_pages/assets/index.html-1f27dc1e.js" as="script"><link rel="prefetch" href="/psp_pages/assets/mail.html-6033e7b0.js" as="script"><link rel="prefetch" href="/psp_pages/assets/asymmetric-keys.html-8554d66f.js" as="script"><link rel="prefetch" href="/psp_pages/assets/hash-functions.html-73ecb3c4.js" as="script"><link rel="prefetch" href="/psp_pages/assets/index.html-549e4aee.js" as="script"><link rel="prefetch" href="/psp_pages/assets/jsse.html-1da09087.js" as="script"><link rel="prefetch" href="/psp_pages/assets/security.html-4b4eb4ea.js" as="script"><link rel="prefetch" href="/psp_pages/assets/404.html-60b35caa.js" as="script"><link rel="prefetch" href="/psp_pages/assets/index.html-ee677249.js" as="script"><link rel="prefetch" href="/psp_pages/assets/test_page.html-11e04d55.js" as="script"><link rel="prefetch" href="/psp_pages/assets/index.html-8fe8298a.js" as="script"><link rel="prefetch" href="/psp_pages/assets/index.html-2d458de8.js" as="script"><link rel="prefetch" href="/psp_pages/assets/concurrency.html-38c6cdc2.js" as="script"><link rel="prefetch" href="/psp_pages/assets/index.html-8ea549da.js" as="script"><link rel="prefetch" href="/psp_pages/assets/operatingsystem.html-85eb84c7.js" as="script"><link rel="prefetch" href="/psp_pages/assets/process.html-86ec6349.js" as="script"><link rel="prefetch" href="/psp_pages/assets/curl_annex.html-b4eaab98.js" as="script"><link rel="prefetch" href="/psp_pages/assets/index.html-da41396b.js" as="script"><link rel="prefetch" href="/psp_pages/assets/iostreams.html-2b56cc6b.js" as="script"><link rel="prefetch" href="/psp_pages/assets/processbuilder.html-006577e1.js" as="script"><link rel="prefetch" href="/psp_pages/assets/runtime.html-28839aaf.js" as="script"><link rel="prefetch" href="/psp_pages/assets/alternatives.html-b4f1130a.js" as="script"><link rel="prefetch" href="/psp_pages/assets/arraylist_annex.html-3b1ffb52.js" as="script"><link rel="prefetch" href="/psp_pages/assets/debugger_annex.html-3f536fdf.js" as="script"><link rel="prefetch" href="/psp_pages/assets/hashmap_annex.html-291fb0b7.js" as="script"><link rel="prefetch" href="/psp_pages/assets/index.html-264307f0.js" as="script"><link rel="prefetch" href="/psp_pages/assets/producer-consumer.html-27de4891.js" as="script"><link rel="prefetch" href="/psp_pages/assets/runnable.html-beaa11d6.js" as="script"><link rel="prefetch" href="/psp_pages/assets/synchronization.html-f8d9b4a6.js" as="script"><link rel="prefetch" href="/psp_pages/assets/index.html-5c444973.js" as="script"><link rel="prefetch" href="/psp_pages/assets/sockets-tcp.html-05c70473.js" as="script"><link rel="prefetch" href="/psp_pages/assets/sockets-udp.html-7740d44a.js" as="script"><link rel="prefetch" href="/psp_pages/assets/stateful-protocols.html-76b50e32.js" as="script"><link rel="prefetch" href="/psp_pages/assets/tcp-ip.html-adb76b3f.js" as="script"><link rel="prefetch" href="/psp_pages/assets/urls.html-ca9d879d.js" as="script"><link rel="prefetch" href="/psp_pages/assets/ftp.html-3a486c90.js" as="script"><link rel="prefetch" href="/psp_pages/assets/index.html-de745f54.js" as="script"><link rel="prefetch" href="/psp_pages/assets/mail.html-7f7ed6ef.js" as="script"><link rel="prefetch" href="/psp_pages/assets/asymmetric-keys.html-23a9b01f.js" as="script"><link rel="prefetch" href="/psp_pages/assets/hash-functions.html-4937db85.js" as="script"><link rel="prefetch" href="/psp_pages/assets/index.html-8827a0ba.js" as="script"><link rel="prefetch" href="/psp_pages/assets/jsse.html-a14d549d.js" as="script"><link rel="prefetch" href="/psp_pages/assets/security.html-3dbc9c0b.js" as="script"><link rel="prefetch" href="/psp_pages/assets/symmetric-key.html-12fc5a32.js" as="script"><link rel="prefetch" href="/psp_pages/assets/concurrency.html-b2b3bfc6.js" as="script"><link rel="prefetch" href="/psp_pages/assets/index.html-6d964574.js" as="script"><link rel="prefetch" href="/psp_pages/assets/operatingsystem.html-72f6e176.js" as="script"><link rel="prefetch" href="/psp_pages/assets/process.html-7857b0c6.js" as="script"><link rel="prefetch" href="/psp_pages/assets/curl_annex.html-67bc534d.js" as="script"><link rel="prefetch" href="/psp_pages/assets/index.html-68539e4d.js" as="script"><link rel="prefetch" href="/psp_pages/assets/iostreams.html-34e64cee.js" as="script"><link rel="prefetch" href="/psp_pages/assets/processbuilder.html-dee7a907.js" as="script"><link rel="prefetch" href="/psp_pages/assets/runtime.html-4f65e72a.js" as="script"><link rel="prefetch" href="/psp_pages/assets/alternatives.html-aa37d66a.js" as="script"><link rel="prefetch" href="/psp_pages/assets/arraylist_annex.html-6cf2dd36.js" as="script"><link rel="prefetch" href="/psp_pages/assets/debugger_annex.html-a570b65f.js" as="script"><link rel="prefetch" href="/psp_pages/assets/hashmap_annex.html-79d2ef79.js" as="script"><link rel="prefetch" href="/psp_pages/assets/index.html-d780e222.js" as="script"><link rel="prefetch" href="/psp_pages/assets/producer-consumer.html-91ad4495.js" as="script"><link rel="prefetch" href="/psp_pages/assets/runnable.html-ff1e70ce.js" as="script"><link rel="prefetch" href="/psp_pages/assets/synchronization.html-95a60f3f.js" as="script"><link rel="prefetch" href="/psp_pages/assets/index.html-6ab599ef.js" as="script"><link rel="prefetch" href="/psp_pages/assets/sockets-tcp.html-aa100b64.js" as="script"><link rel="prefetch" href="/psp_pages/assets/sockets-udp.html-aede9988.js" as="script"><link rel="prefetch" href="/psp_pages/assets/stateful-protocols.html-38f6397c.js" as="script"><link rel="prefetch" href="/psp_pages/assets/tcp-ip.html-b41e0393.js" as="script"><link rel="prefetch" href="/psp_pages/assets/urls.html-42bc1762.js" as="script"><link rel="prefetch" href="/psp_pages/assets/ftp.html-fefe0de1.js" as="script"><link rel="prefetch" href="/psp_pages/assets/index.html-1c110d8b.js" as="script"><link rel="prefetch" href="/psp_pages/assets/mail.html-875aeebf.js" as="script"><link rel="prefetch" href="/psp_pages/assets/asymmetric-keys.html-720fe32c.js" as="script"><link rel="prefetch" href="/psp_pages/assets/hash-functions.html-438d635a.js" as="script"><link rel="prefetch" href="/psp_pages/assets/index.html-62e74401.js" as="script"><link rel="prefetch" href="/psp_pages/assets/jsse.html-1be86d3a.js" as="script"><link rel="prefetch" href="/psp_pages/assets/security.html-9290265b.js" as="script"><link rel="prefetch" href="/psp_pages/assets/404.html-8cda095c.js" as="script"><link rel="prefetch" href="/psp_pages/assets/CCLicense-component-eb8f2f1a.js" as="script"><link rel="prefetch" href="/psp_pages/assets/DocumentCover-component-4848f8cc.js" as="script"><link rel="prefetch" href="/psp_pages/assets/DownloadPDF-component-bf54d9a1.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="Mostrar/Ocultar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/psp_pages/es/" class=""><img class="logo" src="/psp_pages/LogoIES.png" alt="Programación de Servicios y Procesos"><span class="site-name can-hide">Programación de Servicios y Procesos</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a class="external-link" href="https://aules.edu.gva.es/semipresencial/" rel="noopener noreferrer" target="_blank" aria-label="Aules FP Semi"><!--[--><!--]--> Aules FP Semi <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">Abrir en una ventana nueva</span></span><!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Contenido del curso"><span class="title">Contenido del curso</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Contenido del curso"><span class="title">Contenido del curso</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/psp_pages/es/unit1/" class="" aria-label="Tema 1 - Introducción a la programación concurrente"><!--[--><!--]--> Tema 1 - Introducción a la programación concurrente <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/psp_pages/es/unit2/" class="" aria-label="Tema 2 - Programación de procesos en Java"><!--[--><!--]--> Tema 2 - Programación de procesos en Java <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/psp_pages/es/unit3/" class="" aria-label="Tema 3 - Programación multihilo en Java"><!--[--><!--]--> Tema 3 - Programación multihilo en Java <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/psp_pages/es/unit4/" class="" aria-label="Tema 4 - Programación en red en Java"><!--[--><!--]--> Tema 4 - Programación en red en Java <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/psp_pages/es/unit5/" class="" aria-label="Tema 5 - Servicios en red"><!--[--><!--]--> Tema 5 - Servicios en red <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/psp_pages/es/unit6/" class="router-link-active" aria-label="Tema 6 - Técnicas de programación segura"><!--[--><!--]--> Tema 6 - Técnicas de programación segura <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Idioma"><span class="title">Idioma</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Idioma"><span class="title">Idioma</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/psp_pages/en/unit6/symmetric-key.html" class="" aria-label="English"><!--[--><!--]--> English <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a aria-current="page" href="/psp_pages/es/unit6/symmetric-key.html" class="router-link-active router-link-exact-active router-link-active" aria-label="Castellano"><!--[--><!--]--> Castellano <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/psp2dam/psp_sources2022" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">Abrir en una ventana nueva</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" placeholder="Buscar" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a class="external-link" href="https://aules.edu.gva.es/semipresencial/" rel="noopener noreferrer" target="_blank" aria-label="Aules FP Semi"><!--[--><!--]--> Aules FP Semi <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">Abrir en una ventana nueva</span></span><!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Contenido del curso"><span class="title">Contenido del curso</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Contenido del curso"><span class="title">Contenido del curso</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/psp_pages/es/unit1/" class="" aria-label="Tema 1 - Introducción a la programación concurrente"><!--[--><!--]--> Tema 1 - Introducción a la programación concurrente <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/psp_pages/es/unit2/" class="" aria-label="Tema 2 - Programación de procesos en Java"><!--[--><!--]--> Tema 2 - Programación de procesos en Java <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/psp_pages/es/unit3/" class="" aria-label="Tema 3 - Programación multihilo en Java"><!--[--><!--]--> Tema 3 - Programación multihilo en Java <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/psp_pages/es/unit4/" class="" aria-label="Tema 4 - Programación en red en Java"><!--[--><!--]--> Tema 4 - Programación en red en Java <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/psp_pages/es/unit5/" class="" aria-label="Tema 5 - Servicios en red"><!--[--><!--]--> Tema 5 - Servicios en red <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/psp_pages/es/unit6/" class="router-link-active" aria-label="Tema 6 - Técnicas de programación segura"><!--[--><!--]--> Tema 6 - Técnicas de programación segura <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Idioma"><span class="title">Idioma</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Idioma"><span class="title">Idioma</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/psp_pages/en/unit6/symmetric-key.html" class="" aria-label="English"><!--[--><!--]--> English <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a aria-current="page" href="/psp_pages/es/unit6/symmetric-key.html" class="router-link-active router-link-exact-active router-link-active" aria-label="Castellano"><!--[--><!--]--> Castellano <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/psp2dam/psp_sources2022" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">Abrir en una ventana nueva</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading active">Tema 6 - Técnicas de programación segura <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/psp_pages/es/unit6/" class="router-link-active sidebar-item" aria-label="6 Introducción"><!--[--><!--]--> 6 Introducción <!--[--><!--]--></a><!----></li><li><a href="/psp_pages/es/unit6/security.html" class="sidebar-item" aria-label="6.1 Seguridad"><!--[--><!--]--> 6.1 Seguridad <!--[--><!--]--></a><!----></li><li><a href="/psp_pages/es/unit6/hash-functions.html" class="sidebar-item" aria-label="6.2 Funciones resumen"><!--[--><!--]--> 6.2 Funciones resumen <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/psp_pages/es/unit6/symmetric-key.html" class="router-link-active router-link-exact-active router-link-active sidebar-item active" aria-label="6.3 Encriptación simétrica"><!--[--><!--]--> 6.3 Encriptación simétrica <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/psp_pages/es/unit6/symmetric-key.html#_6-3-1-clave-secreta" class="router-link-active router-link-exact-active sidebar-item" aria-label="6.3.1. Clave secreta"><!--[--><!--]--> 6.3.1. Clave secreta <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/psp_pages/es/unit6/symmetric-key.html#_6-3-2-cipher" class="router-link-active router-link-exact-active sidebar-item" aria-label="6.3.2. Cipher"><!--[--><!--]--> 6.3.2. Cipher <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/psp_pages/es/unit6/symmetric-key.html#transformaciones-basicas-en-java" class="router-link-active router-link-exact-active sidebar-item" aria-label="Transformaciones básicas en Java"><!--[--><!--]--> Transformaciones básicas en Java <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/psp_pages/es/unit6/symmetric-key.html#_6-3-3-clases-stream-para-cifrado-y-descifrado-simetrico" class="router-link-active router-link-exact-active sidebar-item" aria-label="6.3.3. Clases stream para cifrado y descifrado simétrico"><!--[--><!--]--> 6.3.3. Clases stream para cifrado y descifrado simétrico <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/psp_pages/es/unit6/symmetric-key.html#_6-3-4-cifrado-simetrico-con-gnupg" class="router-link-active router-link-exact-active sidebar-item" aria-label="6.3.4. Cifrado simétrico con GnuPG"><!--[--><!--]--> 6.3.4. Cifrado simétrico con GnuPG <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a href="/psp_pages/es/unit6/asymmetric-keys.html" class="sidebar-item" aria-label="6.4 Encriptación asimétrica"><!--[--><!--]--> 6.4 Encriptación asimétrica <!--[--><!--]--></a><!----></li><li><a href="/psp_pages/es/unit6/jsse.html" class="sidebar-item" aria-label="6.5 Comunicaciones seguras en Java"><!--[--><!--]--> 6.5 Comunicaciones seguras en Java <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><div true class="downloadLink" align="right"><a href="/psp_pages/pdf/6.3 Encriptación simétrica.pdf" download><img src="/psp_pages/images/download-pdf.png" title="descarga como PDF" alt="descarga PDF" height="50"></a><a href="/psp_pages/pdf/6.3 Encriptación simétrica.pdf" target="_blank"><img src="/psp_pages/images/open-pdf.png" title="abre como PDF" alt="abre PDF" height="50"></a></div><div true class="documentcover" align="center"><img src="/psp_pages/images/LogoPSP_mini_es.png" alt="PSP Logo"><h1>6.3 Encriptación simétrica</h1><h2></h2><img src="/psp_pages/LogoIES.png" alt="Logo IES Doctor Balmis" style="padding:2cm;"><div true class="cclicense" align="center"><p xmlns:cc="http://creativecommons.org/ns#" xmlns:dct="http://purl.org/dc/terms/"><a property="dct:title" rel="cc:attributionURL" href="https://psp2dam.github.io/psp_sources/es/">Apuntes de PSP</a> creados por <span property="cc:attributionName">Vicente Martínez</span> bajo licencia <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/deed.es" target="_blank" rel="license noopener noreferrer" style="display:inline-block;"> CC BY-NC-SA 4.0<img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1"><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1"><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/nc.svg?ref=chooser-v1"><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/sa.svg?ref=chooser-v1"></a></p></div><div class="pagebreak"></div></div><h1 id="_6-3-encriptacion-simetrica" tabindex="-1">6.3 Encriptación simétrica</h1><nav class="table-of-contents"><ul><li><a aria-current="page" href="/psp_pages/es/unit6/symmetric-key.html#_6-3-1-clave-secreta" class="router-link-active router-link-exact-active">6.3.1. Clave secreta</a></li><li><a aria-current="page" href="/psp_pages/es/unit6/symmetric-key.html#_6-3-2-cipher" class="router-link-active router-link-exact-active">6.3.2. Cipher</a><ul><li><a aria-current="page" href="/psp_pages/es/unit6/symmetric-key.html#transformaciones-basicas-en-java" class="router-link-active router-link-exact-active">Transformaciones básicas en Java</a></li></ul></li><li><a aria-current="page" href="/psp_pages/es/unit6/symmetric-key.html#_6-3-3-clases-stream-para-cifrado-y-descifrado-simetrico" class="router-link-active router-link-exact-active">6.3.3. Clases stream para cifrado y descifrado simétrico</a></li><li><a aria-current="page" href="/psp_pages/es/unit6/symmetric-key.html#_6-3-4-cifrado-simetrico-con-gnupg" class="router-link-active router-link-exact-active">6.3.4. Cifrado simétrico con GnuPG</a></li></ul></nav><h2 id="_6-3-1-clave-secreta" tabindex="-1">6.3.1. Clave secreta</h2><p>Ahora nos interesa no sólo verificar la integridad de la información intercambiada, sino también mantener su privacidad, es decir, que no sea &quot;comprensible&quot; durante la transmisión, intercambio o almacenamiento.</p><p>Tenemos un conjunto de algoritmos denominados de <strong>clave simétrica</strong> (también conocidos como de clave secreta) en los que, mediante la aplicación de una clave conocida tanto por el emisos como por el receptor, la información se <strong>encripta o cifra</strong> de forma que sólo pueda ser <strong>desencriptada o descifrada</strong> utilizando el mismo algoritmo y la misma clave.</p><div class="custom-container info"><p class="custom-container-title">El código Enigma</p><p>Como ejemplo de sistema simétrico está Enigma. Este fue un sistema empleado por Alemania durante la Segunda Guerra Mundial, en el que las claves se distribuían a diario en forma de libros de códigos.</p><p>Cada día, un operador de radio, receptor o transmisor, consultaba su copia del libro de códigos para encontrar la clave del día. Todo el tráfico enviado por ondas de radio durante aquel día era cifrado y descifrado usando las claves del día.</p><p>Inglaterra usó máquinas para descifrar las claves durante aquella guerra y aunque el citado sistema alemán, Enigma, estaba provisto de un amplio abanico de claves, los ingleses diseñaron máquinas de cómputo especializado, los Bombes, para comprobar las claves de modo mecánico hasta que la clave del día era encontrada.</p><p>Esto significaba que algunas veces encontraban la clave del día pocas horas después de que ésta fuera puesta en uso, pero también que otros días no podían encontrar la clave correcta.</p><p>Los Bombes no fueron máquinas de cómputo general, sino las precursoras de los ordenadores (computadoras) actuales.</p></div><p>Entre los algoritmos de cifrado simétrico más utilizados se encuentran</p><ul><li>DES</li><li>3DES o Tiple DES</li><li>RC5</li><li>AES</li><li>Blowfish</li><li>IDEA</li></ul><p><img src="/psp_pages/assets/symmetric-encryption-primitive-cb1437da.png" alt="cifrado simétrico"></p><h2 id="_6-3-2-cipher" tabindex="-1">6.3.2. Cipher</h2><p>Para cifrar y descifrar un mensaje necesitamos una clave y escoger el tipo de cifrado que queremos. En JCA se procede de la siguiente forma:</p><ol><li>Se crea un objeto de la clase <em>SecretKey</em> a partir de un KeyGenerator obtenido con el método estático <em>getInstance()</em>, especificando el nombre del algoritmo. Opcionalmente, se puede especificar el nombre del proveedor.</li><li>Así podemos utilizar una clave prefijada o incluso una clave aleatoria de tipo OTP (One Time Password) ya que cada vez que ejecutemos el programa la clave será diferente.</li><li>Se crea un objeto de tipo Cipher indicando qué algoritmo vamos a usar. Y después, con el método <em>init()</em> se indica qué vamos a hacer (cifrar/descifrar) y con qué clave.</li><li>Se añaden datos con el método <em>update()</em>. Se puede añadir un byte o un array de bytes. Este método se puede invocar varias veces para ir añadiendo nuevos datos.</li><li>Se obtiene el valor cifrado con el método <em>doFinal()</em>.</li><li>Si se quisiera descifrar, sólo hay que volver a invocar al método <em>init()</em> indicando en este caso que queremos descifrar.</li></ol><p>A continuación podemos ver un ejemplo</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="shiki material-theme-lighter" style="background-color:#FAFAFA;" tabindex="0"><code><span class="line"><span style="color:#9C3EDA;">public</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">class</span><span style="color:#90A4AE;"> </span><span style="color:#E2931D;">SecretKeyEncrypt</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">public</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">static</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">void</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">main</span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">String</span><span style="color:#39ADB5;">[]</span><span style="color:#90A4AE;"> </span><span style="color:#90A4AE;font-style:italic;">args</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#9C3EDA;">SecretKey</span><span style="color:#90A4AE;"> claveSecreta </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">null;</span></span>
<span class="line"><span style="color:#90A4AE;">        </span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;font-style:italic;">try</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">//Generamos clave secreta</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Podemos crear una nueva clave</span></span>
<span class="line"><span style="color:#90A4AE;">            claveSecreta </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">getNewKey</span><span style="color:#39ADB5;">();</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// O bien usar una clave guardada en algún almacén, fichero, etc.</span></span>
<span class="line"><span style="color:#90A4AE;">            claveSecreta </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">getKeyFromData</span><span style="color:#39ADB5;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">            System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">out</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">Clave usada: </span><span style="color:#39ADB5;">&quot;</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> claveSecreta</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getFormat</span><span style="color:#39ADB5;">());</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">//Se define el objeto Cipher (Algoritmo/modo/relleno)</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#9C3EDA;">Cipher</span><span style="color:#90A4AE;"> c </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> Cipher</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getInstance</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">DESede</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">);</span><span style="color:#90A4AE;"> </span><span style="color:#90A4AE;font-style:italic;">// AES/ECB/PKCS5Padding</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Configuramos el modo de CIFRADO</span></span>
<span class="line"><span style="color:#90A4AE;">            c</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">init</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">Cipher</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">ENCRYPT_MODE</span><span style="color:#39ADB5;">,</span><span style="color:#90A4AE;"> claveSecreta</span><span style="color:#39ADB5;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Aquí leemos la información que queremos cifrar</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Puede ser una cadena o leerla de un archivo</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#9C3EDA;">byte</span><span style="color:#39ADB5;">[]</span><span style="color:#90A4AE;"> textoPlano </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">Texto que queremos cifrar para la prueba</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getBytes</span><span style="color:#39ADB5;">();</span></span>
<span class="line"><span style="color:#90A4AE;">            </span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Si queremos ir cifrando poco a poco, vamos haciendo llamadas</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// al método update</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// c.update(textoPlano);</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Se realiza el proceso final de cifrado de la información</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#9C3EDA;">byte</span><span style="color:#39ADB5;">[]</span><span style="color:#90A4AE;"> textoCifrado </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> c</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">doFinal</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">textoPlano</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">            System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">out</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">Texto cifrado con clave secreta (raw):</span><span style="color:#90A4AE;">\n</span><span style="color:#39ADB5;">&quot;</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">String</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">textoCifrado</span><span style="color:#39ADB5;">));</span></span>
<span class="line"><span style="color:#90A4AE;">            System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">out</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">Texto cifrado con clave secreta (hex):</span><span style="color:#90A4AE;">\n</span><span style="color:#39ADB5;">&quot;</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">toHexadecimal</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">textoCifrado</span><span style="color:#39ADB5;">));</span></span>
<span class="line"><span style="color:#90A4AE;">                        </span></span>
<span class="line"><span style="color:#90A4AE;">            </span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// El proceso de descifrado es equivalente</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Cambiamos el modo de ENCRYPT a DECRYPT</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Usamos la misma clave</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">// Pasamos el texto cifrado para obtener el original</span></span>
<span class="line"><span style="color:#90A4AE;">            c</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">init</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">Cipher</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">DECRYPT_MODE</span><span style="color:#39ADB5;">,</span><span style="color:#90A4AE;"> claveSecreta</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#9C3EDA;">byte</span><span style="color:#39ADB5;">[]</span><span style="color:#90A4AE;"> textoOriginal </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> c</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">doFinal</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">textoCifrado</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#39ADB5;">            </span><span style="color:#90A4AE;font-style:italic;">//Leemos bloques de bytes del fichero y lo vamos escribiendo ya cifrado en el fichero de salida</span></span>
<span class="line"><span style="color:#90A4AE;">            System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">out</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">Texto descifrado:</span><span style="color:#90A4AE;">\n</span><span style="color:#39ADB5;">&quot;</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">String</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">textoOriginal</span><span style="color:#39ADB5;">));</span></span>
<span class="line"><span style="color:#90A4AE;">            </span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">catch</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">Exception</span><span style="color:#90A4AE;"> </span><span style="color:#90A4AE;font-style:italic;">e</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">            e</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">printStackTrace</span><span style="color:#39ADB5;">();</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#39ADB5;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">static</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">SecretKey</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">getNewKey</span><span style="color:#39ADB5;">()</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">throws</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">InvalidKeySpecException</span><span style="color:#39ADB5;">,</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">NoSuchAlgorithmException</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">    </span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#9C3EDA;">KeyGenerator</span><span style="color:#90A4AE;"> kg </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> KeyGenerator</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getInstance</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">DESede</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">            kg</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">init</span><span style="color:#39ADB5;">(</span><span style="color:#F76D47;">112</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#9C3EDA;">SecretKey</span><span style="color:#90A4AE;"> clave </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> kg</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">generateKey</span><span style="color:#39ADB5;">();</span></span>
<span class="line"><span style="color:#90A4AE;">            </span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#39ADB5;font-style:italic;">return</span><span style="color:#90A4AE;"> clave</span><span style="color:#39ADB5;">;</span></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#39ADB5;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">static</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">SecretKey</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">getNewRandomKey</span><span style="color:#39ADB5;">()</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">throws</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">InvalidKeySpecException</span><span style="color:#39ADB5;">,</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">NoSuchAlgorithmException</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#39ADB5;">        </span><span style="color:#90A4AE;font-style:italic;">// Clave obtenida usando un generador de número aleatorios seguro</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#9C3EDA;">KeyGenerator</span><span style="color:#90A4AE;"> genClaves </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> KeyGenerator</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getInstance</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">DESede</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#39ADB5;">        </span><span style="color:#90A4AE;font-style:italic;">// Utilizamos un algoritmo de generación de aleatorios        </span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#9C3EDA;">SecureRandom</span><span style="color:#90A4AE;"> srand </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> SecureRandom</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getInstance</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">SHA1PRNG</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">        genClaves</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">init</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">srand</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">        </span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#9C3EDA;">SecretKey</span><span style="color:#90A4AE;"> clave </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> genClaves</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">generateKey</span><span style="color:#39ADB5;">();</span></span>
<span class="line"><span style="color:#90A4AE;">        System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">out</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">Formato de clave: </span><span style="color:#39ADB5;">&quot;</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> clave</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getFormat</span><span style="color:#39ADB5;">());</span></span>
<span class="line"><span style="color:#90A4AE;">        </span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#90A4AE;font-style:italic;">/*</span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;">        SecretKeyFactory keySpecFactory = SecretKeyFactory.getInstance(&quot;DESede&quot;);</span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;">        DESedeKeySpec keySpec = (DESedeKeySpec) keySpecFactory.getKeySpec(clave, DESedeKeySpec.class);</span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;">        byte[] valorClave = keySpec.getKey();</span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;">        */</span></span>
<span class="line"><span style="color:#90A4AE;">        </span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;font-style:italic;">return</span><span style="color:#90A4AE;"> clave</span><span style="color:#39ADB5;">;</span></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#39ADB5;">}</span></span>
<span class="line"><span style="color:#90A4AE;">    </span></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">static</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">SecretKey</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">getKeyFromData</span><span style="color:#39ADB5;">()</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">throws</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">InvalidKeySpecException</span><span style="color:#39ADB5;">,</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">NoSuchAlgorithmException</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#39ADB5;">        </span><span style="color:#90A4AE;font-style:italic;">// La clave se puede obtener desde un fichero o cualquier otra fuente</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#9C3EDA;">byte</span><span style="color:#90A4AE;"> valorClave</span><span style="color:#39ADB5;">[]</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">12345678123456781234567812345678</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getBytes</span><span style="color:#39ADB5;">();</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#9C3EDA;">SecretKeySpec</span><span style="color:#90A4AE;"> keySpec </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">SecretKeySpec</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">valorClave</span><span style="color:#39ADB5;">,</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">DESede</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#9C3EDA;">SecretKeyFactory</span><span style="color:#90A4AE;"> keyFactory </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> SecretKeyFactory</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getInstance</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">DESede</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#9C3EDA;">SecretKey</span><span style="color:#90A4AE;"> clave </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> keyFactory</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">generateSecret</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">keySpec</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">        </span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;font-style:italic;">return</span><span style="color:#90A4AE;"> clave</span><span style="color:#39ADB5;">;</span></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#39ADB5;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">static</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">Key</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">getKeyFromData2</span><span style="color:#39ADB5;">()</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">throws</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">InvalidKeySpecException</span><span style="color:#39ADB5;">,</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">NoSuchAlgorithmException</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#39ADB5;">        </span><span style="color:#90A4AE;font-style:italic;">// La clave se puede obtener desde un fichero o cualquier otra fuente</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#9C3EDA;">byte</span><span style="color:#90A4AE;"> valorClave</span><span style="color:#39ADB5;">[]</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">12345678123456781234567812345678</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getBytes</span><span style="color:#39ADB5;">();</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#9C3EDA;">Key</span><span style="color:#90A4AE;"> clave </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">SecretKeySpec</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">valorClave</span><span style="color:#39ADB5;">,</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">AES</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;font-style:italic;">return</span><span style="color:#90A4AE;"> clave</span><span style="color:#39ADB5;">;</span></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#39ADB5;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">static</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">String</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">toHexadecimal</span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">byte</span><span style="color:#39ADB5;">[]</span><span style="color:#90A4AE;"> </span><span style="color:#90A4AE;font-style:italic;">hash</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#9C3EDA;">String</span><span style="color:#90A4AE;"> hex </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;&quot;</span><span style="color:#39ADB5;">;</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;font-style:italic;">for</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">int</span><span style="color:#90A4AE;"> i </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#F76D47;">0</span><span style="color:#39ADB5;">;</span><span style="color:#90A4AE;"> i </span><span style="color:#39ADB5;">&lt;</span><span style="color:#90A4AE;"> hash</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">length</span><span style="color:#39ADB5;">;</span><span style="color:#90A4AE;"> i</span><span style="color:#39ADB5;">++)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#9C3EDA;">String</span><span style="color:#90A4AE;"> h </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> Integer</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">toHexString</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">hash</span><span style="color:#39ADB5;">[</span><span style="color:#90A4AE;">i</span><span style="color:#39ADB5;">]</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&amp;</span><span style="color:#90A4AE;"> </span><span style="color:#F76D47;">0xFF</span><span style="color:#39ADB5;">);</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#39ADB5;font-style:italic;">if</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">h</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">length</span><span style="color:#39ADB5;">()</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">==</span><span style="color:#90A4AE;"> </span><span style="color:#F76D47;">1</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">                hex </span><span style="color:#39ADB5;">+=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">0</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">;</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#39ADB5;">}</span></span>
<span class="line"><span style="color:#90A4AE;">            hex </span><span style="color:#39ADB5;">+=</span><span style="color:#90A4AE;"> h</span><span style="color:#39ADB5;">;</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;font-style:italic;">return</span><span style="color:#90A4AE;"> hex</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">toUpperCase</span><span style="color:#39ADB5;">();</span></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#39ADB5;">}</span></span>
<span class="line"><span style="color:#90A4AE;">    </span></span>
<span class="line"><span style="color:#39ADB5;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>y esta sería la salida proporcionada</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="shiki material-theme-lighter" style="background-color:#FAFAFA;" tabindex="0"><code><span class="line"><span style="color:#E2931D;">Texto</span><span style="color:#90A4AE;"> </span><span style="color:#91B859;">cifrado</span><span style="color:#90A4AE;"> </span><span style="color:#91B859;">con</span><span style="color:#90A4AE;"> </span><span style="color:#91B859;">clave</span><span style="color:#90A4AE;"> </span><span style="color:#91B859;">secreta:</span></span>
<span class="line"><span style="color:#E2931D;">D0A61CD14B5844AD98B2C7BA795B327ACA0795B658C6F93EC6E1586A246BE71AC180B574207E8C4FFEB959B7D4642FCB</span></span>
<span class="line"><span style="color:#E2931D;">Texto</span><span style="color:#90A4AE;"> </span><span style="color:#91B859;">descifrado:</span></span>
<span class="line"><span style="color:#E2931D;">Texto</span><span style="color:#90A4AE;"> </span><span style="color:#91B859;">que</span><span style="color:#90A4AE;"> </span><span style="color:#91B859;">queremos</span><span style="color:#90A4AE;"> </span><span style="color:#91B859;">cifrar</span><span style="color:#90A4AE;"> </span><span style="color:#91B859;">para</span><span style="color:#90A4AE;"> </span><span style="color:#91B859;">la</span><span style="color:#90A4AE;"> </span><span style="color:#91B859;">prueba</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Hay que tener en cuenta que en el ejemplo la clave se está usando primero para cifrar y luego para descifrar. Si esto lo hacemos en programas separados, los programas que quieran comunicarse deberán tener acceso a la clave.</p><p>Lo que se suele hacer es almacenar la clave en un archivo y, cuando se necesita para cifrar o descifrar, se lee con un método similar al método <em>getKeyFromData()</em> del ejemplo anterior.</p><h3 id="transformaciones-basicas-en-java" tabindex="-1">Transformaciones básicas en Java</h3><p>En la siguiente tabla tenemos los algoritmos, modos y tipos de relleno, junto con la longitud de clave empleada, de los algoritmos de cifrado simétrico m&#39;as comunes.</p><table><thead><tr><th>Transformación (algoritmo/modo/relleno)</th><th>Key Size</th></tr></thead><tbody><tr><td>AES/CBC/NoPadding</td><td>128</td></tr><tr><td>AES/CBC/PKCS5Padding</td><td>128</td></tr><tr><td>AES/ECB/NoPadding</td><td>128</td></tr><tr><td>AES/ECB/PKCS5Padding</td><td>128</td></tr><tr><td>DES/CBC/NoPadding</td><td>56</td></tr><tr><td>DES/CBC/PKCS5Padding</td><td>56</td></tr><tr><td>DES/ECB/NoPadding</td><td>56</td></tr><tr><td>DES/ECB/PKCS5Padding</td><td>56</td></tr><tr><td>DESede/CBC/NoPadding</td><td>168</td></tr><tr><td>DESede/CBC/PKCS5Padding</td><td>168</td></tr><tr><td>DESede/ECB/NoPadding</td><td>168</td></tr><tr><td>DESede/ECB/PKCS5Padding</td><td>168</td></tr><tr><td>RSA/ECB/PKCS1Padding</td><td>1024, 2048</td></tr><tr><td>RSA/ECB/OAEPWithSHA-1AndMGF1Padding</td><td>1024, 2048</td></tr><tr><td>RSA/ECB/OAEPWithSHA-256AndMGF1Padding</td><td>1024, 2048</td></tr></tbody></table><h2 id="_6-3-3-clases-stream-para-cifrado-y-descifrado-simetrico" tabindex="-1">6.3.3. Clases stream para cifrado y descifrado simétrico</h2><p>Existen dos clases stream que permiten cifrar y descifrar directamente. Pertenecen al paquete <em>java.crypto</em> pero por lo demás funcionan exactamente igual que las clases Stream del paquete <em>java.io</em>, de las que además son clases descendientes y y tienen constructores que permiten crear streams encriptados sobre un InputStream y un OutputStream.</p><table><thead><tr><th>Clase</th><th>Ejemplo</th></tr></thead><tbody><tr><td>CipherInputStream</td><td>CipherInputStream (InputStream is, Cipher c)</td></tr><tr><td>CipherOutputStream</td><td>CipherOutputStream (OutputStream os, Cipher c)</td></tr></tbody></table><p>Por lo tanto, cuando tenemos que leer o escribir información, podemos añadir un envoltorio más al wrapper que utilizamos habitualmente y esto nos permite que tanto las lecturas como las escrituras se hagan cifradas, usando el algoritmo y la clave definidos para el objeto Cipher.</p><p>El uso más común es para leer o escribir en archivos en los que, de igual forma, cambiando el wrapper nos permite leer o escribir la información de forma cifrada/descifrada.</p><div class="custom-container warning"><p class="custom-container-title">Tamaño de bloque</p><p>Muchos de los algoritmos de cifrado simétrico trabajan con bloques de datos, por lo que no debemos intentar cifrar o descifrar más información de la que permite el tamaño de bloque.</p><p>La clase Cipher tiene un método <strong>getBlockSize()</strong> que nos devuelve el tamaño de bloque que permite el algoritmo configurado en su método <strong>init()</strong>.</p></div><p>Veamos un ejemplo de cómo quedaría el wrapper</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="shiki material-theme-lighter" style="background-color:#FAFAFA;" tabindex="0"><code><span class="line"><span style="color:#9C3EDA;">public</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">class</span><span style="color:#90A4AE;"> </span><span style="color:#E2931D;">StreamCrypto</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#9C3EDA;">public</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">static</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">void</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">main</span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">String</span><span style="color:#39ADB5;">[]</span><span style="color:#90A4AE;"> </span><span style="color:#90A4AE;font-style:italic;">args</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">throws</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">NoSuchAlgorithmException</span><span style="color:#39ADB5;">,</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">NoSuchPaddingException</span><span style="color:#39ADB5;">,</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">InvalidKeyException</span><span style="color:#39ADB5;">,</span><span style="color:#90A4AE;"> </span><span style="color:#9C3EDA;">IOException</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#9C3EDA;">File</span><span style="color:#90A4AE;"> file</span><span style="color:#39ADB5;">;</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#9C3EDA;">String</span><span style="color:#90A4AE;"> filePath </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">a.txt</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">        file </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">File</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">filePath</span><span style="color:#39ADB5;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#39ADB5;">        </span><span style="color:#90A4AE;font-style:italic;">//Se define el objeto Cipher (Algoritmo/modo/relleno)</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#9C3EDA;">Cipher</span><span style="color:#90A4AE;"> c </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> Cipher</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getInstance</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">AES/ECB/PKCS5Padding</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">);</span><span style="color:#90A4AE;"> </span><span style="color:#90A4AE;font-style:italic;">//DESede</span></span>
<span class="line"><span style="color:#39ADB5;">        </span><span style="color:#90A4AE;font-style:italic;">// Configuramos el modo de CIFRADO</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#9C3EDA;">byte</span><span style="color:#39ADB5;">[]</span><span style="color:#90A4AE;"> valorClave </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">12345678123456781234567812345678</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">getBytes</span><span style="color:#39ADB5;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#39ADB5;">        </span><span style="color:#90A4AE;font-style:italic;">// CIFRADO DEL STREAM (fichero a.txt)</span></span>
<span class="line"><span style="color:#90A4AE;">        c</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">init</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">Cipher</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">ENCRYPT_MODE</span><span style="color:#39ADB5;">,</span></span>
<span class="line"><span style="color:#90A4AE;">                </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">SecretKeySpec</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">valorClave</span><span style="color:#39ADB5;">,</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">AES</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">));</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;font-style:italic;">try</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">OutputStream</span><span style="color:#90A4AE;"> outputStream </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">BufferedOutputStream</span><span style="color:#39ADB5;">(</span></span>
<span class="line"><span style="color:#90A4AE;">                </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">CipherOutputStream</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">FileOutputStream</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">file</span><span style="color:#39ADB5;">),</span><span style="color:#90A4AE;"> c</span><span style="color:#39ADB5;">)))</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#39ADB5;font-style:italic;">for</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">int</span><span style="color:#90A4AE;"> i </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#F76D47;">0</span><span style="color:#39ADB5;">;</span><span style="color:#90A4AE;"> i </span><span style="color:#39ADB5;">&lt;</span><span style="color:#90A4AE;"> </span><span style="color:#F76D47;">10</span><span style="color:#39ADB5;">;</span><span style="color:#90A4AE;"> i</span><span style="color:#39ADB5;">++)</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"><span style="color:#90A4AE;">                outputStream</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">write</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">String</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">Hello World</span><span style="color:#90A4AE;">\n</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">).</span><span style="color:#6182B8;">getBytes</span><span style="color:#39ADB5;">());</span></span>
<span class="line"><span style="color:#90A4AE;">            </span><span style="color:#39ADB5;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#39ADB5;">        </span><span style="color:#90A4AE;font-style:italic;">// DESCIFRADO DEL STREAM (fichero a.txt)</span></span>
<span class="line"><span style="color:#90A4AE;">        c</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">init</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">Cipher</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">DECRYPT_MODE</span><span style="color:#39ADB5;">,</span></span>
<span class="line"><span style="color:#90A4AE;">                </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">SecretKeySpec</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">valorClave</span><span style="color:#39ADB5;">,</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">AES</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">));</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;font-style:italic;">try</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">(</span><span style="color:#9C3EDA;">InputStream</span><span style="color:#90A4AE;"> inputStream </span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">BufferedInputStream</span><span style="color:#39ADB5;">(</span></span>
<span class="line"><span style="color:#90A4AE;">                </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">CipherInputStream</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">FileInputStream</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">file</span><span style="color:#39ADB5;">),</span><span style="color:#90A4AE;"> c</span><span style="color:#39ADB5;">)))</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">            System</span><span style="color:#39ADB5;">.</span><span style="color:#90A4AE;">out</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">println</span><span style="color:#39ADB5;">(</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">Contenido del fichero (descifrado):</span><span style="color:#90A4AE;">\n</span><span style="color:#39ADB5;">&quot;</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;">+</span><span style="color:#90A4AE;"> </span><span style="color:#39ADB5;font-style:italic;">new</span><span style="color:#90A4AE;"> </span><span style="color:#6182B8;">String</span><span style="color:#39ADB5;">(</span><span style="color:#90A4AE;">inputStream</span><span style="color:#39ADB5;">.</span><span style="color:#6182B8;">readAllBytes</span><span style="color:#39ADB5;">()));</span></span>
<span class="line"><span style="color:#90A4AE;">        </span><span style="color:#39ADB5;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">    </span><span style="color:#39ADB5;">}</span></span>
<span class="line"><span style="color:#39ADB5;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_6-3-4-cifrado-simetrico-con-gnupg" tabindex="-1">6.3.4. Cifrado simétrico con GnuPG</h2><p>Con la suite GnuPG también podemos cifrar el contenido de los archivos usando diferentes algoritmos</p><div class="custom-container info"><p class="custom-container-title">Algoritmos disponibles para GnuPG</p><p>Para ver la lista de algoritmos disponibles tenemos que mostrar la ayuda del comando</p><blockquote><p>gpg --help</p></blockquote><p>y en la parte superior observamos la información de los algoritmos disponibles para cada tipo de servicio. En concreto, de resúmenes, en mi versión instalada:</p><p>Cifrado: IDEA, 3DES, CAST5, BLOWFISH, AES, AES192, AES256, TWOFISH, CAMELLIA128, CAMELLIA192, CAMELLIA256</p></div><p>Para cifrar y descifrar un archivo, ejecutamos los siguientes comandos</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="shiki material-theme-lighter" style="background-color:#FAFAFA;" tabindex="0"><code><span class="line"><span style="color:#E2931D;">gpg</span><span style="color:#90A4AE;"> </span><span style="color:#91B859;">--symmetric</span><span style="color:#90A4AE;"> </span><span style="color:#91B859;">--cipher-algo</span><span style="color:#90A4AE;"> </span><span style="color:#F76D47;">3</span><span style="color:#91B859;">DES</span><span style="color:#90A4AE;"> </span><span style="color:#91B859;">filename.ext</span></span>
<span class="line"><span style="color:#E2931D;">gpg</span><span style="color:#90A4AE;"> </span><span style="color:#91B859;">--decrypt</span><span style="color:#90A4AE;"> </span><span style="color:#91B859;">filename.ext.gpg</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>Vemos que para el cifrado nos solicita una clave y que con el parámetro <em>--cipher-algo</em> indicamos qué algoritmo de encriptación queremos utilizar.</p><p>El cifrado genera un archivo filename.ext.gpg.</p><p>Para el descifrado, no hace falta indicar el algoritmo, aunque se puede volver a usar el parámetro <em>--cipher-algo</em> y la clave se queda en una cache de GnuPG durante un tiempo, por lo que no siempre la solicita.</p></div><!--[--><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">Última actualización: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Editores: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: vicente@iesdoctorbalmis.com">Vicente Martínez</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav"><p class="inner"><span class="prev"><a href="/psp_pages/es/unit6/hash-functions.html" class="" aria-label="6.2 Funciones resumen"><!--[--><!--]--> 6.2 Funciones resumen <!--[--><!--]--></a></span><span class="next"><a href="/psp_pages/es/unit6/asymmetric-keys.html" class="" aria-label="6.4 Encriptación asimétrica"><!--[--><!--]--> 6.4 Encriptación asimétrica <!--[--><!--]--></a></span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/psp_pages/assets/app-613bf899.js" defer></script>
  </body>
</html>
